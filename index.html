<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Page 1 | 나의 첫번째 블로그</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  
  <meta property="og:type" content="website">
<meta property="og:title" content="나의 첫번째 블로그">
<meta property="og:url" content="https://sallyzmk.github.io/index.html">
<meta property="og:site_name" content="나의 첫번째 블로그">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">

  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Oswald%3A300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  
<link rel="stylesheet" href="/css/style.css">


  
<script src="/js/jquery-3.1.1.min.js"></script>


  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >
  <link rel="stylesheet" href="/css/fashion.css" >
  <link rel="stylesheet" href="/css/glyphs.css" >

</head>



  <body>


  


<header id="allheader" class="site-header" role="banner" 
   >
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="나의 첫번째 블로그" rel="home"> 나의 첫번째 블로그 </a>
            
          </h1>
          
          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>

            <div class="clearfix sf-menu">
              <ul id="main-nav" class="menu sf-js-enabled sf-arrows"  style="touch-action: pan-y;">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663" linktext="/"> <a class="" href="/">Home</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663" linktext="https://sallyzmk.github.io/2022/06/16/Categories/"> <a class="" href="https://sallyzmk.github.io/2022/06/16/Categories/">Categories</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663" linktext="https://sallyzmk.github.io/2022/06/16/Python_home/"> <a class="" href="https://sallyzmk.github.io/2022/06/16/Python_home/">python</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663" linktext="https://sallyzmk.github.io/2022/06/16/R_home/"> <a class="" href="https://sallyzmk.github.io/2022/06/16/R_home/">r</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663" linktext="https://sallyzmk.github.io/2022/06/16/Notion_home/"> <a class="" href="https://sallyzmk.github.io/2022/06/16/Notion_home/">notion</a> </li>
                    
              </ul>
            </div>
          </nav>

      </div>
  </div>
</header>


  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main">
  
    <article id="post-Airflow 강의"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2022/07/28/Airflow%20%EA%B0%95%EC%9D%98/">Airflow 강의</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2022/07/28/Airflow%20%EA%B0%95%EC%9D%98/" class="article-date">
	  <time datetime="2022-07-27T16:00:00.000Z" itemprop="datePublished">July 28, 2022</time>
	</a>

       
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Airflow-강의"><a href="#Airflow-강의" class="headerlink" title="Airflow 강의"></a>Airflow 강의</h1><h2 id="airflow-tutorial"><a href="#airflow-tutorial" class="headerlink" title="airflow tutorial"></a><a href="%5Bhttps://airflow.apache.org/docs/apache-airflow/stable/tutorial.html%5D(https://airflow.apache.org/docs/apache-airflow/stable/tutorial.html)">airflow tutorial</a></h2><h2 id="airflow-추천-도서"><a href="#airflow-추천-도서" class="headerlink" title="airflow 추천 도서"></a><a href="%5Bhttp://www.yes24.com/Product/Goods/107878326%5D(http://www.yes24.com/Product/Goods/107878326)">airflow 추천 도서</a></h2><h2 id="내가-생각하는-Airflow-정의"><a href="#내가-생각하는-Airflow-정의" class="headerlink" title="내가 생각하는 Airflow 정의"></a>내가 생각하는 Airflow 정의</h2><p>데이터는 끊임없이 생성이 된다.</p>
<p>하여 데이터 분석가는 데이터를 잘 정리하여 수시로 데이터 베이스DB에 업데이트 해야 한다.</p>
<p>Airflow는 수시로 데이터 베이스를 업데이트 하는 것을 자동으로 실행해 주는 프로그램이다.</p>
<hr>
<h1 id="3-1-파이썬으로-파일-쓰고-읽기"><a href="#3-1-파이썬으로-파일-쓰고-읽기" class="headerlink" title="[3.1 파이썬으로 파일 쓰고 읽기]"></a>[3.1 파이썬으로 파일 쓰고 읽기]</h1><ul>
<li>교재 &lt;실무 예제로 배우는 데이터 공학&gt; 41p~50p</li>
</ul>
<h2 id="step1-py-파일-생성-및-하단-코드-입력"><a href="#step1-py-파일-생성-및-하단-코드-입력" class="headerlink" title="step1.py 파일 생성 및 하단 코드 입력"></a>step1.py 파일 생성 및 하단 코드 입력</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> faker</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(pd.__version__)</span><br></pre></td></tr></table></figure>

<h2 id="write-df-py-파일-생성-및-하단-코드-입력"><a href="#write-df-py-파일-생성-및-하단-코드-입력" class="headerlink" title="write_df.py 파일 생성 및 하단 코드 입력"></a>write_df.py 파일 생성 및 하단 코드 입력</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> faker <span class="keyword">import</span> Faker</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    output = <span class="built_in">open</span>(<span class="string">&#x27;data.csv&#x27;</span>,mode=<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">    fake=Faker()</span><br><span class="line">    header=[<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;age&#x27;</span>,<span class="string">&#x27;street&#x27;</span>,<span class="string">&#x27;city&#x27;</span>,<span class="string">&#x27;state&#x27;</span>,<span class="string">&#x27;zip&#x27;</span>,<span class="string">&#x27;lng&#x27;</span>,<span class="string">&#x27;lat&#x27;</span>]</span><br><span class="line">    mywriter=csv.writer(output)</span><br><span class="line">    mywriter.writerow(header)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">        mywriter.writerow([fake.name(),fake.random_int(<span class="built_in">min</span>=<span class="number">18</span>, <span class="built_in">max</span>=<span class="number">80</span>, step=<span class="number">1</span>), fake.street_address(), fake.city(),fake.state(),fake.zipcode(),fake.longitude(),fake.latitude()])</span><br><span class="line">    output.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h2 id="read-df-py-파일-생성-및-하단-코드-입력"><a href="#read-df-py-파일-생성-및-하단-코드-입력" class="headerlink" title="read_df.py 파일 생성 및 하단 코드 입력"></a>read_df.py 파일 생성 및 하단 코드 입력</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data.csv&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        myreader = csv.DictReader(f)</span><br><span class="line">        headers = <span class="built_in">next</span>(myreader)</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> myreader:</span><br><span class="line">            <span class="built_in">print</span>(row[<span class="string">&#x27;name&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ ==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h2 id="write-df-pd-py-파일-생성-및-하단-코드-입력"><a href="#write-df-pd-py-파일-생성-및-하단-코드-입력" class="headerlink" title="write_df_pd.py 파일 생성 및 하단 코드 입력"></a>write_df_pd.py 파일 생성 및 하단 코드 입력</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    data = &#123;<span class="string">&#x27;Name&#x27;</span>:[<span class="string">&#x27;Paul&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Susan&#x27;</span>,<span class="string">&#x27;Yolanda&#x27;</span>]</span><br><span class="line">    ,<span class="string">&#x27;Age&#x27;</span>:[<span class="number">23</span>,<span class="number">45</span>,<span class="number">18</span>,<span class="number">21</span>]&#125;</span><br><span class="line">    df=pd.DataFrame(data)</span><br><span class="line">    df.to_csv(<span class="string">&#x27;fromdf.CSV&#x27;</span>,index=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ ==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h2 id="read-df-pd-py-파일-생성-및-하단-코드-입력"><a href="#read-df-pd-py-파일-생성-및-하단-코드-입력" class="headerlink" title="read_df_pd.py 파일 생성 및 하단 코드 입력"></a>read_df_pd.py 파일 생성 및 하단 코드 입력</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    df = pd.read_csv(<span class="string">&#x27;data.csv&#x27;</span>)</span><br><span class="line">    df.head(<span class="number">10</span>)</span><br><span class="line">    <span class="comment"># print(df)</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h2 id="write-json-df-py-파일-생성-및-하단-코드-입력"><a href="#write-json-df-py-파일-생성-및-하단-코드-입력" class="headerlink" title="write_json_df.py 파일 생성 및 하단 코드 입력"></a>write_json_df.py 파일 생성 및 하단 코드 입력</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> faker <span class="keyword">import</span> Faker</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    output = <span class="built_in">open</span>(<span class="string">&#x27;data.json&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">    fake = Faker()</span><br><span class="line">    alldata =&#123;&#125;</span><br><span class="line">    alldata[<span class="string">&#x27;records&#x27;</span>] = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> X <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">        data=&#123;<span class="string">&quot;name&quot;</span>:fake.name(),<span class="string">&quot;age&quot;</span>:fake.random_int(<span class="built_in">min</span>=<span class="number">18</span>, <span class="built_in">max</span>=<span class="number">80</span>, step=<span class="number">1</span>),<span class="string">&quot;street&quot;</span>:fake.street_address(),<span class="string">&quot;city&quot;</span>:fake.city(),<span class="string">&quot;state&quot;</span>:fake.state(),<span class="string">&quot;zip&quot;</span>:fake.zipcode(),<span class="string">&quot;lng&quot;</span>:<span class="built_in">float</span>(fake.longitude()),<span class="string">&quot;lat&quot;</span>:<span class="built_in">float</span>(fake.latitude())&#125;</span><br><span class="line">        alldata[<span class="string">&#x27;records&#x27;</span>].append(data)</span><br><span class="line">    json.dump(alldata,output)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h2 id="read-json-df-py-파일-생성-및-하단-코드-입력"><a href="#read-json-df-py-파일-생성-및-하단-코드-입력" class="headerlink" title="read_json_df.py 파일 생성 및 하단 코드 입력"></a>read_json_df.py 파일 생성 및 하단 코드 입력</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># _*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> pandas.io.json <span class="keyword">as</span> pd_JSON</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_json</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;data.json&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data= json.load(f)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">type</span>(data))</span><br><span class="line">    <span class="built_in">print</span>(data[<span class="string">&#x27;records&#x27;</span>][<span class="number">0</span>][<span class="string">&#x27;name&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_pandas</span>():</span><br><span class="line">    df = pd.read_json(<span class="string">&#x27;data.json&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;기본 방법은 조금 복잡해요! :\n&quot;</span>, df.head())</span><br><span class="line"></span><br><span class="line">    f=<span class="built_in">open</span>(<span class="string">&#x27;data.json&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    data = pd_JSON.loads(f.read())</span><br><span class="line">    <span class="comment">#print(data)</span></span><br><span class="line">    df = pd.json_normalize(data,record_path=<span class="string">&#x27;records&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;다른 방법도 복잡해요 :\n&quot;</span>, df.head())</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># read_json()</span></span><br><span class="line">    read_pandas()</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="3-2-아파치-에어플로-데이터-파이프라인-구축"><a href="#3-2-아파치-에어플로-데이터-파이프라인-구축" class="headerlink" title="[3.2 아파치 에어플로 데이터 파이프라인 구축]"></a>[3.2 아파치 에어플로 데이터 파이프라인 구축]</h1><ul>
<li>교재 &lt;실무 예제로 배우는 데이터 공학&gt; 51p~57p</li>
</ul>
<h2 id="Airflow-들어가기"><a href="#Airflow-들어가기" class="headerlink" title="Airflow 들어가기"></a>Airflow 들어가기</h2><h3 id="dags-폴더-만들기"><a href="#dags-폴더-만들기" class="headerlink" title="dags 폴더 만들기"></a>dags 폴더 만들기</h3><h3 id="data-csv-파일-dags폴더로-옮기기"><a href="#data-csv-파일-dags폴더로-옮기기" class="headerlink" title="data.csv 파일 dags폴더로 옮기기"></a>data.csv 파일 dags폴더로 옮기기</h3><h3 id="airflowcsv-py-파일-생성-및-하단-코드-입력"><a href="#airflowcsv-py-파일-생성-및-하단-코드-입력" class="headerlink" title="airflowcsv.py 파일 생성 및 하단 코드 입력"></a>airflowcsv.py 파일 생성 및 하단 코드 입력</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># 51p</span></span><br><span class="line"><span class="keyword">import</span> datetime <span class="keyword">as</span> dt</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> timedelta</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> airflow</span><br><span class="line"><span class="keyword">from</span> airflow <span class="keyword">import</span> DAG</span><br><span class="line"><span class="keyword">from</span> airflow.operators.bash <span class="keyword">import</span> BashOperator</span><br><span class="line"><span class="keyword">from</span> airflow.operators.python <span class="keyword">import</span> PythonOperator</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(pd.__version__)</span></span><br><span class="line"><span class="comment"># print(airflow.__version__)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">csvToJson</span>():</span><br><span class="line">    df=pd.read_csv(<span class="string">&#x27;dags/data.csv&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i,r <span class="keyword">in</span> df.iterrows():</span><br><span class="line">        <span class="built_in">print</span>(r[<span class="string">&#x27;name&#x27;</span>])</span><br><span class="line">    df.to_json(<span class="string">&#x27;fromAirflow.json&#x27;</span>,orient=<span class="string">&#x27;records&#x27;</span>)</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">default_args = &#123;</span><br><span class="line">    <span class="string">&#x27;owner&#x27;</span>: <span class="string">&#x27;evan&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;start_date&#x27;</span>: dt.datetime(<span class="number">2022</span>, <span class="number">7</span>, <span class="number">27</span>),</span><br><span class="line">    <span class="string">&#x27;retries&#x27;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&#x27;retry_delay&#x27;</span>: dt.timedelta(minutes=<span class="number">1</span>),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> DAG(<span class="string">&#x27;MyCSVDAG&#x27;</span>,</span><br><span class="line">         default_args=default_args,</span><br><span class="line">         schedule_interval=timedelta(minutes=<span class="number">1</span>),      <span class="comment"># &#x27;0 * * * *&#x27;,</span></span><br><span class="line">         ) <span class="keyword">as</span> dag:</span><br><span class="line"></span><br><span class="line">    print_starting = BashOperator(task_id=<span class="string">&#x27;starting&#x27;</span>,</span><br><span class="line">                               bash_command=<span class="string">&#x27;echo &quot;I am reading the CSV now.....&quot;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    csvJson = PythonOperator(task_id=<span class="string">&#x27;convertCSVtoJson&#x27;</span>,</span><br><span class="line">                                 python_callable=csvToJson)</span><br><span class="line"></span><br><span class="line">print_starting &gt;&gt; csvJson</span><br></pre></td></tr></table></figure>

<h3 id="airflow-cfg-파일에서-해당-코드-찾아서-False로-고쳐주기"><a href="#airflow-cfg-파일에서-해당-코드-찾아서-False로-고쳐주기" class="headerlink" title="airflow.cfg 파일에서 해당 코드 찾아서 False로 고쳐주기"></a>airflow.cfg 파일에서 해당 코드 찾아서 False로 고쳐주기</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">load_examples = False</span><br></pre></td></tr></table></figure>

<h3 id="터미널-2개에서-하단-코드-실행"><a href="#터미널-2개에서-하단-코드-실행" class="headerlink" title="터미널 2개에서 하단 코드 실행"></a>터미널 2개에서 하단 코드 실행</h3><ul>
<li>우리는 평소 1개의 터미널에서 명령어를 실행한다.</li>
<li>평소처럼 터미널을 1개 실행한 후 +버튼으로 새 터미널을 열면 된다.</li>
<li>그럼 터미널 2개 생김!!!</li>
</ul>
<p><img src="/source/images/Airflow_lecture/Untitled.png" alt="Untitled"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 경로 확인!!! airflow에서 실행, dags에서 실행하면 안됩니다.</span><br><span class="line"></span><br><span class="line">source venv/bin/activate</span><br><span class="line">airflow webserver -p 포트번호</span><br><span class="line"></span><br><span class="line">source venv/bin/activate</span><br><span class="line">airflow scheduler</span><br></pre></td></tr></table></figure>

<h3 id="인터넷-창에-‘localhost-포트번호’를-입력하면-아래-창이-뜬다"><a href="#인터넷-창에-‘localhost-포트번호’를-입력하면-아래-창이-뜬다" class="headerlink" title="인터넷 창에 ‘localhost: 포트번호’를 입력하면 아래 창이 뜬다."></a>인터넷 창에 ‘localhost: 포트번호’를 입력하면 아래 창이 뜬다.</h3><p>localhost:1234</p>
<h3 id="아래-버튼을-활성화-시킨다"><a href="#아래-버튼을-활성화-시킨다" class="headerlink" title="아래 버튼을 활성화 시킨다."></a>아래 버튼을 활성화 시킨다.</h3><p><img src="/source/images/Airflow_lecture/Untitled%201.png" alt="Untitled"></p>
<p><img src="/source/images/Airflow_lecture/Untitled%202.png" alt="Untitled"></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-가상환경 설치하기"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2022/07/27/%EA%B0%80%EC%83%81%ED%99%98%EA%B2%BD%20%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0/">리눅스 가상환경 설치하기</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2022/07/27/%EA%B0%80%EC%83%81%ED%99%98%EA%B2%BD%20%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0/" class="article-date">
	  <time datetime="2022-07-26T18:00:00.000Z" itemprop="datePublished">July 27, 2022</time>
	</a>

       
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="리눅스-가상환경-설치하기"><a href="#리눅스-가상환경-설치하기" class="headerlink" title="리눅스 가상환경 설치하기"></a>리눅스 가상환경 설치하기</h1><h2 id="반드시-타이핑하기"><a href="#반드시-타이핑하기" class="headerlink" title="(반드시 타이핑하기)"></a>(반드시 타이핑하기)</h2><h2 id="우분투-실행하기"><a href="#우분투-실행하기" class="headerlink" title="우분투 실행하기"></a>우분투 실행하기</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: human</span><br><span class="line">password: 1234</span><br></pre></td></tr></table></figure>

<p>ls 를 치면 아무 것도 안나옴</p>
<p>cd ..</p>
<p>mkdir : 파일 생성</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">cd home</span><br><span class="line">cd human</span><br><span class="line">mkdir airflow</span><br><span class="line">cd airflow</span><br><span class="line"></span><br><span class="line"># 모든 파일 삭제</span><br><span class="line">rm -rf *</span><br><span class="line"></span><br><span class="line"># 설치</span><br><span class="line">sudo apt-get update</span><br><span class="line"></span><br><span class="line">sudo apt install python3-pip</span><br><span class="line"></span><br><span class="line">sudo pip3 install virtualenv</span><br><span class="line"></span><br><span class="line"># 가상환경 설치</span><br><span class="line">virtualenv venv</span><br><span class="line"></span><br><span class="line"># 리눅스는 bin/ 윈도우는 Script</span><br><span class="line">source venv/bin/activate</span><br><span class="line"></span><br><span class="line"># venv 가상환경 들어왔는지 확인</span><br><span class="line">ls</span><br><span class="line"></span><br><span class="line"># 경로 확인 및 복사 /home/human/airflow</span><br><span class="line">pwd</span><br><span class="line"></span><br><span class="line"># &lt;실무 예제로 배우는 데이터 공학&gt; 25p</span><br><span class="line">pip3 install &#x27;apache-airflow[postgres, slack, celery]&#x27;</span><br><span class="line"></span><br><span class="line"># 이상한 코드 주루룩 뜸</span><br><span class="line">vi ~/.bashrc</span><br></pre></td></tr></table></figure>

<p><img src="/images/Installing_a_virtual_environment/Untitled.png" alt="Untitled"></p>
<h2 id="i를-치면-—INSERT—가-뜬다-enter가-쳐짐"><a href="#i를-치면-—INSERT—가-뜬다-enter가-쳐짐" class="headerlink" title="i를 치면 —INSERT—가 뜬다 (enter가 쳐짐)"></a>i를 치면 —INSERT—가 뜬다 (enter가 쳐짐)</h2><p><img src="/images/Installing_a_virtual_environment/Untitled%201.png" alt="Untitled"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># pwd에서 나온 경로(/mnt/c/dataEngineering)를 복붙한다.</span><br><span class="line">export AIRFLOW_HOME=/mnt/c/dataEngineering</span><br><span class="line"></span><br><span class="line">## 저장하기</span><br><span class="line"># step1. esc 누르고 </span><br><span class="line">:wq! # step2. 저장하고 닫기</span><br><span class="line">:q # step2. 저장 안하고 닫기</span><br><span class="line"></span><br><span class="line"># step3. bash 터미널에서</span><br><span class="line">source ~/.bashrc</span><br><span class="line">source venv/bin/activate</span><br><span class="line">echo $AIRFLOW_HOME # 저장됐는지 확인</span><br></pre></td></tr></table></figure>

<p><img src="/images/Installing_a_virtual_environment/Untitled%202.png" alt="Untitled"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 가상환경에 접속한 후!!!!</span><br><span class="line">airflow db init</span><br><span class="line"></span><br><span class="line">airflow users create --username airflow --password airflow --firstname evan --lastname airflow --role Admin --email your_email@some.com</span><br><span class="line"></span><br><span class="line">airflow webserver -p 8081</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://localhost:8081/home">http://localhost:8081</a></p>
<p>들어가서 –username airflow –password airflow</p>
<h2 id="환경설정-끝"><a href="#환경설정-끝" class="headerlink" title="환경설정 끝"></a>환경설정 끝</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">## 노트 ##</span><br><span class="line"></span><br><span class="line">가상 환경 구성</span><br><span class="line">virtualenv venv</span><br><span class="line"></span><br><span class="line">가상환경 접속</span><br><span class="line">source venv/bin/activate</span><br><span class="line"></span><br><span class="line">가상환경 해제</span><br><span class="line">deactivate</span><br></pre></td></tr></table></figure>

<h2 id="3장-강의를-위한-준비"><a href="#3장-강의를-위한-준비" class="headerlink" title="3장 강의를 위한 준비"></a>3장 강의를 위한 준비</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip3 install faker pandas</span><br><span class="line"></span><br><span class="line">code .</span><br></pre></td></tr></table></figure>

<h2 id="vscode-실행-파일-생성-후-버전-확인"><a href="#vscode-실행-파일-생성-후-버전-확인" class="headerlink" title="vscode 실행, 파일 생성 후 버전 확인"></a>vscode 실행, 파일 생성 후 버전 확인</h2><p><img src="/images/Installing_a_virtual_environment/Untitled%203.png" alt="Untitled"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># step1.py</span><br><span class="line"></span><br><span class="line">import pandas as pd</span><br><span class="line">import faker</span><br><span class="line">print(pd.__version__)</span><br></pre></td></tr></table></figure>

<h2 id="vi-편집기-공부"><a href="#vi-편집기-공부" class="headerlink" title="vi 편집기 공부!!"></a>vi 편집기 공부!!</h2>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-VSCode Remote WLS 연동"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2022/07/27/VSCode%20Remote%20WLS%20%EC%97%B0%EB%8F%99/">VSCode Remote WLS 연동</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2022/07/27/VSCode%20Remote%20WLS%20%EC%97%B0%EB%8F%99/" class="article-date">
	  <time datetime="2022-07-26T17:00:00.000Z" itemprop="datePublished">July 27, 2022</time>
	</a>

       
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="VSCode-Remote-WLS-연동"><a href="#VSCode-Remote-WLS-연동" class="headerlink" title="VSCode Remote WLS 연동"></a>VSCode Remote WLS 연동</h1><h2 id="강사님-링크"><a href="#강사님-링크" class="headerlink" title="강사님 링크"></a><a href="%5Bhttps://dschloe.github.io/settings/vscode_wsl2/%5D(https://dschloe.github.io/settings/vscode_wsl2/)">강사님 링크</a></h2><h2 id="환경-변수가-중요한-이유"><a href="#환경-변수가-중요한-이유" class="headerlink" title="[환경 변수가 중요한 이유]"></a>[환경 변수가 중요한 이유]</h2><p>빅데이터 플랫폼 구축</p>
<p>웹사이트 구축</p>
<p>— Configuration &#x2F;&#x2F; 각 설치 프로그램끼리 환경변수로 유기적으로 연결시킴</p>
<p>— 레고 블록</p>
<h2 id="microsoft-vs-code-가-있는-것을-확인"><a href="#microsoft-vs-code-가-있는-것을-확인" class="headerlink" title="microsoft vs code 가 있는 것을 확인"></a>microsoft vs code 가 있는 것을 확인</h2><p><img src="/images/VSCode_Remote_WLS_Peristalsis/Untitled.png" alt="Untitled"></p>
<p><img src="/images/VSCode_Remote_WLS_Peristalsis/Untitled%201.png" alt="Untitled"></p>
<p><img src="/images/VSCode_Remote_WLS_Peristalsis/Untitled%202.png" alt="Untitled"></p>
<p><img src="/images/VSCode_Remote_WLS_Peristalsis/Untitled%203.png" alt="Untitled"></p>
<h2 id="vscode-실행하기"><a href="#vscode-실행하기" class="headerlink" title="vscode 실행하기"></a>vscode 실행하기</h2><p><img src="/images/VSCode_Remote_WLS_Peristalsis/Untitled%204.png" alt="Untitled"></p>
<h2 id="dataEngineering폴더-생성"><a href="#dataEngineering폴더-생성" class="headerlink" title="dataEngineering폴더 생성"></a>dataEngineering폴더 생성</h2><h2 id="아무-마크다운-파일-집어-넣기"><a href="#아무-마크다운-파일-집어-넣기" class="headerlink" title="아무 마크다운 파일 집어 넣기"></a>아무 마크다운 파일 집어 넣기</h2><p><img src="/images/VSCode_Remote_WLS_Peristalsis/Untitled%205.png" alt="Untitled"></p>
<h2 id="우분투-실행하기"><a href="#우분투-실행하기" class="headerlink" title="우분투 실행하기"></a>우분투 실행하기</h2><p><img src="/images/VSCode_Remote_WLS_Peristalsis/Untitled%206.png" alt="Untitled"></p>
<ul>
<li>해당 마크다운을 리눅스로 다운 받는 중</li>
</ul>
<h2 id="vscode-자동-실행됨"><a href="#vscode-자동-실행됨" class="headerlink" title="vscode 자동 실행됨"></a>vscode 자동 실행됨</h2><p><img src="/images/VSCode_Remote_WLS_Peristalsis/Untitled%207.png" alt="Untitled"></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-WSL Tool설치"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2022/07/27/WSL%20Tool%EC%84%A4%EC%B9%98/">WSL Tool설치</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2022/07/27/WSL%20Tool%EC%84%A4%EC%B9%98/" class="article-date">
	  <time datetime="2022-07-26T16:00:00.000Z" itemprop="datePublished">July 27, 2022</time>
	</a>

       
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="WSL-Tool설치"><a href="#WSL-Tool설치" class="headerlink" title="WSL Tool설치"></a>WSL Tool설치</h1><h2 id="실무-예제로-배우는-데이터-공학"><a href="#실무-예제로-배우는-데이터-공학" class="headerlink" title="[실무 예제로 배우는 데이터 공학]"></a>[실무 예제로 배우는 데이터 공학]</h2><p>백엔드 개발자 - 243p 아파치 카프카</p>
<p>머신러닝 - 271p 스파크 pyspark</p>
<p>머신러닝 엔지니어 - 69p, 99p 챕터 4,5</p>
<hr>
<h2 id="윈도우-사양-gt-버전-gt-20H1-20H2-21H1-21H2-확인"><a href="#윈도우-사양-gt-버전-gt-20H1-20H2-21H1-21H2-확인" class="headerlink" title="윈도우 사양 &gt; 버전&gt; 20H1, 20H2, 21H1, 21H2 확인"></a>윈도우 사양 &gt; 버전&gt; 20H1, 20H2, 21H1, 21H2 확인</h2><p><img src="/images/WSL_Tool_installation/Untitled.png" alt="Untitled"></p>
<p><img src="/images/WSL_Tool_installation/Untitled%201.png" alt="Untitled"></p>
<h2 id="윈도우즈-기능-x2F-켜기-하이퍼-바이저-플랫폼-클릭-가상머신-플랫폼-Hyper-V-클릭-컴퓨터마다-조금씩-다름"><a href="#윈도우즈-기능-x2F-켜기-하이퍼-바이저-플랫폼-클릭-가상머신-플랫폼-Hyper-V-클릭-컴퓨터마다-조금씩-다름" class="headerlink" title="윈도우즈 기능&#x2F;켜기 - 하이퍼 바이저 플랫폼 클릭, 가상머신 플랫폼, Hyper-V 클릭, 컴퓨터마다 조금씩 다름."></a>윈도우즈 기능&#x2F;켜기 - 하이퍼 바이저 플랫폼 클릭, 가상머신 플랫폼, Hyper-V 클릭, 컴퓨터마다 조금씩 다름.</h2><p><img src="/images/WSL_Tool_installation/Untitled%202.png" alt="Untitled"></p>
<p><img src="/images/WSL_Tool_installation/Untitled%203.png" alt="Untitled"></p>
<h2 id="power-shell-실행"><a href="#power-shell-실행" class="headerlink" title="power shell 실행"></a>power shell 실행</h2><p><img src="/images/WSL_Tool_installation/Untitled%204.png" alt="Untitled"></p>
<p><img src="/images/WSL_Tool_installation/Untitled%205.png" alt="Untitled"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart</span><br><span class="line"></span><br><span class="line">dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart</span><br></pre></td></tr></table></figure>

<h2 id="다운로드-및-설치"><a href="#다운로드-및-설치" class="headerlink" title="다운로드 및 설치"></a>다운로드 및 설치</h2><p><code>[https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi](https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi)</code>  (다운로드, 설치)</p>
<h2 id="microsoft-store-에서-ubuntu-20-04-4LST-설치"><a href="#microsoft-store-에서-ubuntu-20-04-4LST-설치" class="headerlink" title="microsoft store 에서 ubuntu 20.04.4LST 설치"></a>microsoft store 에서 ubuntu 20.04.4LST 설치</h2><p><img src="/images/WSL_Tool_installation/Untitled%206.png" alt="Untitled"></p>
<p><img src="/images/WSL_Tool_installation/Untitled%207.png" alt="Untitled"></p>
<p><img src="/images/WSL_Tool_installation/Untitled%208.png" alt="Untitled"></p>
<p><img src="/images/WSL_Tool_installation/Untitled%209.png" alt="Untitled"></p>
<ul>
<li>가상환경에 접속이 안돼있음</li>
</ul>
<p><img src="/images/WSL_Tool_installation/Untitled%2010.png" alt="Untitled"></p>
<p><img src="/images/WSL_Tool_installation/Untitled%2011.png" alt="Untitled"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: human</span><br><span class="line">password: 1234</span><br></pre></td></tr></table></figure>

<p><img src="/images/WSL_Tool_installation/Untitled%2012.png" alt="Untitled"></p>
<h2 id="powershell-끄고-관리자로-재실행"><a href="#powershell-끄고-관리자로-재실행" class="headerlink" title="powershell 끄고 관리자로 재실행"></a>powershell 끄고 관리자로 재실행</h2><p><img src="/images/WSL_Tool_installation/Untitled%2013.png" alt="Untitled"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wsl --set-default-version 2</span><br><span class="line"></span><br><span class="line">wsl -l -v</span><br></pre></td></tr></table></figure>

<p><img src="/images/WSL_Tool_installation/Untitled%2014.png" alt="Untitled"></p>
<h2 id="version-2-확인"><a href="#version-2-확인" class="headerlink" title="version 2 확인"></a>version 2 확인</h2>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-인터넷 없이 가상환경에서 파이썬 사용하는 방법"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2022/07/13/%EC%9D%B8%ED%84%B0%EB%84%B7%20%EC%97%86%EC%9D%B4%20%EA%B0%80%EC%83%81%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C%20%ED%8C%8C%EC%9D%B4%EC%8D%AC%20%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94%20%EB%B0%A9%EB%B2%95/">인터넷 없이 가상환경에서 파이썬 사용하는 방법</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2022/07/13/%EC%9D%B8%ED%84%B0%EB%84%B7%20%EC%97%86%EC%9D%B4%20%EA%B0%80%EC%83%81%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C%20%ED%8C%8C%EC%9D%B4%EC%8D%AC%20%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94%20%EB%B0%A9%EB%B2%95/" class="article-date">
	  <time datetime="2022-07-12T16:00:00.000Z" itemprop="datePublished">July 13, 2022</time>
	</a>

       
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="인터넷-없이-가상환경에서-파이썬-사용하는-방법"><a href="#인터넷-없이-가상환경에서-파이썬-사용하는-방법" class="headerlink" title="인터넷 없이 가상환경에서 파이썬 사용하는 방법"></a>인터넷 없이 가상환경에서 파이썬 사용하는 방법</h1><p><img src="/images/no_internet_python/Untitled.png" alt="Untitled"></p>
<h3 id="2-파일을-파이참으로-실행하기"><a href="#2-파일을-파이참으로-실행하기" class="headerlink" title="2. 파일을 파이참으로 실행하기"></a>2. 파일을 파이참으로 실행하기</h3><p><img src="/images/no_internet_python/Untitled%201.png" alt="Untitled"></p>
<p><img src="/images/no_internet_python/Untitled%202.png" alt="Untitled"></p>
<h3 id="아나콘다가-아닌"><a href="#아나콘다가-아닌" class="headerlink" title="아나콘다가 아닌"></a>아나콘다가 아닌</h3><p><img src="/images/no_internet_python/Untitled%203.png" alt="Untitled"></p>
<p><img src="/images/no_internet_python/Untitled%204.png" alt="Untitled"></p>
<h3 id="아래로-설정-ok-버튼-누르면-변경-완료"><a href="#아래로-설정-ok-버튼-누르면-변경-완료" class="headerlink" title="아래로 설정, ok 버튼 누르면 변경 완료"></a>아래로 설정, ok 버튼 누르면 변경 완료</h3><p><img src="/images/no_internet_python/Untitled%205.png" alt="Untitled"></p>
<h3 id="변경-완료된-화면"><a href="#변경-완료된-화면" class="headerlink" title="변경 완료된 화면"></a>변경 완료된 화면</h3><p><img src="/images/no_internet_python/Untitled%206.png" alt="Untitled"></p>
<h3 id="3-기본-화면으로-돌아오면-venv-파일이-생성되어-있다"><a href="#3-기본-화면으로-돌아오면-venv-파일이-생성되어-있다" class="headerlink" title="3. 기본 화면으로 돌아오면 venv 파일이 생성되어 있다."></a>3. 기본 화면으로 돌아오면 venv 파일이 생성되어 있다.</h3><p><img src="/images/no_internet_python/Untitled%207.png" alt="Untitled"></p>
<h3 id="4-터미널을-켜고-git-bash를-연다"><a href="#4-터미널을-켜고-git-bash를-연다" class="headerlink" title="4. 터미널을 켜고 git bash를 연다"></a>4. 터미널을 켜고 git bash를 연다</h3><p><img src="/images/no_internet_python/Untitled%208.png" alt="Untitled"></p>
<h3 id="5-which-python-입력했을-때-venv로-들어-와있으면-가상환경-설정-완료"><a href="#5-which-python-입력했을-때-venv로-들어-와있으면-가상환경-설정-완료" class="headerlink" title="5. which python 입력했을 때 venv로 들어 와있으면 가상환경 설정 완료"></a>5. which python 입력했을 때 venv로 들어 와있으면 가상환경 설정 완료</h3><p><img src="/images/no_internet_python/Untitled%209.png" alt="Untitled"></p>
<h3 id="5-2-venv가-뜨지-않는다면"><a href="#5-2-venv가-뜨지-않는다면" class="headerlink" title="5.2. venv가 뜨지 않는다면"></a>5.2. venv가 뜨지 않는다면</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">source venv/Scripts/activate # 탭으로 경로 찾아야한다.</span><br><span class="line">	which python # 경로 재확인 venv 확인</span><br></pre></td></tr></table></figure>

<h3 id="6-install"><a href="#6-install" class="headerlink" title="6. install"></a>6. install</h3><ul>
<li>로컬이 아닌 가상환경에 설치</li>
<li>경로 확인 필수!</li>
<li>~&#x2F;Desktop&#x2F;kaggle_lexctures(파일명)</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">which python</span><br><span class="line"># 경로에 venv가 뜨는지 확인</span><br><span class="line"></span><br><span class="line">pip install numpy pandas matplotlib seaborn scikit-learn jupyterlab</span><br></pre></td></tr></table></figure>

<p><img src="/images/no_internet_python/Untitled%2010.png" alt="Untitled"></p>
<h3 id="설치-완료되면-Lib-파일이-생성된다"><a href="#설치-완료되면-Lib-파일이-생성된다" class="headerlink" title="설치 완료되면 Lib 파일이 생성된다"></a>설치 완료되면 Lib 파일이 생성된다</h3><p><img src="/images/no_internet_python/Untitled%2011.png" alt="Untitled"></p>
<h3 id="7-jupyter-lab"><a href="#7-jupyter-lab" class="headerlink" title="7. jupyter lab"></a>7. jupyter lab</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jupyter lab</span><br></pre></td></tr></table></figure>

<p><img src="/images/no_internet_python/Untitled%2012.png" alt="Untitled"></p>
<p><img src="/images/no_internet_python/Untitled%2013.png" alt="Untitled"></p>
<h3 id="원하는-내용-입력"><a href="#원하는-내용-입력" class="headerlink" title="원하는 내용 입력"></a>원하는 내용 입력</h3><p><img src="/images/no_internet_python/Untitled%2014.png" alt="Untitled"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">import numpy as np</span><br><span class="line">import seaborn as sns</span><br><span class="line">import matplotlib as mpl</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">import sklearn</span><br><span class="line"></span><br><span class="line"># 버전 확인</span><br><span class="line">print(&quot;pandas version : &quot;, pd.__version__)</span><br><span class="line">print(&quot;numpy version : &quot;, np.__version__)</span><br><span class="line">print(&quot;seaborn version: &quot;, sns.__version__)</span><br><span class="line">print(&quot;matplotlib version : &quot;, mpl.__version__)</span><br><span class="line">print(&quot;sklearn version : &quot;, mpl.__version__)</span><br></pre></td></tr></table></figure>

<h3 id="8-git-bash-터미널-사용"><a href="#8-git-bash-터미널-사용" class="headerlink" title="8. git bash 터미널 사용"></a>8. git bash 터미널 사용</h3><h3 id="파이참을-끄면-JupyterLab도-꺼진다"><a href="#파이참을-끄면-JupyterLab도-꺼진다" class="headerlink" title="파이참을 끄면 JupyterLab도 꺼진다."></a>파이참을 끄면 JupyterLab도 꺼진다.</h3><h3 id="JupyterLab을-사용하는-동안-터미널을-항상-열어-둬야-한다"><a href="#JupyterLab을-사용하는-동안-터미널을-항상-열어-둬야-한다" class="headerlink" title="JupyterLab을 사용하는 동안 터미널을 항상 열어 둬야 한다."></a>JupyterLab을 사용하는 동안 터미널을 항상 열어 둬야 한다.</h3><p><img src="/images/no_internet_python/Untitled%2015.png" alt="Untitled"></p>
<p><img src="/images/no_internet_python/Untitled%2016.png" alt="Untitled"></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-캐글 참여하는 방법"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2022/07/07/%EC%BA%90%EA%B8%80%20%EC%B0%B8%EC%97%AC%ED%95%98%EB%8A%94%20%EB%B0%A9%EB%B2%95/">캐글 참여하는 방법</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2022/07/07/%EC%BA%90%EA%B8%80%20%EC%B0%B8%EC%97%AC%ED%95%98%EB%8A%94%20%EB%B0%A9%EB%B2%95/" class="article-date">
	  <time datetime="2022-07-06T16:00:00.000Z" itemprop="datePublished">July 7, 2022</time>
	</a>

       
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="캐글-참여하는-방법"><a href="#캐글-참여하는-방법" class="headerlink" title="캐글 참여하는 방법"></a>캐글 참여하는 방법</h1><h2 id="1-참여하고자-하는-캐글-대회에-들어간다"><a href="#1-참여하고자-하는-캐글-대회에-들어간다" class="headerlink" title="1. 참여하고자 하는 캐글 대회에 들어간다."></a>1. 참여하고자 하는 캐글 대회에 들어간다.</h2><h2 id="2-code로-들어가서-New-Notebook을-클릭한다"><a href="#2-code로-들어가서-New-Notebook을-클릭한다" class="headerlink" title="2. code로 들어가서 New Notebook을 클릭한다."></a>2. code로 들어가서 New Notebook을 클릭한다.</h2><p><img src="/images/How_to_kaggle/Untitled.png" alt="Untitled"></p>
<h2 id="3-자동으로-파일이-생성된다"><a href="#3-자동으로-파일이-생성된다" class="headerlink" title="3. 자동으로 파일이 생성된다."></a>3. 자동으로 파일이 생성된다.</h2><p><img src="/images/How_to_kaggle/Untitled%201.png" alt="Untitled"></p>
<h2 id="4-input에-대회-데이터가-있는지-확인"><a href="#4-input에-대회-데이터가-있는지-확인" class="headerlink" title="4. input에 대회 데이터가 있는지 확인!"></a>4. input에 대회 데이터가 있는지 확인!</h2><h2 id="5-기본-코드-확인-실행하면-아래와-같은-주소가-생긴다"><a href="#5-기본-코드-확인-실행하면-아래와-같은-주소가-생긴다" class="headerlink" title="5. 기본 코드 확인, 실행하면 아래와 같은 주소가 생긴다."></a>5. 기본 코드 확인, 실행하면 아래와 같은 주소가 생긴다.</h2><p><img src="/images/How_to_kaggle/Untitled%202.png" alt="Untitled"></p>
<h2 id="6-라이브러리-불러오기-복붙"><a href="#6-라이브러리-불러오기-복붙" class="headerlink" title="6. 라이브러리 불러오기 (복붙)"></a>6. 라이브러리 불러오기 (복붙)</h2><ul>
<li>주요 라이브러리 버전을 확인한다.</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">import numpy as np</span><br><span class="line">import matplotlib as mpl</span><br><span class="line">import seaborn as sns</span><br><span class="line">import sklearn</span><br><span class="line">import xgboost as xgb</span><br><span class="line">import lightgbm as lgb</span><br><span class="line"></span><br><span class="line">print(&quot;pandas version :&quot;, pd.**version**)</span><br><span class="line">print(&quot;numpy version :&quot;, np.**version**)</span><br><span class="line">print(&quot;matplotlib version :&quot;, mpl.**version**)</span><br><span class="line">print(&quot;seaborn version :&quot;, sns.**version**)</span><br><span class="line">print(&quot;scikit-learn version :&quot;, sklearn.**version**)</span><br><span class="line">print(&quot;xgboost version :&quot;, xgb.**version**)</span><br><span class="line">print(&quot;lightgbm version :&quot;, lgb.**version**)</span><br></pre></td></tr></table></figure>

<h2 id="7-이하는-캐글-house-human-edu-파일-참조"><a href="#7-이하는-캐글-house-human-edu-파일-참조" class="headerlink" title="7. 이하는 캐글 house_human_edu 파일 참조"></a>7. 이하는 캐글 house_human_edu 파일 참조</h2><hr>
<h2 id="팁-1"><a href="#팁-1" class="headerlink" title="팁 1"></a>팁 1</h2><ul>
<li>code 의 필터로 사용한 코딩 언어를 설정하고, Most Votes를  통해 참고할 만한 코드를 확인할 수 있다.</li>
<li>이때 업데이트한지 얼마나 되었는지 확인한다!</li>
<li>지나치게 오래된 코드들은 버전 업데이트로 인해 오류가 생길 가능성이 높다.</li>
</ul>
<p><img src="/images/How_to_kaggle/Untitled%203.png" alt="Untitled"></p>
<h2 id="팁2"><a href="#팁2" class="headerlink" title="팁2"></a>팁2</h2><ul>
<li>해당 캐글 대회를 준비하면서 생기는 질문은 discission에 가면 팁을 얻을 수 있다.</li>
</ul>
<p><img src="/images/How_to_kaggle/Untitled%204.png" alt="Untitled"></p>
<h2 id="8-제출하기"><a href="#8-제출하기" class="headerlink" title="8. 제출하기"></a>8. 제출하기</h2><ul>
<li>Submit 클릭</li>
</ul>
<p><img src="/images/How_to_kaggle/Untitled%205.png" alt="Untitled"></p>
<h2 id="9-순위확인하기"><a href="#9-순위확인하기" class="headerlink" title="9. 순위확인하기"></a>9. 순위확인하기</h2><p><img src="/images/How_to_kaggle/Untitled%206.png" alt="Untitled"></p>
<p><img src="/images/How_to_kaggle/Untitled%207.png" alt="Untitled"></p>
<p><img src="/images/How_to_kaggle/Untitled%208.png" alt="Untitled"></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-시각화_복습_정리"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2022/07/06/%EC%8B%9C%EA%B0%81%ED%99%94_%EB%B3%B5%EC%8A%B5_%EC%A0%95%EB%A6%AC/">시각화 복습 정리</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2022/07/06/%EC%8B%9C%EA%B0%81%ED%99%94_%EB%B3%B5%EC%8A%B5_%EC%A0%95%EB%A6%AC/" class="article-date">
	  <time datetime="2022-07-05T16:00:00.000Z" itemprop="datePublished">July 6, 2022</time>
	</a>

       
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="0-자율학습"><a href="#0-자율학습" class="headerlink" title="0. 자율학습"></a>0. 자율학습</h1><ul>
<li>[그래프]<br><a target="_blank" rel="noopener" href="https://seaborn.pydata.org/tutorial.html">https://seaborn.pydata.org/tutorial.html</a></li>
<li>[색상값]<br><a target="_blank" rel="noopener" href="https://matplotlib.org/stable/tutorials/colors/colormaps.html">https://matplotlib.org/stable/tutorials/colors/colormaps.html</a></li>
</ul>
<h1 id="데이터-분석-머신러닝-딥러닝-프로세스"><a href="#데이터-분석-머신러닝-딥러닝-프로세스" class="headerlink" title="데이터 분석 (머신러닝, 딥러닝) 프로세스"></a>데이터 분석 (머신러닝, 딥러닝) 프로세스</h1><ul>
<li><ol>
<li>데이터 불러오기</li>
</ol>
<ul>
<li>csv, 오라클, MySQL, PostgreSQL, 클라우드 DB 연동</li>
</ul>
</li>
<li><ol start="2">
<li>데이터 탐색적 자료 분석</li>
</ol>
<ul>
<li>데이터 전처리 -&gt; 시각화 -&gt; 데이터 전처리 -&gt; 시각화 반복</li>
</ul>
</li>
<li><ol start="3">
<li>잠정적인 컬럼의 갯수를 지정하야 함. (pca)</li>
</ol>
</li>
<li><ol start="4">
<li>머신러닝 모델 (&#x3D;통계 모델링, t.test, 분산분석, 교차분석)</li>
</ol>
</li>
<li><ol start="5">
<li>머신러닝 모델의 경우 -&gt; 배포 (현재로서는 X)</li>
</ol>
<ul>
<li>JSP-스프링 웹개발시, 배우게 된다.</li>
</ul>
</li>
<li><ol start="6">
<li>통계 모델링의 경우, p-value 값 기준으로, 귀무가설 및 대립가설 검정</li>
</ol>
</li>
<li><ol start="7">
<li>(머신러닝, 딥러닝 공통) 결과 보고서를 작성해야 함.</li>
</ol>
<ul>
<li>PPT 만들어야 함.</li>
<li>사기업은 매출로 인증</li>
</ul>
</li>
</ul>
<h1 id="그래프-복습"><a href="#그래프-복습" class="headerlink" title="그래프 복습"></a>그래프 복습</h1><ul>
<li>수치형 데이터 시각화</li>
<li>범주형 데이터 시각화</li>
<li>데이터 관계 시각화</li>
<li>matplotlib 라이브러리 방법(복잡)</li>
<li>seaborn 라이브러리 방법(단순)<ul>
<li>복작합 그래프 그려야지!! –&gt; matpltoltib</li>
<li>1줄 그래프 –&gt; seaborn</li>
</ul>
</li>
</ul>
<h1 id="수치형-데이터-시각화"><a href="#수치형-데이터-시각화" class="headerlink" title="수치형 데이터 시각화"></a>수치형 데이터 시각화</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">titanic = sns.load_dataset(<span class="string">&#x27;titanic&#x27;</span>)</span><br><span class="line">titanic.head()</span><br><span class="line"><span class="comment"># print(titanic.head())</span></span><br><span class="line"><span class="comment"># 수치형 데이터인지 문자형 데이터인지, 이분법인지 연속성데이터인지</span></span><br></pre></td></tr></table></figure>





  <div id="df-1344c706-e32a-4f70-abbc-5585e3304147">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>embarked</th>
      <th>class</th>
      <th>who</th>
      <th>adult_male</th>
      <th>deck</th>
      <th>embark_town</th>
      <th>alive</th>
      <th>alone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>7.2500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>71.2833</td>
      <td>C</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Cherbourg</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.9250</td>
      <td>S</td>
      <td>Third</td>
      <td>woman</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>53.1000</td>
      <td>S</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.0500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-1344c706-e32a-4f70-abbc-5585e3304147')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg&quot;">http://www.w3.org/2000/svg&quot;</a> height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-1344c706-e32a-4f70-abbc-5585e3304147 button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-1344c706-e32a-4f70-abbc-5585e3304147&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;images/visualization_review/output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>




<h2 id="히스토그램"><a href="#히스토그램" class="headerlink" title="히스토그램"></a>히스토그램</h2><ul>
<li>ggplot와 식이 비슷함, 간단한데 그래프가 잘 나옴.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># bins =10 : 10으로 나누자,</span></span><br><span class="line"><span class="comment"># hue =&#x27;alive&#x27; : 살았냐 안살았냐</span></span><br><span class="line">sns.histplot(data = titanic, x=<span class="string">&#x27;age&#x27;</span>, bins =<span class="number">10</span>, hue =<span class="string">&#x27;alive&#x27;</span>, multiple = <span class="string">&#x27;stack&#x27;</span>)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb544f04110&gt;
</code></pre>
<p><img src="/images/visualization_review/output_7_1.png" alt="png"></p>
<ul>
<li>위 그래프를 통하여 ~~~ : 그래프에 대한 설명 추가</li>
</ul>
<h2 id="커널밀도추정-함수-그래프"><a href="#커널밀도추정-함수-그래프" class="headerlink" title="커널밀도추정 함수 그래프"></a>커널밀도추정 함수 그래프</h2><ul>
<li>연속형 데이터 1개만 쓸 때 사용</li>
<li>분포를 알아볼 때 사용</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.kdeplot(data = titanic, x =<span class="string">&#x27;age&#x27;</span>, hue = <span class="string">&#x27;alive&#x27;</span>, multiple= <span class="string">&#x27;stack&#x27;</span>)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb544e00450&gt;
</code></pre>
<p><img src="/images/visualization_review/output_10_1.png" alt="png"></p>
<h2 id="분포도"><a href="#분포도" class="headerlink" title="분포도"></a>분포도</h2><ul>
<li>수치형 데이터 한개 컬럼의 분포를 나타내는 그래프</li>
<li>정규분포인가?</li>
<li>비정규분포(치우침)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.displot(data = titanic, x=<span class="string">&#x27;age&#x27;</span>, kde = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7fb542d3c150&gt;
</code></pre>
<p><img src="/images/visualization_review/output_12_1.png" alt="png"></p>
<h1 id="범주형-데이터-시각화"><a href="#범주형-데이터-시각화" class="headerlink" title="범주형 데이터 시각화"></a>범주형 데이터 시각화</h1><ul>
<li>x축 범주형, y축 수치 데이터</li>
<li>x축 범주형, y축 범주형<ul>
<li>히트맵</li>
</ul>
</li>
</ul>
<h2 id="막대-그래프"><a href="#막대-그래프" class="headerlink" title="막대 그래프"></a>막대 그래프</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sns.barplot(x = <span class="string">&#x27;class&#x27;</span>, y=<span class="string">&#x27;fare&#x27;</span>, data=titanic)</span><br><span class="line"><span class="comment"># error bar : 오차 막대</span></span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb54038bf90&gt;
</code></pre>
<p><img src="/images/visualization_review/output_15_1.png" alt="png"></p>
<h2 id="포인트-플롯"><a href="#포인트-플롯" class="headerlink" title="포인트 플롯"></a>포인트 플롯</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sns.pointplot(x=<span class="string">&#x27;class&#x27;</span>, y=<span class="string">&#x27;fare&#x27;</span>, data=titanic)</span><br><span class="line"><span class="comment"># 강사님 블로그에 사이즈 변경하는 방법 나옴....그래프 까야됨.</span></span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb54038ba50&gt;
</code></pre>
<p><img src="/images/visualization_review/output_17_1.png" alt="png"></p>
<h2 id="박스-플롯"><a href="#박스-플롯" class="headerlink" title="박스 플롯"></a>박스 플롯</h2><ul>
<li>제1사 분위 : 전체 데이터 중 하위 2%</li>
<li>사분위 범위 수(IQR) : 제 3사분위 - 제 1사분위</li>
<li>최댓값: 제 3사분위 + (1.5 * IQR)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># boxplot</span></span><br><span class="line">sns.boxplot(x=<span class="string">&#x27;class&#x27;</span>,y=<span class="string">&#x27;age&#x27;</span>, data=titanic)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb54028dc50&gt;
</code></pre>
<p><img src="/images/visualization_review/output_19_1.png" alt="png"></p>
<h2 id="바이올린-플롯"><a href="#바이올린-플롯" class="headerlink" title="바이올린 플롯"></a>바이올린 플롯</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.violinplot(x=<span class="string">&#x27;class&#x27;</span>, y=<span class="string">&#x27;age&#x27;</span>, hue=<span class="string">&#x27;sex&#x27;</span>,data=titanic, split=<span class="literal">True</span>);</span><br></pre></td></tr></table></figure>


<p><img src="/images/visualization_review/output_21_0.png" alt="png"></p>
<h2 id="카운트-플롯-범주형-데이터만"><a href="#카운트-플롯-범주형-데이터만" class="headerlink" title="카운트 플롯 (범주형 데이터만)"></a>카운트 플롯 (범주형 데이터만)</h2><ul>
<li>범주형 데이터의 갯수 확인 할 때 사용</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.countplot(x=<span class="string">&#x27;alive&#x27;</span>, data=titanic)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb5401965d0&gt;
</code></pre>
<p><img src="/images/visualization_review/output_23_1.png" alt="png"></p>
<h1 id="데이터-관계-시각화"><a href="#데이터-관계-시각화" class="headerlink" title="데이터 관계 시각화"></a>데이터 관계 시각화</h1><ul>
<li>여러 데이터 사이의 관계도 파악 위한 그래프</li>
</ul>
<h2 id="히트맵"><a href="#히트맵" class="headerlink" title="히트맵"></a>히트맵</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flights = sns.load_dataset(<span class="string">&#x27;flights&#x27;</span>)</span><br><span class="line"><span class="comment"># flights.head()</span></span><br><span class="line"><span class="built_in">print</span>(flights.head())</span><br></pre></td></tr></table></figure>

<pre><code>   year month  passengers
0  1949   Jan         112
1  1949   Feb         118
2  1949   Mar         132
3  1949   Apr         129
4  1949   May         121
</code></pre>
<ul>
<li>각 연도별, 월별 승객수 구하기</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flights[<span class="string">&#x27;year&#x27;</span>].value_counts()</span><br></pre></td></tr></table></figure>




<pre><code>1949    12
1950    12
1951    12
1952    12
1953    12
1954    12
1955    12
1956    12
1957    12
1958    12
1959    12
1960    12
Name: year, dtype: int64
</code></pre>
<h3 id="pivot-Pivot-Tables-피봇-테이블-만드는-법"><a href="#pivot-Pivot-Tables-피봇-테이블-만드는-법" class="headerlink" title="pivot() Pivot Tables (피봇 테이블) 만드는 법"></a>pivot() Pivot Tables (피봇 테이블) 만드는 법</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 피벗 만드는 방법</span></span><br><span class="line"><span class="comment"># 코드를 판다스 튜토리얼에서 나온대로 입력 -&gt; 이해 -&gt; 적용</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;foo&#x27;</span>: [<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;two&#x27;</span>,</span><br><span class="line">                           <span class="string">&#x27;two&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;bar&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;baz&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>],</span><br><span class="line">                   <span class="string">&#x27;zoo&#x27;</span>: [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;t&#x27;</span>]&#125;)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>





  <div id="df-0a0646f2-2e34-4e11-9cf8-81b372e31345">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>foo</th>
      <th>bar</th>
      <th>baz</th>
      <th>zoo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>one</td>
      <td>A</td>
      <td>1</td>
      <td>x</td>
    </tr>
    <tr>
      <th>1</th>
      <td>one</td>
      <td>B</td>
      <td>2</td>
      <td>y</td>
    </tr>
    <tr>
      <th>2</th>
      <td>one</td>
      <td>C</td>
      <td>3</td>
      <td>z</td>
    </tr>
    <tr>
      <th>3</th>
      <td>two</td>
      <td>A</td>
      <td>4</td>
      <td>q</td>
    </tr>
    <tr>
      <th>4</th>
      <td>two</td>
      <td>B</td>
      <td>5</td>
      <td>w</td>
    </tr>
    <tr>
      <th>5</th>
      <td>two</td>
      <td>C</td>
      <td>6</td>
      <td>t</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-0a0646f2-2e34-4e11-9cf8-81b372e31345')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg&quot;">http://www.w3.org/2000/svg&quot;</a> height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-0a0646f2-2e34-4e11-9cf8-81b372e31345 button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-0a0646f2-2e34-4e11-9cf8-81b372e31345&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;images/visualization_review/output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>





<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.pivot(index=<span class="string">&#x27;foo&#x27;</span>, columns=<span class="string">&#x27;bar&#x27;</span>, values=<span class="string">&#x27;baz&#x27;</span>)</span><br></pre></td></tr></table></figure>





  <div id="df-0e2601f4-c5cb-44ce-999f-9807879e477e">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>bar</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
    <tr>
      <th>foo</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>one</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>two</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-0e2601f4-c5cb-44ce-999f-9807879e477e')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg&quot;">http://www.w3.org/2000/svg&quot;</a> height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-0e2601f4-c5cb-44ce-999f-9807879e477e button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-0e2601f4-c5cb-44ce-999f-9807879e477e&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;images/visualization_review/output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>





<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flights_pivot = flights.pivot(index = <span class="string">&#x27;month&#x27;</span>, columns= <span class="string">&#x27;year&#x27;</span> , values=<span class="string">&#x27;passengers&#x27;</span>)</span><br><span class="line">flights_pivot</span><br><span class="line"><span class="comment"># 어디가 많고 적인지 직관적이게 안보인다.</span></span><br></pre></td></tr></table></figure>





  <div id="df-3b2f007f-2107-4d2f-9f91-f507488b3d8c">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>year</th>
      <th>1949</th>
      <th>1950</th>
      <th>1951</th>
      <th>1952</th>
      <th>1953</th>
      <th>1954</th>
      <th>1955</th>
      <th>1956</th>
      <th>1957</th>
      <th>1958</th>
      <th>1959</th>
      <th>1960</th>
    </tr>
    <tr>
      <th>month</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Jan</th>
      <td>112</td>
      <td>115</td>
      <td>145</td>
      <td>171</td>
      <td>196</td>
      <td>204</td>
      <td>242</td>
      <td>284</td>
      <td>315</td>
      <td>340</td>
      <td>360</td>
      <td>417</td>
    </tr>
    <tr>
      <th>Feb</th>
      <td>118</td>
      <td>126</td>
      <td>150</td>
      <td>180</td>
      <td>196</td>
      <td>188</td>
      <td>233</td>
      <td>277</td>
      <td>301</td>
      <td>318</td>
      <td>342</td>
      <td>391</td>
    </tr>
    <tr>
      <th>Mar</th>
      <td>132</td>
      <td>141</td>
      <td>178</td>
      <td>193</td>
      <td>236</td>
      <td>235</td>
      <td>267</td>
      <td>317</td>
      <td>356</td>
      <td>362</td>
      <td>406</td>
      <td>419</td>
    </tr>
    <tr>
      <th>Apr</th>
      <td>129</td>
      <td>135</td>
      <td>163</td>
      <td>181</td>
      <td>235</td>
      <td>227</td>
      <td>269</td>
      <td>313</td>
      <td>348</td>
      <td>348</td>
      <td>396</td>
      <td>461</td>
    </tr>
    <tr>
      <th>May</th>
      <td>121</td>
      <td>125</td>
      <td>172</td>
      <td>183</td>
      <td>229</td>
      <td>234</td>
      <td>270</td>
      <td>318</td>
      <td>355</td>
      <td>363</td>
      <td>420</td>
      <td>472</td>
    </tr>
    <tr>
      <th>Jun</th>
      <td>135</td>
      <td>149</td>
      <td>178</td>
      <td>218</td>
      <td>243</td>
      <td>264</td>
      <td>315</td>
      <td>374</td>
      <td>422</td>
      <td>435</td>
      <td>472</td>
      <td>535</td>
    </tr>
    <tr>
      <th>Jul</th>
      <td>148</td>
      <td>170</td>
      <td>199</td>
      <td>230</td>
      <td>264</td>
      <td>302</td>
      <td>364</td>
      <td>413</td>
      <td>465</td>
      <td>491</td>
      <td>548</td>
      <td>622</td>
    </tr>
    <tr>
      <th>Aug</th>
      <td>148</td>
      <td>170</td>
      <td>199</td>
      <td>242</td>
      <td>272</td>
      <td>293</td>
      <td>347</td>
      <td>405</td>
      <td>467</td>
      <td>505</td>
      <td>559</td>
      <td>606</td>
    </tr>
    <tr>
      <th>Sep</th>
      <td>136</td>
      <td>158</td>
      <td>184</td>
      <td>209</td>
      <td>237</td>
      <td>259</td>
      <td>312</td>
      <td>355</td>
      <td>404</td>
      <td>404</td>
      <td>463</td>
      <td>508</td>
    </tr>
    <tr>
      <th>Oct</th>
      <td>119</td>
      <td>133</td>
      <td>162</td>
      <td>191</td>
      <td>211</td>
      <td>229</td>
      <td>274</td>
      <td>306</td>
      <td>347</td>
      <td>359</td>
      <td>407</td>
      <td>461</td>
    </tr>
    <tr>
      <th>Nov</th>
      <td>104</td>
      <td>114</td>
      <td>146</td>
      <td>172</td>
      <td>180</td>
      <td>203</td>
      <td>237</td>
      <td>271</td>
      <td>305</td>
      <td>310</td>
      <td>362</td>
      <td>390</td>
    </tr>
    <tr>
      <th>Dec</th>
      <td>118</td>
      <td>140</td>
      <td>166</td>
      <td>194</td>
      <td>201</td>
      <td>229</td>
      <td>278</td>
      <td>306</td>
      <td>336</td>
      <td>337</td>
      <td>405</td>
      <td>432</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-3b2f007f-2107-4d2f-9f91-f507488b3d8c')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg&quot;">http://www.w3.org/2000/svg&quot;</a> height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-3b2f007f-2107-4d2f-9f91-f507488b3d8c button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-3b2f007f-2107-4d2f-9f91-f507488b3d8c&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;images/visualization_review/output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>





<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.heatmap(data = flights_pivot)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb53fe51450&gt;
</code></pre>
<p><img src="/images/visualization_review/output_33_1.png" alt="png"></p>
<h2 id="라인플롯"><a href="#라인플롯" class="headerlink" title="라인플롯"></a>라인플롯</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.lineplot(x=<span class="string">&#x27;year&#x27;</span>, y=<span class="string">&#x27;passengers&#x27;</span>, data = flights)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb53fd75750&gt;
</code></pre>
<p><img src="/images/visualization_review/output_35_1.png" alt="png"></p>
<h2 id="산점도"><a href="#산점도" class="headerlink" title="산점도"></a>산점도</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tips = sns.load_dataset(<span class="string">&#x27;tips&#x27;</span>)</span><br><span class="line"><span class="comment"># tips.head()</span></span><br><span class="line"><span class="built_in">print</span>(tips.head())</span><br></pre></td></tr></table></figure>





  <div id="df-d6561988-7c33-4c45-9ae2-8e33a8ee44fd">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bill</th>
      <th>tip</th>
      <th>sex</th>
      <th>smoker</th>
      <th>day</th>
      <th>time</th>
      <th>size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16.99</td>
      <td>1.01</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.34</td>
      <td>1.66</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21.01</td>
      <td>3.50</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>23.68</td>
      <td>3.31</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>24.59</td>
      <td>3.61</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-d6561988-7c33-4c45-9ae2-8e33a8ee44fd')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg&quot;">http://www.w3.org/2000/svg&quot;</a> height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-d6561988-7c33-4c45-9ae2-8e33a8ee44fd button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-d6561988-7c33-4c45-9ae2-8e33a8ee44fd&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;images/visualization_review/output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>




<ul>
<li>두개의 연속형 데이터<ul>
<li>size는 카운트데이터이지 연속형 데이터는 아니다</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sns.scatterplot(x=<span class="string">&#x27;total_bill&#x27;</span>, y=<span class="string">&#x27;tip&#x27;</span>, hue = <span class="string">&#x27;time&#x27;</span>, data= tips)</span><br><span class="line"><span class="comment"># 점심 보다 저녁에 팁을 더 높게 준다.</span></span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb540196a10&gt;
</code></pre>
<p><img src="/images/visualization_review/output_39_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sns.scatterplot(x=<span class="string">&#x27;total_bill&#x27;</span>, y=<span class="string">&#x27;tip&#x27;</span>, hue = <span class="string">&#x27;sex&#x27;</span>, data= tips)</span><br><span class="line"><span class="comment"># 왜 여자가 남자보다 팁을 더 적게 줄까?</span></span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb5404093d0&gt;
</code></pre>
<p><img src="/images/visualization_review/output_40_1.png" alt="png"></p>
<h2 id="회귀선"><a href="#회귀선" class="headerlink" title="회귀선"></a>회귀선</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sns.regplot(x= <span class="string">&#x27;total_bill&#x27;</span>, y=<span class="string">&#x27;tip&#x27;</span>, data=tips)</span><br><span class="line"><span class="comment"># 정확한 수치를 알고 싶다면 기울기를 알아야 한다.</span></span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb53fc0fa10&gt;
</code></pre>
<p><img src="/images/visualization_review/output_42_1.png" alt="png"></p>
<h1 id="머신러닝-리뷰"><a href="#머신러닝-리뷰" class="headerlink" title="머신러닝 리뷰"></a>머신러닝 리뷰</h1><ul>
<li>가장 인기 있는 모델 <ul>
<li>LightGBM,. XGboost</li>
</ul>
</li>
</ul>
<h2 id="선형-회귀"><a href="#선형-회귀" class="headerlink" title="선형 회귀"></a>선형 회귀</h2><ul>
<li>선형 회귀식을 찾는 것이 중요</li>
<li>$y &#x3D; 3x + 4$에 근사한 데이터 50개 생성</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 시드값 고정</span></span><br><span class="line">np.random.seed(<span class="number">0</span>)</span><br><span class="line">intercept = <span class="number">4</span> <span class="comment"># 절편, 상수</span></span><br><span class="line">slope = <span class="number">3</span> <span class="comment"># 기울기</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 변동성 주기 위해 노이즈 생성</span></span><br><span class="line">noise = np.random.randn(<span class="number">50</span>,<span class="number">1</span>)</span><br><span class="line">x=<span class="number">5</span>* np.random.rand(<span class="number">50</span>,<span class="number">1</span>) <span class="comment"># 0과 5 사이의 실숫값 50개 생성</span></span><br><span class="line">y = slope * x + intercept + noise</span><br><span class="line"></span><br><span class="line"><span class="comment"># 데이터 프레임 생성</span></span><br><span class="line">data = pd.DataFrame(&#123;<span class="string">&#x27;X&#x27;</span>: x[:,<span class="number">0</span>], <span class="string">&#x27;Y&#x27;</span>: y[:,<span class="number">0</span>]&#125;)</span><br><span class="line"><span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure>

<pre><code>           X          Y
0   0.794848   8.148596
1   0.551876   6.055784
2   3.281648  14.823682
3   0.690915   8.313637
4   0.982912   8.816293
5   1.843626   8.553600
6   4.104966  17.264987
7   0.485506   5.305162
8   4.189725  16.465955
9   0.480492   5.852075
10  4.882297  18.790936
11  2.343256  12.484042
12  4.883805  19.412454
13  3.024228  13.194358
14  3.696318  15.532817
15  0.195939   4.921491
16  1.414035   9.736184
17  0.600983   5.597790
18  1.480701   8.755171
19  0.593639   4.926820
20  1.589916   6.216758
21  2.071315  10.867564
22  0.320737   5.826649
23  3.462361  13.644917
24  2.833007  14.768776
25  1.326947   6.526477
26  2.616240  11.894479
27  0.469703   5.221924
28  2.879732  14.171977
29  4.646481  19.408802
30  1.592845   8.933482
31  3.337052  14.389318
32  0.658989   5.089182
33  3.581636  12.764112
34  1.447030   7.993179
35  0.915957   6.904219
36  2.932565  14.027985
37  0.100538   5.503993
38  4.144700  16.046774
39  0.023477   3.768129
40  3.389083  13.118695
41  1.350040   6.630102
42  3.675970  13.321640
43  4.810943  20.383604
44  1.243766   7.221645
45  2.880787  12.204286
46  2.960210  11.627834
47  2.861260  13.361269
48  1.115408   5.732327
49  4.763745  18.078495
</code></pre>
  <div id="df-5f1cdf6e-a2cc-43eb-8402-b062efbc280a">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.794848</td>
      <td>8.148596</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.551876</td>
      <td>6.055784</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.281648</td>
      <td>14.823682</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.690915</td>
      <td>8.313637</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.982912</td>
      <td>8.816293</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.843626</td>
      <td>8.553600</td>
    </tr>
    <tr>
      <th>6</th>
      <td>4.104966</td>
      <td>17.264987</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.485506</td>
      <td>5.305162</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4.189725</td>
      <td>16.465955</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.480492</td>
      <td>5.852075</td>
    </tr>
    <tr>
      <th>10</th>
      <td>4.882297</td>
      <td>18.790936</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2.343256</td>
      <td>12.484042</td>
    </tr>
    <tr>
      <th>12</th>
      <td>4.883805</td>
      <td>19.412454</td>
    </tr>
    <tr>
      <th>13</th>
      <td>3.024228</td>
      <td>13.194358</td>
    </tr>
    <tr>
      <th>14</th>
      <td>3.696318</td>
      <td>15.532817</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.195939</td>
      <td>4.921491</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1.414035</td>
      <td>9.736184</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0.600983</td>
      <td>5.597790</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1.480701</td>
      <td>8.755171</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.593639</td>
      <td>4.926820</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1.589916</td>
      <td>6.216758</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2.071315</td>
      <td>10.867564</td>
    </tr>
    <tr>
      <th>22</th>
      <td>0.320737</td>
      <td>5.826649</td>
    </tr>
    <tr>
      <th>23</th>
      <td>3.462361</td>
      <td>13.644917</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2.833007</td>
      <td>14.768776</td>
    </tr>
    <tr>
      <th>25</th>
      <td>1.326947</td>
      <td>6.526477</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2.616240</td>
      <td>11.894479</td>
    </tr>
    <tr>
      <th>27</th>
      <td>0.469703</td>
      <td>5.221924</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2.879732</td>
      <td>14.171977</td>
    </tr>
    <tr>
      <th>29</th>
      <td>4.646481</td>
      <td>19.408802</td>
    </tr>
    <tr>
      <th>30</th>
      <td>1.592845</td>
      <td>8.933482</td>
    </tr>
    <tr>
      <th>31</th>
      <td>3.337052</td>
      <td>14.389318</td>
    </tr>
    <tr>
      <th>32</th>
      <td>0.658989</td>
      <td>5.089182</td>
    </tr>
    <tr>
      <th>33</th>
      <td>3.581636</td>
      <td>12.764112</td>
    </tr>
    <tr>
      <th>34</th>
      <td>1.447030</td>
      <td>7.993179</td>
    </tr>
    <tr>
      <th>35</th>
      <td>0.915957</td>
      <td>6.904219</td>
    </tr>
    <tr>
      <th>36</th>
      <td>2.932565</td>
      <td>14.027985</td>
    </tr>
    <tr>
      <th>37</th>
      <td>0.100538</td>
      <td>5.503993</td>
    </tr>
    <tr>
      <th>38</th>
      <td>4.144700</td>
      <td>16.046774</td>
    </tr>
    <tr>
      <th>39</th>
      <td>0.023477</td>
      <td>3.768129</td>
    </tr>
    <tr>
      <th>40</th>
      <td>3.389083</td>
      <td>13.118695</td>
    </tr>
    <tr>
      <th>41</th>
      <td>1.350040</td>
      <td>6.630102</td>
    </tr>
    <tr>
      <th>42</th>
      <td>3.675970</td>
      <td>13.321640</td>
    </tr>
    <tr>
      <th>43</th>
      <td>4.810943</td>
      <td>20.383604</td>
    </tr>
    <tr>
      <th>44</th>
      <td>1.243766</td>
      <td>7.221645</td>
    </tr>
    <tr>
      <th>45</th>
      <td>2.880787</td>
      <td>12.204286</td>
    </tr>
    <tr>
      <th>46</th>
      <td>2.960210</td>
      <td>11.627834</td>
    </tr>
    <tr>
      <th>47</th>
      <td>2.861260</td>
      <td>13.361269</td>
    </tr>
    <tr>
      <th>48</th>
      <td>1.115408</td>
      <td>5.732327</td>
    </tr>
    <tr>
      <th>49</th>
      <td>4.763745</td>
      <td>18.078495</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-5f1cdf6e-a2cc-43eb-8402-b062efbc280a')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg&quot;">http://www.w3.org/2000/svg&quot;</a> height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-5f1cdf6e-a2cc-43eb-8402-b062efbc280a button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-5f1cdf6e-a2cc-43eb-8402-b062efbc280a&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;images/visualization_review/output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>





<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line">ax.scatter(data[<span class="string">&#x27;X&#x27;</span>], data[<span class="string">&#x27;Y&#x27;</span>])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/images/visualization_review/output_46_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns </span><br><span class="line">sns.scatterplot(x = <span class="string">&#x27;X&#x27;</span>, y = <span class="string">&#x27;Y&#x27;</span>, data = data)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb53f5fe490&gt;
</code></pre>
<p><img src="/images/visualization_review/output_47_1.png" alt="png"></p>
<h2 id="선형-회귀-모형-훈련"><a href="#선형-회귀-모형-훈련" class="headerlink" title="선형 회귀 모형 훈련"></a>선형 회귀 모형 훈련</h2><ul>
<li>모형 생성 후, 회귀계수 3과 y절편 4에 근사한 값이 나와야 함.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line">lr_model = LinearRegression() <span class="comment">#선형 회귀 모델</span></span><br><span class="line">lr_model.fit(x,y) <span class="comment"># 모델 훈련</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;y절편:&#x27;</span>, lr_model.intercept_)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;회귀계수:&#x27;</span>, lr_model.coef_)</span><br></pre></td></tr></table></figure>

<pre><code>y절편: [4.05757639]
회귀계수: [[3.03754061]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 예측값</span></span><br><span class="line">y_pred = lr_model.predict(x)</span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line">ax.scatter(x, y)</span><br><span class="line">ax.plot(x, y_pred, color=<span class="string">&#x27;green&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># slope, intercept </span></span><br><span class="line">label = <span class="string">&#x27;slope: &#123;&#125;\nintercept: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">round</span>(lr_model.coef_[<span class="number">0</span>][<span class="number">0</span>], <span class="number">2</span>), <span class="built_in">round</span>(lr_model.intercept_[<span class="number">0</span>], <span class="number">2</span>))</span><br><span class="line">ax.text(<span class="number">3.5</span>, <span class="number">4</span>, label, style =<span class="string">&#x27;italic&#x27;</span>, </span><br><span class="line">        fontsize = <span class="number">10</span>, color =<span class="string">&quot;green&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/images/visualization_review/output_50_0.png" alt="png"></p>
<h3 id="로지스틱-회귀"><a href="#로지스틱-회귀" class="headerlink" title="로지스틱 회귀"></a>로지스틱 회귀</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sigmoid</span>(<span class="params">arr, scale=<span class="number">1</span></span>):</span><br><span class="line">    arr = np.asarray(arr)</span><br><span class="line">    result = <span class="number">1</span>/(<span class="number">1</span> + np.exp(-arr*scale))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">x = np.linspace(-<span class="number">6</span>, <span class="number">6</span>)</span><br><span class="line">y = sigmoid(x)</span><br><span class="line"></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line">ax.plot(x, y)</span><br><span class="line">ax.grid(which=<span class="string">&#x27;major&#x27;</span>, axis=<span class="string">&#x27;y&#x27;</span>, linestyle=<span class="string">&#x27;--&#x27;</span>)</span><br><span class="line">ax.axvline(x=<span class="number">0</span>, color=<span class="string">&#x27;r&#x27;</span>, linestyle=<span class="string">&#x27;--&#x27;</span>, linewidth=<span class="number">1</span>)</span><br><span class="line">ax.set_ylim(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">ax.set_yticks([<span class="number">0</span>, <span class="number">1</span>, <span class="number">0.5</span>])</span><br><span class="line">ax.text(<span class="number">0</span>-<span class="number">0.1</span>, <span class="number">0.5</span>, <span class="string">&#x27;0.5&#x27;</span>, ha=<span class="string">&#x27;right&#x27;</span>)</span><br><span class="line">ax.set_title(<span class="string">&#x27;Sigmoid Graph&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/images/visualization_review/output_52_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 라이브러리 불러오기</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report, confusion_matrix</span><br><span class="line"></span><br><span class="line"><span class="comment"># 데이터 가져오기</span></span><br><span class="line">x = np.arange(<span class="number">10</span>).reshape(-<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">y = np.array([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 모델 생성 및 학습</span></span><br><span class="line">model = LogisticRegression(solver=<span class="string">&#x27;liblinear&#x27;</span>, C=<span class="number">10.0</span>, random_state=<span class="number">0</span>)</span><br><span class="line">model.fit(x, y)</span><br></pre></td></tr></table></figure>




<pre><code>LogisticRegression(C=10.0, random_state=0, solver=&#39;liblinear&#39;)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 모형 평가</span></span><br><span class="line">p_pred = model.predict_proba(x)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p_pred&#x27;</span>, p_pred, sep =<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>

<pre><code>p_pred
[[0.97979027 0.02020973]
 [0.94958202 0.05041798]
 [0.87976149 0.12023851]
 [0.73975066 0.26024934]
 [0.52477284 0.47522716]
 [0.30020373 0.69979627]
 [0.1428487  0.8571513 ]
 [0.06080627 0.93919373]
 [0.02453462 0.97546538]
 [0.00967652 0.99032348]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y_pred = model.predict(x)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;y_pred&#x27;</span>, y_pred)</span><br></pre></td></tr></table></figure>

<pre><code>y_pred [0 0 0 0 0 1 1 1 1 1]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">fig, ax = plt.subplots()</span><br><span class="line">ax.scatter(x, y)</span><br><span class="line">ax.plot(x, p_pred[:, <span class="number">1</span>], color = <span class="string">&#x27;black&#x27;</span>,  marker=<span class="string">&#x27;o&#x27;</span>, markersize=<span class="number">6</span>)</span><br><span class="line">ax.plot()</span><br><span class="line"></span><br><span class="line">ax.set_xticks(x)</span><br><span class="line">ax.set_yticks(np.arange(<span class="number">0</span>, <span class="number">1.1</span>, <span class="number">0.1</span>))</span><br><span class="line"></span><br><span class="line">ax.grid(which=<span class="string">&#x27;major&#x27;</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># y축 확률값, 1양성, 0음성, 검은 색이 각각의 확률값</span></span><br></pre></td></tr></table></figure>


<p><img src="/images/visualization_review/output_56_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conf_m = confusion_matrix(y, y_pred)</span><br><span class="line"><span class="built_in">print</span>(conf_m)</span><br></pre></td></tr></table></figure>

<pre><code>[[5 0]
 [0 5]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">cm = confusion_matrix(y, y_pred)</span><br><span class="line"></span><br><span class="line">fig, ax = plt.subplots(figsize=(<span class="number">8</span>, <span class="number">8</span>))</span><br><span class="line">ax.imshow(cm, cmap = <span class="string">&#x27;Pastel2&#x27;</span>)   <span class="comment"># 색상 변경</span></span><br><span class="line"><span class="comment"># https://matplotlib.org/stable/tutorials/colors/colormaps.html</span></span><br><span class="line">ax.grid(<span class="literal">False</span>)</span><br><span class="line">ax.xaxis.<span class="built_in">set</span>(ticks=(<span class="number">0</span>, <span class="number">1</span>), ticklabels=(<span class="string">&#x27;Predicted 0&#x27;</span>, <span class="string">&#x27;Predicted 1&#x27;</span>))</span><br><span class="line">ax.yaxis.<span class="built_in">set</span>(ticks=(<span class="number">0</span>, <span class="number">1</span>), ticklabels=(<span class="string">&#x27;Actual 0&#x27;</span>, <span class="string">&#x27;Actual 1&#x27;</span>))</span><br><span class="line">ax.set_ylim(<span class="number">1.5</span>, -<span class="number">0.5</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        ax.text(j, i, cm[i, j], ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;center&#x27;</span>, color=<span class="string">&#x27;black&#x27;</span>, fontsize=<span class="number">20</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/images/visualization_review/output_58_0.png" alt="png"></p>
<h3 id="결정-트리"><a href="#결정-트리" class="headerlink" title="결정 트리"></a>결정 트리</h3><ul>
<li>분류와 회귀 문제에 모두 사용 가능</li>
</ul>
<h4 id="주요-개념"><a href="#주요-개념" class="headerlink" title="주요 개념"></a>주요 개념</h4><ul>
<li>작동 원리<ul>
<li>데이터를 가장 잘 구분하는 조건을 정함.</li>
<li>조건을 기준으로 데이터를 두 범주로 나눔</li>
<li>나뉜 각 범주의 데이터를 구분하는 조건을 정함</li>
<li>각 조건을 기준으로 데이터를 두 범주로 나눔</li>
<li>언제까지 계속 분할할지 정한 후, 최종 결정 값을 구함.</li>
</ul>
</li>
<li>불순도(Impurity)<ul>
<li>한 범주 안에 서로 다른 데이터가 얼마나 섞여 있는지 나타냄</li>
<li>흰색과 검은색이 50:50으로 섞여 있다. (불순도 최대)</li>
<li>흰색과 검은색으로 완전 분리 되었다. (불순도 최소)</li>
</ul>
</li>
<li>엔트로피(Entropy)<ul>
<li>불확실한 정도를 의미함. 0 ~ 1로 정함.</li>
<li>흰색과 검은색이 50:50으로 섞여 있다. 엔트로피 1</li>
<li>흰색과 검은색으로 완전 분리 되었다. 엔트로피 0</li>
</ul>
</li>
<li>정보이득(Information Gain)<ul>
<li>1에서 엔트로피를 뺀 수치</li>
<li>정보 이득을 최대화하는 방향(엔트로피를 최소화 하는 방향)으로 노드를 분할함</li>
</ul>
</li>
<li>지니 불순도(Gini Impurity)<ul>
<li>지니 불순도 값이 클수록 불순도도 높고, 작을수록 불순도도 낮음. 엔트로피와 마찬가지로 지니 불순도가 낮아지는 방향으로 노드 분할함.</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split </span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns </span><br><span class="line"></span><br><span class="line"><span class="comment"># tips 데이터셋 </span></span><br><span class="line">titanic = sns.load_dataset(<span class="string">&#x27;titanic&#x27;</span>)</span><br><span class="line">titanic.info()</span><br></pre></td></tr></table></figure>

<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 15 columns):
 #   Column       Non-Null Count  Dtype   
---  ------       --------------  -----   
 0   survived     891 non-null    int64   
 1   pclass       891 non-null    int64   
 2   sex          891 non-null    object  
 3   age          714 non-null    float64 
 4   sibsp        891 non-null    int64   
 5   parch        891 non-null    int64   
 6   fare         891 non-null    float64 
 7   embarked     889 non-null    object  
 8   class        891 non-null    category
 9   who          891 non-null    object  
 10  adult_male   891 non-null    bool    
 11  deck         203 non-null    category
 12  embark_town  889 non-null    object  
 13  alive        891 non-null    object  
 14  alone        891 non-null    bool    
dtypes: bool(2), category(2), float64(2), int64(4), object(5)
memory usage: 80.7+ KB
</code></pre>
<ul>
<li>survived 생존자 비율을 구하자<ul>
<li>0: 사망자</li>
<li>1: 생존자</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic[<span class="string">&#x27;survived&#x27;</span>].value_counts()</span><br></pre></td></tr></table></figure>




<pre><code>0    549
1    342
Name: survived, dtype: int64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 데이터 추출</span></span><br><span class="line">X = titanic[[<span class="string">&#x27;pclass&#x27;</span>, <span class="string">&#x27;parch&#x27;</span>, <span class="string">&#x27;fare&#x27;</span>]]</span><br><span class="line">y = titanic[<span class="string">&#x27;survived&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 훈련데이터, 테스트 데이터 분리</span></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, stratify = y, test_size = <span class="number">0.3</span>, random_state=<span class="number">42</span>)</span><br><span class="line">X_train.shape, X_test.shape, y_train.shape, y_test.shape</span><br></pre></td></tr></table></figure>




<pre><code>((623, 3), (268, 3), (623,), (268,))
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tree_model = DecisionTreeClassifier()</span><br><span class="line">tree_model.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line">acc = tree_model.score(X_test, y_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;모형 정확도 : <span class="subst">&#123;acc:<span class="number">.3</span>f&#125;</span>&#x27;</span>) <span class="comment"># 정확도 측정</span></span><br></pre></td></tr></table></figure>

<pre><code>모형 정확도 : 0.672
</code></pre>
<h3 id="랜덤-포레스트-x3D-디시젼-트리-외워"><a href="#랜덤-포레스트-x3D-디시젼-트리-외워" class="headerlink" title="랜덤 포레스트 &#x3D; 디시젼 트리 (외워!@)"></a>랜덤 포레스트 &#x3D; 디시젼 트리 (외워!@)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split </span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns </span><br><span class="line"></span><br><span class="line"><span class="comment"># tips 데이터셋 </span></span><br><span class="line">titanic = sns.load_dataset(<span class="string">&#x27;titanic&#x27;</span>)</span><br><span class="line"></span><br><span class="line">X = titanic[[<span class="string">&#x27;pclass&#x27;</span>, <span class="string">&#x27;parch&#x27;</span>, <span class="string">&#x27;fare&#x27;</span>]]</span><br><span class="line">y = titanic[<span class="string">&#x27;survived&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 훈련데이터, 테스트 데이터 분리</span></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, stratify = y, test_size = <span class="number">0.3</span>, random_state=<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 모델 훈련</span></span><br><span class="line">rf_model = RandomForestClassifier(random_state=<span class="number">42</span>) <span class="comment"># 랜덤 포레스트 정의</span></span><br><span class="line">rf_model.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line">acc = rf_model.score(X_test, y_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;모형 정확도 : <span class="subst">&#123;acc:<span class="number">.3</span>f&#125;</span>&#x27;</span>) <span class="comment"># 정확도 측정</span></span><br></pre></td></tr></table></figure>

<pre><code>모형 정확도 : 0.675
</code></pre>
<h1 id="XGBoost-amp-LightGBM-2016-2017"><a href="#XGBoost-amp-LightGBM-2016-2017" class="headerlink" title="XGBoost &amp; LightGBM (2016~2017)"></a>XGBoost &amp; LightGBM (2016~2017)</h1><ul>
<li>전통적인 머신러닝 알고리즘의 융합<ul>
<li>선형회귀 릿지 라쏘 과적합 방지 위한 규제</li>
<li>결정 트리의 핵심적인 알고리즘</li>
<li>경사 하강법</li>
</ul>
</li>
<li>문제점 : 파라미터의 개수가 매우 많음.</li>
<li>왜 많이 쓸까?<ul>
<li>모델 학습 속도</li>
<li>성능</li>
<li>가장 좋은 모델이란, 학습 속도는 빠르면서 성능은 좋은 것(지금까지 나온 알고리즘 보다)</li>
</ul>
</li>
<li>Python, JAVA<ul>
<li>C, C++ &#x2F; r data.table 패키지 또한 C, C++로 만들어짐</li>
</ul>
</li>
<li>추측<ul>
<li>큰 회사들 개발<ul>
<li>첫번째 옵션, 우리가 자체적으로 배포하자. -&gt;Python Wrapper API<ul>
<li>R, 머신러닝 프레임워크 종류 다양</li>
</ul>
</li>
<li>두번째 옵션, 파이썬 머신러닝 &#x3D; Scikit_Learn에서 쉽게 쓸 수 있도록 다시 개발, Scikit-Learn Wrapper API</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="XGBoost-Python-Wrapper-방식"><a href="#XGBoost-Python-Wrapper-방식" class="headerlink" title="XGBoost Python Wrapper 방식"></a>XGBoost Python Wrapper 방식</h2><ul>
<li>X-train, y_train</li>
<li>각 모듈에 맞도록 행렬을 재변환 해야함.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 코드 차이점을 생각</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> xgboost <span class="keyword">as</span> xgb </span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns </span><br><span class="line"></span><br><span class="line"><span class="comment"># 데이터 분리</span></span><br><span class="line">titanic = sns.load_dataset(<span class="string">&#x27;titanic&#x27;</span>)</span><br><span class="line"><span class="comment"># titanic.info()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># X 독립변수, y 종속변수</span></span><br><span class="line">X = titanic[[<span class="string">&#x27;pclass&#x27;</span>, <span class="string">&#x27;parch&#x27;</span>, <span class="string">&#x27;fare&#x27;</span>]]</span><br><span class="line">y = titanic[<span class="string">&#x27;survived&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 훈련데이터, 테스트 데이터 분리</span></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, </span><br><span class="line">                                                    y, </span><br><span class="line">                                                    stratify = y, </span><br><span class="line">                                                    test_size = <span class="number">0.3</span>, </span><br><span class="line">                                                    random_state=<span class="number">42</span>)</span><br><span class="line">X_train.shape, X_test.shape, y_train.shape, y_test.shape</span><br></pre></td></tr></table></figure>




<pre><code>((623, 3), (268, 3), (623,), (268,))
</code></pre>
<h3 id="별표-백개"><a href="#별표-백개" class="headerlink" title="별표 백개!!!!!"></a>별표 백개!!!!!</h3><ul>
<li>여기가 핵심</li>
<li>X_train -&gt; 사이킷런</li>
<li>여기에서 구분 가능</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># DMatrix -&gt;파이썬래퍼 Wrapper 코드</span></span><br><span class="line">dtrain=xgb.DMatrix(data = X_train, label =y_train)</span><br><span class="line">dtest = xgb.DMatrix(data = X_test, label = y_test)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dtrain)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;xgboost.core.DMatrix object at 0x7fb53e6dd090&gt;
</code></pre>
<ul>
<li>머신러닝 코드</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from sklearn.tree~~이런게 없음</span></span><br><span class="line"><span class="comment"># xgb.train -&gt; 파이썬 래퍼  Wrapper 코드</span></span><br><span class="line">params = &#123;</span><br><span class="line">    <span class="string">&#x27;max_depth&#x27;</span> : <span class="number">3</span>,</span><br><span class="line">    <span class="string">&#x27;n_est imators&#x27;</span> : <span class="number">100</span>,</span><br><span class="line">    <span class="string">&#x27;eta&#x27;</span> : <span class="number">0.1</span>,</span><br><span class="line">    <span class="string">&#x27;objective&#x27;</span> : <span class="string">&#x27;binary:logistic&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">num_rounds = <span class="number">400</span>  <span class="comment"># 의사결정나무 에폭크와 비슷</span></span><br><span class="line"></span><br><span class="line">w_list = [(dtrain, <span class="string">&#x27;train&#x27;</span>), (dtest, <span class="string">&#x27;test&#x27;</span>)]</span><br><span class="line">xgb_ml = xgb.train(params = params, </span><br><span class="line">                   dtrain = dtrain, </span><br><span class="line">                   num_boost_round = <span class="number">400</span>, </span><br><span class="line">                   early_stopping_rounds = <span class="number">100</span>, </span><br><span class="line">                   evals = w_list)</span><br></pre></td></tr></table></figure>

<pre><code>[0]	train-error:0.260032	test-error:0.302239
Multiple eval metrics have been passed: &#39;test-error&#39; will be used for early stopping.

Will train until test-error hasn&#39;t improved in 100 rounds.
[1]	train-error:0.260032	test-error:0.302239
[2]	train-error:0.260032	test-error:0.302239
[3]	train-error:0.260032	test-error:0.302239
[4]	train-error:0.260032	test-error:0.302239
[5]	train-error:0.260032	test-error:0.302239
[6]	train-error:0.260032	test-error:0.302239
[7]	train-error:0.260032	test-error:0.302239
[8]	train-error:0.260032	test-error:0.302239
[9]	train-error:0.260032	test-error:0.302239
[10]	train-error:0.260032	test-error:0.302239
[11]	train-error:0.260032	test-error:0.302239
[12]	train-error:0.260032	test-error:0.302239
[13]	train-error:0.247191	test-error:0.298507
[14]	train-error:0.247191	test-error:0.298507
[15]	train-error:0.248796	test-error:0.302239
[16]	train-error:0.248796	test-error:0.302239
[17]	train-error:0.248796	test-error:0.302239
[18]	train-error:0.248796	test-error:0.302239
[19]	train-error:0.248796	test-error:0.302239
[20]	train-error:0.248796	test-error:0.302239
[21]	train-error:0.248796	test-error:0.302239
[22]	train-error:0.248796	test-error:0.302239
[23]	train-error:0.248796	test-error:0.302239
[24]	train-error:0.248796	test-error:0.302239
[25]	train-error:0.248796	test-error:0.302239
[26]	train-error:0.248796	test-error:0.302239
[27]	train-error:0.248796	test-error:0.302239
[28]	train-error:0.247191	test-error:0.302239
[29]	train-error:0.247191	test-error:0.302239
[30]	train-error:0.247191	test-error:0.302239
[31]	train-error:0.243981	test-error:0.298507
[32]	train-error:0.247191	test-error:0.302239
[33]	train-error:0.243981	test-error:0.298507
[34]	train-error:0.243981	test-error:0.298507
[35]	train-error:0.242376	test-error:0.294776
[36]	train-error:0.24077	test-error:0.294776
[37]	train-error:0.24077	test-error:0.294776
[38]	train-error:0.24077	test-error:0.294776
[39]	train-error:0.24077	test-error:0.294776
[40]	train-error:0.24077	test-error:0.294776
[41]	train-error:0.24077	test-error:0.294776
[42]	train-error:0.24077	test-error:0.294776
[43]	train-error:0.24077	test-error:0.294776
[44]	train-error:0.24077	test-error:0.302239
[45]	train-error:0.24077	test-error:0.302239
[46]	train-error:0.24077	test-error:0.302239
[47]	train-error:0.24077	test-error:0.302239
[48]	train-error:0.24077	test-error:0.302239
[49]	train-error:0.24077	test-error:0.302239
[50]	train-error:0.24077	test-error:0.302239
[51]	train-error:0.24077	test-error:0.302239
[52]	train-error:0.23435	test-error:0.302239
[53]	train-error:0.23435	test-error:0.302239
[54]	train-error:0.232745	test-error:0.298507
[55]	train-error:0.229535	test-error:0.298507
[56]	train-error:0.229535	test-error:0.298507
[57]	train-error:0.229535	test-error:0.298507
[58]	train-error:0.229535	test-error:0.298507
[59]	train-error:0.227929	test-error:0.294776
[60]	train-error:0.227929	test-error:0.298507
[61]	train-error:0.227929	test-error:0.298507
[62]	train-error:0.227929	test-error:0.298507
[63]	train-error:0.227929	test-error:0.298507
[64]	train-error:0.227929	test-error:0.298507
[65]	train-error:0.227929	test-error:0.298507
[66]	train-error:0.227929	test-error:0.298507
[67]	train-error:0.227929	test-error:0.298507
[68]	train-error:0.227929	test-error:0.298507
[69]	train-error:0.227929	test-error:0.298507
[70]	train-error:0.227929	test-error:0.298507
[71]	train-error:0.227929	test-error:0.298507
[72]	train-error:0.227929	test-error:0.302239
[73]	train-error:0.227929	test-error:0.302239
[74]	train-error:0.229535	test-error:0.30597
[75]	train-error:0.229535	test-error:0.30597
[76]	train-error:0.229535	test-error:0.30597
[77]	train-error:0.229535	test-error:0.30597
[78]	train-error:0.229535	test-error:0.30597
[79]	train-error:0.229535	test-error:0.30597
[80]	train-error:0.229535	test-error:0.30597
[81]	train-error:0.229535	test-error:0.30597
[82]	train-error:0.229535	test-error:0.30597
[83]	train-error:0.229535	test-error:0.30597
[84]	train-error:0.229535	test-error:0.30597
[85]	train-error:0.229535	test-error:0.30597
[86]	train-error:0.229535	test-error:0.30597
[87]	train-error:0.229535	test-error:0.30597
[88]	train-error:0.229535	test-error:0.30597
[89]	train-error:0.229535	test-error:0.30597
[90]	train-error:0.229535	test-error:0.30597
[91]	train-error:0.229535	test-error:0.30597
[92]	train-error:0.229535	test-error:0.30597
[93]	train-error:0.229535	test-error:0.30597
[94]	train-error:0.227929	test-error:0.313433
[95]	train-error:0.226324	test-error:0.313433
[96]	train-error:0.223114	test-error:0.317164
[97]	train-error:0.223114	test-error:0.317164
[98]	train-error:0.223114	test-error:0.317164
[99]	train-error:0.223114	test-error:0.317164
[100]	train-error:0.223114	test-error:0.317164
[101]	train-error:0.223114	test-error:0.317164
[102]	train-error:0.223114	test-error:0.317164
[103]	train-error:0.223114	test-error:0.317164
[104]	train-error:0.223114	test-error:0.317164
[105]	train-error:0.223114	test-error:0.317164
[106]	train-error:0.223114	test-error:0.317164
[107]	train-error:0.223114	test-error:0.317164
[108]	train-error:0.223114	test-error:0.317164
[109]	train-error:0.223114	test-error:0.317164
[110]	train-error:0.223114	test-error:0.317164
[111]	train-error:0.223114	test-error:0.317164
[112]	train-error:0.223114	test-error:0.317164
[113]	train-error:0.223114	test-error:0.317164
[114]	train-error:0.223114	test-error:0.317164
[115]	train-error:0.223114	test-error:0.317164
[116]	train-error:0.223114	test-error:0.317164
[117]	train-error:0.223114	test-error:0.317164
[118]	train-error:0.223114	test-error:0.317164
[119]	train-error:0.223114	test-error:0.317164
[120]	train-error:0.223114	test-error:0.317164
[121]	train-error:0.223114	test-error:0.317164
[122]	train-error:0.223114	test-error:0.317164
[123]	train-error:0.223114	test-error:0.317164
[124]	train-error:0.224719	test-error:0.317164
[125]	train-error:0.224719	test-error:0.317164
[126]	train-error:0.224719	test-error:0.317164
[127]	train-error:0.221509	test-error:0.317164
[128]	train-error:0.223114	test-error:0.317164
[129]	train-error:0.219904	test-error:0.313433
[130]	train-error:0.215088	test-error:0.313433
[131]	train-error:0.215088	test-error:0.313433
[132]	train-error:0.215088	test-error:0.313433
[133]	train-error:0.215088	test-error:0.313433
[134]	train-error:0.215088	test-error:0.313433
[135]	train-error:0.215088	test-error:0.313433
Stopping. Best iteration:
[35]	train-error:0.242376	test-error:0.294776
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 평가</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score</span><br><span class="line">pred_probs = xgb_ml.predict(dtest)</span><br><span class="line">y_pred = [<span class="number">1</span> <span class="keyword">if</span> x&gt; <span class="number">0.5</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> pred_probs]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 예측 라벨과 실제 라벨 사이의 정확도 측정</span></span><br><span class="line">accuracy_score(y_pred,y_test)</span><br></pre></td></tr></table></figure>




<pre><code>0.6977611940298507
</code></pre>
<h2 id="XGBoost-Scikit-Learn-API-방식"><a href="#XGBoost-Scikit-Learn-API-방식" class="headerlink" title="XGBoost Scikit-Learn API 방식"></a>XGBoost Scikit-Learn API 방식</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from sklearn.tree import DecisionTreeClassifier</span></span><br><span class="line"><span class="keyword">from</span> xgboost <span class="keyword">import</span> XGBClassifier <span class="comment"># API</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># dt = DecisionTreeClassifier()</span></span><br><span class="line">xgb_model = XGBClassifier(objestive = <span class="string">&#x27;binary:logistic&#x27;</span>,</span><br><span class="line">                          n_estimators=<span class="number">100</span>,</span><br><span class="line">                          max_depth=<span class="number">3</span>,</span><br><span class="line">                          learning_rate = <span class="number">0.1</span>,</span><br><span class="line">                          num_rounds = <span class="number">400</span>,</span><br><span class="line">                          random_state=<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line">w_list = [(X_train, y_train), (X_test, y_test)]</span><br><span class="line">xgb_model.fit(X_train, y_train, eval_set = w_list, eval_metric= <span class="string">&#x27;error&#x27;</span>, verbose=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">y_probas = xgb_model.predict_proba(X_test)</span><br><span class="line">y_pred = [<span class="number">1</span> <span class="keyword">if</span> x&gt; <span class="number">0.5</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> pred_probs]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 예측 라벨과 실제 라벨 사이의 정확도 측정</span></span><br><span class="line">accuracy_score(y_pred,y_test)</span><br></pre></td></tr></table></figure>

<pre><code>[0]	validation_0-error:0.260032	validation_1-error:0.302239
[1]	validation_0-error:0.260032	validation_1-error:0.302239
[2]	validation_0-error:0.260032	validation_1-error:0.302239
[3]	validation_0-error:0.260032	validation_1-error:0.302239
[4]	validation_0-error:0.260032	validation_1-error:0.302239
[5]	validation_0-error:0.260032	validation_1-error:0.302239
[6]	validation_0-error:0.260032	validation_1-error:0.302239
[7]	validation_0-error:0.260032	validation_1-error:0.302239
[8]	validation_0-error:0.260032	validation_1-error:0.302239
[9]	validation_0-error:0.260032	validation_1-error:0.302239
[10]	validation_0-error:0.260032	validation_1-error:0.302239
[11]	validation_0-error:0.260032	validation_1-error:0.302239
[12]	validation_0-error:0.260032	validation_1-error:0.302239
[13]	validation_0-error:0.247191	validation_1-error:0.298507
[14]	validation_0-error:0.247191	validation_1-error:0.298507
[15]	validation_0-error:0.248796	validation_1-error:0.302239
[16]	validation_0-error:0.248796	validation_1-error:0.302239
[17]	validation_0-error:0.248796	validation_1-error:0.302239
[18]	validation_0-error:0.248796	validation_1-error:0.302239
[19]	validation_0-error:0.248796	validation_1-error:0.302239
[20]	validation_0-error:0.248796	validation_1-error:0.302239
[21]	validation_0-error:0.248796	validation_1-error:0.302239
[22]	validation_0-error:0.248796	validation_1-error:0.302239
[23]	validation_0-error:0.248796	validation_1-error:0.302239
[24]	validation_0-error:0.248796	validation_1-error:0.302239
[25]	validation_0-error:0.248796	validation_1-error:0.302239
[26]	validation_0-error:0.248796	validation_1-error:0.302239
[27]	validation_0-error:0.248796	validation_1-error:0.302239
[28]	validation_0-error:0.247191	validation_1-error:0.302239
[29]	validation_0-error:0.247191	validation_1-error:0.302239
[30]	validation_0-error:0.247191	validation_1-error:0.302239
[31]	validation_0-error:0.243981	validation_1-error:0.298507
[32]	validation_0-error:0.247191	validation_1-error:0.302239
[33]	validation_0-error:0.243981	validation_1-error:0.298507
[34]	validation_0-error:0.243981	validation_1-error:0.298507
[35]	validation_0-error:0.242376	validation_1-error:0.294776
[36]	validation_0-error:0.24077	validation_1-error:0.294776
[37]	validation_0-error:0.24077	validation_1-error:0.294776
[38]	validation_0-error:0.24077	validation_1-error:0.294776
[39]	validation_0-error:0.24077	validation_1-error:0.294776
[40]	validation_0-error:0.24077	validation_1-error:0.294776
[41]	validation_0-error:0.24077	validation_1-error:0.294776
[42]	validation_0-error:0.24077	validation_1-error:0.294776
[43]	validation_0-error:0.24077	validation_1-error:0.294776
[44]	validation_0-error:0.24077	validation_1-error:0.302239
[45]	validation_0-error:0.24077	validation_1-error:0.302239
[46]	validation_0-error:0.24077	validation_1-error:0.302239
[47]	validation_0-error:0.24077	validation_1-error:0.302239
[48]	validation_0-error:0.24077	validation_1-error:0.302239
[49]	validation_0-error:0.24077	validation_1-error:0.302239
[50]	validation_0-error:0.24077	validation_1-error:0.302239
[51]	validation_0-error:0.24077	validation_1-error:0.302239
[52]	validation_0-error:0.23435	validation_1-error:0.302239
[53]	validation_0-error:0.23435	validation_1-error:0.302239
[54]	validation_0-error:0.232745	validation_1-error:0.298507
[55]	validation_0-error:0.229535	validation_1-error:0.298507
[56]	validation_0-error:0.229535	validation_1-error:0.298507
[57]	validation_0-error:0.229535	validation_1-error:0.298507
[58]	validation_0-error:0.229535	validation_1-error:0.298507
[59]	validation_0-error:0.227929	validation_1-error:0.294776
[60]	validation_0-error:0.227929	validation_1-error:0.298507
[61]	validation_0-error:0.227929	validation_1-error:0.298507
[62]	validation_0-error:0.227929	validation_1-error:0.298507
[63]	validation_0-error:0.227929	validation_1-error:0.298507
[64]	validation_0-error:0.227929	validation_1-error:0.298507
[65]	validation_0-error:0.227929	validation_1-error:0.298507
[66]	validation_0-error:0.227929	validation_1-error:0.298507
[67]	validation_0-error:0.227929	validation_1-error:0.298507
[68]	validation_0-error:0.227929	validation_1-error:0.298507
[69]	validation_0-error:0.227929	validation_1-error:0.298507
[70]	validation_0-error:0.227929	validation_1-error:0.298507
[71]	validation_0-error:0.227929	validation_1-error:0.298507
[72]	validation_0-error:0.227929	validation_1-error:0.302239
[73]	validation_0-error:0.227929	validation_1-error:0.302239
[74]	validation_0-error:0.229535	validation_1-error:0.30597
[75]	validation_0-error:0.229535	validation_1-error:0.30597
[76]	validation_0-error:0.229535	validation_1-error:0.30597
[77]	validation_0-error:0.229535	validation_1-error:0.30597
[78]	validation_0-error:0.229535	validation_1-error:0.30597
[79]	validation_0-error:0.229535	validation_1-error:0.30597
[80]	validation_0-error:0.229535	validation_1-error:0.30597
[81]	validation_0-error:0.229535	validation_1-error:0.30597
[82]	validation_0-error:0.229535	validation_1-error:0.30597
[83]	validation_0-error:0.229535	validation_1-error:0.30597
[84]	validation_0-error:0.229535	validation_1-error:0.30597
[85]	validation_0-error:0.229535	validation_1-error:0.30597
[86]	validation_0-error:0.229535	validation_1-error:0.30597
[87]	validation_0-error:0.229535	validation_1-error:0.30597
[88]	validation_0-error:0.229535	validation_1-error:0.30597
[89]	validation_0-error:0.229535	validation_1-error:0.30597
[90]	validation_0-error:0.229535	validation_1-error:0.30597
[91]	validation_0-error:0.229535	validation_1-error:0.30597
[92]	validation_0-error:0.229535	validation_1-error:0.30597
[93]	validation_0-error:0.229535	validation_1-error:0.30597
[94]	validation_0-error:0.227929	validation_1-error:0.313433
[95]	validation_0-error:0.226324	validation_1-error:0.313433
[96]	validation_0-error:0.223114	validation_1-error:0.317164
[97]	validation_0-error:0.223114	validation_1-error:0.317164
[98]	validation_0-error:0.223114	validation_1-error:0.317164
[99]	validation_0-error:0.223114	validation_1-error:0.317164





0.6977611940298507
</code></pre>
<h2 id="Light-GBM-Python-Wrapper-방식"><a href="#Light-GBM-Python-Wrapper-방식" class="headerlink" title="Light GBM Python Wrapper 방식"></a>Light GBM Python Wrapper 방식</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lightgbm <span class="keyword">as</span> lgb </span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split </span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns </span><br><span class="line"></span><br><span class="line"><span class="comment"># tips 데이터셋 </span></span><br><span class="line">titanic = sns.load_dataset(<span class="string">&#x27;titanic&#x27;</span>)</span><br><span class="line"></span><br><span class="line">X = titanic[[<span class="string">&#x27;pclass&#x27;</span>, <span class="string">&#x27;parch&#x27;</span>, <span class="string">&#x27;fare&#x27;</span>]]</span><br><span class="line">y = titanic[<span class="string">&#x27;survived&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 훈련데이터, 테스트 데이터 분리</span></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, stratify = y, test_size = <span class="number">0.3</span>, random_state=<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># XGBoost 코드와 유사하다. </span></span><br><span class="line">dtrain = lgb.Dataset(data = X_train, label = y_train)</span><br><span class="line">dtest = lgb.Dataset(data = X_test, label = y_test)</span><br><span class="line"></span><br><span class="line">params = &#123;<span class="string">&#x27;max_depth&#x27;</span>:<span class="number">3</span>,</span><br><span class="line">          <span class="string">&#x27;n_estimators&#x27;</span>:<span class="number">100</span>,</span><br><span class="line">          <span class="string">&#x27;learning_rate&#x27;</span>: <span class="number">0.1</span>,</span><br><span class="line">          <span class="string">&#x27;objective&#x27;</span>:<span class="string">&#x27;binary&#x27;</span>,</span><br><span class="line">          <span class="string">&#x27;metric&#x27;</span> : <span class="string">&#x27;binary_error&#x27;</span>, </span><br><span class="line">          <span class="string">&#x27;num_boost_round&#x27;</span> : <span class="number">400</span>, </span><br><span class="line">          <span class="string">&#x27;verbose&#x27;</span> : <span class="number">1</span>&#125; </span><br><span class="line"></span><br><span class="line">w_list = [dtrain, dtest]</span><br><span class="line">lgb_ml = lgb.train(params=params, train_set = dtrain,\</span><br><span class="line">                  early_stopping_rounds=<span class="number">100</span>, valid_sets= w_list)</span><br><span class="line"></span><br><span class="line">pred_probs = lgb_ml.predict(X_test)</span><br><span class="line">y_pred=[<span class="number">1</span> <span class="keyword">if</span> x &gt; <span class="number">0.5</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> pred_probs]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 예측 라벨과 실제 라벨 사이의 정확도 측정</span></span><br><span class="line">accuracy_score(y_pred, y_test)</span><br></pre></td></tr></table></figure>

<pre><code>/usr/local/lib/python3.7/dist-packages/lightgbm/engine.py:118: UserWarning: Found `num_boost_round` in params. Will use it instead of argument
  warnings.warn(&quot;Found `&#123;&#125;` in params. Will use it instead of argument&quot;.format(alias))


[1]	training&#39;s binary_error: 0.383628	valid_1&#39;s binary_error: 0.384328
Training until validation scores don&#39;t improve for 100 rounds.
[2]	training&#39;s binary_error: 0.383628	valid_1&#39;s binary_error: 0.384328
[3]	training&#39;s binary_error: 0.354735	valid_1&#39;s binary_error: 0.369403
[4]	training&#39;s binary_error: 0.29695	valid_1&#39;s binary_error: 0.354478
[5]	training&#39;s binary_error: 0.272873	valid_1&#39;s binary_error: 0.33209
[6]	training&#39;s binary_error: 0.272873	valid_1&#39;s binary_error: 0.33209
[7]	training&#39;s binary_error: 0.269663	valid_1&#39;s binary_error: 0.317164
[8]	training&#39;s binary_error: 0.269663	valid_1&#39;s binary_error: 0.317164
[9]	training&#39;s binary_error: 0.264848	valid_1&#39;s binary_error: 0.309701
[10]	training&#39;s binary_error: 0.269663	valid_1&#39;s binary_error: 0.309701
[11]	training&#39;s binary_error: 0.264848	valid_1&#39;s binary_error: 0.309701
[12]	training&#39;s binary_error: 0.264848	valid_1&#39;s binary_error: 0.309701
[13]	training&#39;s binary_error: 0.264848	valid_1&#39;s binary_error: 0.309701
[14]	training&#39;s binary_error: 0.264848	valid_1&#39;s binary_error: 0.309701
[15]	training&#39;s binary_error: 0.264848	valid_1&#39;s binary_error: 0.309701
[16]	training&#39;s binary_error: 0.266453	valid_1&#39;s binary_error: 0.313433
[17]	training&#39;s binary_error: 0.266453	valid_1&#39;s binary_error: 0.313433
[18]	training&#39;s binary_error: 0.266453	valid_1&#39;s binary_error: 0.313433
[19]	training&#39;s binary_error: 0.266453	valid_1&#39;s binary_error: 0.313433
[20]	training&#39;s binary_error: 0.266453	valid_1&#39;s binary_error: 0.313433
[21]	training&#39;s binary_error: 0.266453	valid_1&#39;s binary_error: 0.313433
[22]	training&#39;s binary_error: 0.266453	valid_1&#39;s binary_error: 0.313433
[23]	training&#39;s binary_error: 0.271268	valid_1&#39;s binary_error: 0.313433
[24]	training&#39;s binary_error: 0.258427	valid_1&#39;s binary_error: 0.309701
[25]	training&#39;s binary_error: 0.258427	valid_1&#39;s binary_error: 0.309701
[26]	training&#39;s binary_error: 0.258427	valid_1&#39;s binary_error: 0.309701
[27]	training&#39;s binary_error: 0.258427	valid_1&#39;s binary_error: 0.309701
[28]	training&#39;s binary_error: 0.258427	valid_1&#39;s binary_error: 0.309701
[29]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.309701
[30]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.309701
[31]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.309701
[32]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.309701
[33]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.317164
[34]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.317164
[35]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.317164
[36]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.309701
[37]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.317164
[38]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.317164
[39]	training&#39;s binary_error: 0.248796	valid_1&#39;s binary_error: 0.309701
[40]	training&#39;s binary_error: 0.248796	valid_1&#39;s binary_error: 0.313433
[41]	training&#39;s binary_error: 0.248796	valid_1&#39;s binary_error: 0.313433
[42]	training&#39;s binary_error: 0.248796	valid_1&#39;s binary_error: 0.313433
[43]	training&#39;s binary_error: 0.248796	valid_1&#39;s binary_error: 0.313433
[44]	training&#39;s binary_error: 0.248796	valid_1&#39;s binary_error: 0.313433
[45]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[46]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[47]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[48]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[49]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[50]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[51]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[52]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[53]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[54]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[55]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[56]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[57]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[58]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[59]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[60]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[61]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[62]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[63]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[64]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[65]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[66]	training&#39;s binary_error: 0.243981	valid_1&#39;s binary_error: 0.309701
[67]	training&#39;s binary_error: 0.23435	valid_1&#39;s binary_error: 0.309701
[68]	training&#39;s binary_error: 0.23435	valid_1&#39;s binary_error: 0.309701
[69]	training&#39;s binary_error: 0.23435	valid_1&#39;s binary_error: 0.309701
[70]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[71]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[72]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[73]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[74]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[75]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[76]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[77]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[78]	training&#39;s binary_error: 0.232745	valid_1&#39;s binary_error: 0.313433
[79]	training&#39;s binary_error: 0.232745	valid_1&#39;s binary_error: 0.313433
[80]	training&#39;s binary_error: 0.232745	valid_1&#39;s binary_error: 0.313433
[81]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[82]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[83]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[84]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[85]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[86]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[87]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[88]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[89]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[90]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[91]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[92]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[93]	training&#39;s binary_error: 0.227929	valid_1&#39;s binary_error: 0.309701
[94]	training&#39;s binary_error: 0.227929	valid_1&#39;s binary_error: 0.309701
[95]	training&#39;s binary_error: 0.227929	valid_1&#39;s binary_error: 0.309701
[96]	training&#39;s binary_error: 0.227929	valid_1&#39;s binary_error: 0.309701
[97]	training&#39;s binary_error: 0.227929	valid_1&#39;s binary_error: 0.309701
[98]	training&#39;s binary_error: 0.227929	valid_1&#39;s binary_error: 0.309701
[99]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.317164
[100]	training&#39;s binary_error: 0.227929	valid_1&#39;s binary_error: 0.309701
[101]	training&#39;s binary_error: 0.23114	valid_1&#39;s binary_error: 0.30597
[102]	training&#39;s binary_error: 0.23114	valid_1&#39;s binary_error: 0.30597
[103]	training&#39;s binary_error: 0.227929	valid_1&#39;s binary_error: 0.309701
[104]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.317164
[105]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.317164
[106]	training&#39;s binary_error: 0.224719	valid_1&#39;s binary_error: 0.313433
[107]	training&#39;s binary_error: 0.224719	valid_1&#39;s binary_error: 0.317164
[108]	training&#39;s binary_error: 0.224719	valid_1&#39;s binary_error: 0.317164
[109]	training&#39;s binary_error: 0.224719	valid_1&#39;s binary_error: 0.317164
[110]	training&#39;s binary_error: 0.224719	valid_1&#39;s binary_error: 0.317164
[111]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[112]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[113]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[114]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[115]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[116]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[117]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[118]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[119]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[120]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[121]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[122]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[123]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[124]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[125]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[126]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[127]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[128]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[129]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[130]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[131]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[132]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[133]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[134]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[135]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[136]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[137]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.309701
[138]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.309701
[139]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[140]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[141]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[142]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[143]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[144]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.320896
[145]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[146]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.313433
[147]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.313433
[148]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.313433
[149]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.313433
[150]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[151]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[152]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.313433
[153]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[154]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[155]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[156]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[157]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[158]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[159]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[160]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[161]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[162]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[163]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[164]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[165]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[166]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[167]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[168]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[169]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[170]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
[171]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
[172]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
[173]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
[174]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
[175]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[176]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[177]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.328358
[178]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.328358
[179]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.328358
[180]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.328358
[181]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.328358
[182]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[183]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[184]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[185]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[186]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[187]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[188]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[189]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[190]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[191]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[192]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[193]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[194]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[195]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[196]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[197]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
[198]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
[199]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
[200]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
[201]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
Early stopping, best iteration is:
[101]	training&#39;s binary_error: 0.23114	valid_1&#39;s binary_error: 0.30597





0.6940298507462687
</code></pre>
<h2 id="Light-GBM-Scikit-Learn-API-방식"><a href="#Light-GBM-Scikit-Learn-API-방식" class="headerlink" title="Light GBM Scikit-Learn API 방식"></a>Light GBM Scikit-Learn API 방식</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lightgbm <span class="keyword">import</span> LGBMClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score</span><br><span class="line"></span><br><span class="line"><span class="comment"># model </span></span><br><span class="line">w_list = [dtrain, dtest]</span><br><span class="line">model = LGBMClassifier(objective = <span class="string">&#x27;binary&#x27;</span>, </span><br><span class="line">                       metric = <span class="string">&#x27;binary_error&#x27;</span>,</span><br><span class="line">                       n_estimators=<span class="number">100</span>, </span><br><span class="line">                       learning_rate=<span class="number">0.1</span>, </span><br><span class="line">                       max_depth=<span class="number">3</span>, </span><br><span class="line">                       num_boost_round = <span class="number">400</span>,</span><br><span class="line">                       random_state = <span class="number">32</span>)</span><br><span class="line">model.fit(X_train, </span><br><span class="line">          y_train, </span><br><span class="line">          eval_set = [(X_train, y_train), (X_test, y_test)], </span><br><span class="line">          verbose=<span class="number">1</span>,</span><br><span class="line">          early_stopping_rounds = <span class="number">100</span>)</span><br><span class="line">y_probas = model.predict_proba(X_test) </span><br><span class="line">y_pred=[<span class="number">1</span> <span class="keyword">if</span> x &gt; <span class="number">0.5</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> y_probas[:, <span class="number">1</span>]] <span class="comment"># 예측 라벨(0과 1로 예측)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 예측 라벨과 실제 라벨 사이의 정확도 측정</span></span><br><span class="line">accuracy_score(y_pred, y_test)</span><br></pre></td></tr></table></figure>

<pre><code>/usr/local/lib/python3.7/dist-packages/lightgbm/engine.py:118: UserWarning: Found `num_boost_round` in params. Will use it instead of argument
  warnings.warn(&quot;Found `&#123;&#125;` in params. Will use it instead of argument&quot;.format(alias))


[1]	training&#39;s binary_error: 0.383628	valid_1&#39;s binary_error: 0.384328
Training until validation scores don&#39;t improve for 100 rounds.
[2]	training&#39;s binary_error: 0.383628	valid_1&#39;s binary_error: 0.384328
[3]	training&#39;s binary_error: 0.354735	valid_1&#39;s binary_error: 0.369403
[4]	training&#39;s binary_error: 0.29695	valid_1&#39;s binary_error: 0.354478
[5]	training&#39;s binary_error: 0.272873	valid_1&#39;s binary_error: 0.33209
[6]	training&#39;s binary_error: 0.272873	valid_1&#39;s binary_error: 0.33209
[7]	training&#39;s binary_error: 0.269663	valid_1&#39;s binary_error: 0.317164
[8]	training&#39;s binary_error: 0.269663	valid_1&#39;s binary_error: 0.317164
[9]	training&#39;s binary_error: 0.264848	valid_1&#39;s binary_error: 0.309701
[10]	training&#39;s binary_error: 0.269663	valid_1&#39;s binary_error: 0.309701
[11]	training&#39;s binary_error: 0.264848	valid_1&#39;s binary_error: 0.309701
[12]	training&#39;s binary_error: 0.264848	valid_1&#39;s binary_error: 0.309701
[13]	training&#39;s binary_error: 0.264848	valid_1&#39;s binary_error: 0.309701
[14]	training&#39;s binary_error: 0.264848	valid_1&#39;s binary_error: 0.309701
[15]	training&#39;s binary_error: 0.264848	valid_1&#39;s binary_error: 0.309701
[16]	training&#39;s binary_error: 0.266453	valid_1&#39;s binary_error: 0.313433
[17]	training&#39;s binary_error: 0.266453	valid_1&#39;s binary_error: 0.313433
[18]	training&#39;s binary_error: 0.266453	valid_1&#39;s binary_error: 0.313433
[19]	training&#39;s binary_error: 0.266453	valid_1&#39;s binary_error: 0.313433
[20]	training&#39;s binary_error: 0.266453	valid_1&#39;s binary_error: 0.313433
[21]	training&#39;s binary_error: 0.266453	valid_1&#39;s binary_error: 0.313433
[22]	training&#39;s binary_error: 0.266453	valid_1&#39;s binary_error: 0.313433
[23]	training&#39;s binary_error: 0.271268	valid_1&#39;s binary_error: 0.313433
[24]	training&#39;s binary_error: 0.258427	valid_1&#39;s binary_error: 0.309701
[25]	training&#39;s binary_error: 0.258427	valid_1&#39;s binary_error: 0.309701
[26]	training&#39;s binary_error: 0.258427	valid_1&#39;s binary_error: 0.309701
[27]	training&#39;s binary_error: 0.258427	valid_1&#39;s binary_error: 0.309701
[28]	training&#39;s binary_error: 0.258427	valid_1&#39;s binary_error: 0.309701
[29]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.309701
[30]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.309701
[31]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.309701
[32]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.309701
[33]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.317164
[34]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.317164
[35]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.317164
[36]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.309701
[37]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.317164
[38]	training&#39;s binary_error: 0.255217	valid_1&#39;s binary_error: 0.317164
[39]	training&#39;s binary_error: 0.248796	valid_1&#39;s binary_error: 0.309701
[40]	training&#39;s binary_error: 0.248796	valid_1&#39;s binary_error: 0.313433
[41]	training&#39;s binary_error: 0.248796	valid_1&#39;s binary_error: 0.313433
[42]	training&#39;s binary_error: 0.248796	valid_1&#39;s binary_error: 0.313433
[43]	training&#39;s binary_error: 0.248796	valid_1&#39;s binary_error: 0.313433
[44]	training&#39;s binary_error: 0.248796	valid_1&#39;s binary_error: 0.313433
[45]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[46]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[47]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[48]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[49]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[50]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[51]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[52]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[53]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[54]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[55]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[56]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[57]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[58]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[59]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[60]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[61]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[62]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[63]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[64]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[65]	training&#39;s binary_error: 0.247191	valid_1&#39;s binary_error: 0.313433
[66]	training&#39;s binary_error: 0.243981	valid_1&#39;s binary_error: 0.309701
[67]	training&#39;s binary_error: 0.23435	valid_1&#39;s binary_error: 0.309701
[68]	training&#39;s binary_error: 0.23435	valid_1&#39;s binary_error: 0.309701
[69]	training&#39;s binary_error: 0.23435	valid_1&#39;s binary_error: 0.309701
[70]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[71]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[72]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[73]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[74]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[75]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[76]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[77]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[78]	training&#39;s binary_error: 0.232745	valid_1&#39;s binary_error: 0.313433
[79]	training&#39;s binary_error: 0.232745	valid_1&#39;s binary_error: 0.313433
[80]	training&#39;s binary_error: 0.232745	valid_1&#39;s binary_error: 0.313433
[81]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[82]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[83]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[84]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[85]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[86]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[87]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[88]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[89]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[90]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[91]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[92]	training&#39;s binary_error: 0.229535	valid_1&#39;s binary_error: 0.309701
[93]	training&#39;s binary_error: 0.227929	valid_1&#39;s binary_error: 0.309701
[94]	training&#39;s binary_error: 0.227929	valid_1&#39;s binary_error: 0.309701
[95]	training&#39;s binary_error: 0.227929	valid_1&#39;s binary_error: 0.309701
[96]	training&#39;s binary_error: 0.227929	valid_1&#39;s binary_error: 0.309701
[97]	training&#39;s binary_error: 0.227929	valid_1&#39;s binary_error: 0.309701
[98]	training&#39;s binary_error: 0.227929	valid_1&#39;s binary_error: 0.309701
[99]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.317164
[100]	training&#39;s binary_error: 0.227929	valid_1&#39;s binary_error: 0.309701
[101]	training&#39;s binary_error: 0.23114	valid_1&#39;s binary_error: 0.30597
[102]	training&#39;s binary_error: 0.23114	valid_1&#39;s binary_error: 0.30597
[103]	training&#39;s binary_error: 0.227929	valid_1&#39;s binary_error: 0.309701
[104]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.317164
[105]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.317164
[106]	training&#39;s binary_error: 0.224719	valid_1&#39;s binary_error: 0.313433
[107]	training&#39;s binary_error: 0.224719	valid_1&#39;s binary_error: 0.317164
[108]	training&#39;s binary_error: 0.224719	valid_1&#39;s binary_error: 0.317164
[109]	training&#39;s binary_error: 0.224719	valid_1&#39;s binary_error: 0.317164
[110]	training&#39;s binary_error: 0.224719	valid_1&#39;s binary_error: 0.317164
[111]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[112]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[113]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[114]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[115]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[116]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[117]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[118]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[119]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[120]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[121]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[122]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[123]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[124]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[125]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[126]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[127]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[128]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[129]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[130]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[131]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[132]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[133]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[134]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[135]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[136]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[137]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.309701
[138]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.309701
[139]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[140]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[141]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[142]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[143]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.309701
[144]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.320896
[145]	training&#39;s binary_error: 0.223114	valid_1&#39;s binary_error: 0.313433
[146]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.313433
[147]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.313433
[148]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.313433
[149]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.313433
[150]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[151]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[152]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.313433
[153]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[154]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[155]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[156]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[157]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[158]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[159]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[160]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[161]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[162]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[163]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[164]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[165]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[166]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[167]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[168]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[169]	training&#39;s binary_error: 0.219904	valid_1&#39;s binary_error: 0.324627
[170]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
[171]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
[172]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
[173]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
[174]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
[175]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[176]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[177]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.328358
[178]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.328358
[179]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.328358
[180]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.328358
[181]	training&#39;s binary_error: 0.221509	valid_1&#39;s binary_error: 0.328358
[182]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[183]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[184]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[185]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[186]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[187]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[188]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[189]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[190]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[191]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[192]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[193]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[194]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[195]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[196]	training&#39;s binary_error: 0.216693	valid_1&#39;s binary_error: 0.320896
[197]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
[198]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
[199]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
[200]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
[201]	training&#39;s binary_error: 0.215088	valid_1&#39;s binary_error: 0.317164
Early stopping, best iteration is:
[101]	training&#39;s binary_error: 0.23114	valid_1&#39;s binary_error: 0.30597





0.6940298507462687
</code></pre>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-PyCaret_Sample"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2022/07/05/PyCaret_Sample/">PyCaret_Sample</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2022/07/05/PyCaret_Sample/" class="article-date">
	  <time datetime="2022-07-04T17:00:00.000Z" itemprop="datePublished">July 5, 2022</time>
	</a>

       
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="PyCaret"><a href="#PyCaret" class="headerlink" title="PyCaret"></a>PyCaret</h2><ul>
<li><p>개발환경 설치</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://pycaret.gitbook.io/docs/">https://pycaret.gitbook.io/docs/</a></p>
</li>
<li><p>로컬에서 하기 힘듬</p>
</li>
<li><p>git hub &gt; requirements.txt &gt; 기본환경 버전 확인 및 설치</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://lightgbm.readthedocs.io/en/latest/Installation-Guide.html">https://lightgbm.readthedocs.io/en/latest/Installation-Guide.html</a></p>
</li>
<li><p>PyCaret 설치</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">!pip uninstall sklearn -y</span><br><span class="line">!pip install --upgrade sklearn</span><br><span class="line">!pip install scikit-learn==<span class="number">0.23</span><span class="number">.2</span> --user</span><br><span class="line">!pip install pycaret</span><br><span class="line">!pip install markupsafe==<span class="number">2.0</span><span class="number">.1</span></span><br></pre></td></tr></table></figure>

<pre><code>Found existing installation: sklearn 0.0
Uninstalling sklearn-0.0:
  Successfully uninstalled sklearn-0.0
Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting sklearn
  Downloading sklearn-0.0.tar.gz (1.1 kB)
Requirement already satisfied: scikit-learn in /usr/local/lib/python3.7/dist-packages (from sklearn) (1.0.2)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn-&gt;sklearn) (3.1.0)
Requirement already satisfied: numpy&gt;=1.14.6 in /usr/local/lib/python3.7/dist-packages (from scikit-learn-&gt;sklearn) (1.21.6)
Requirement already satisfied: scipy&gt;=1.1.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn-&gt;sklearn) (1.4.1)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.7/dist-packages (from scikit-learn-&gt;sklearn) (1.1.0)
Building wheels for collected packages: sklearn
  Building wheel for sklearn (setup.py) ... [?25l[?25hdone
  Created wheel for sklearn: filename=sklearn-0.0-py2.py3-none-any.whl size=1310 sha256=9e2009e09e4eff4f12aba4171158500c2dba9a70171e14e5dc159fc591c858b8
  Stored in directory: /root/.cache/pip/wheels/46/ef/c3/157e41f5ee1372d1be90b09f74f82b10e391eaacca8f22d33e
Successfully built sklearn
Installing collected packages: sklearn
Successfully installed sklearn-0.0
Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting scikit-learn==0.23.2
  Downloading scikit_learn-0.23.2-cp37-cp37m-manylinux1_x86_64.whl (6.8 MB)
[K     |████████████████████████████████| 6.8 MB 5.1 MB/s 
[?25hRequirement already satisfied: numpy&gt;=1.13.3 in /usr/local/lib/python3.7/dist-packages (from scikit-learn==0.23.2) (1.21.6)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.7/dist-packages (from scikit-learn==0.23.2) (1.1.0)
Requirement already satisfied: scipy&gt;=0.19.1 in /usr/local/lib/python3.7/dist-packages (from scikit-learn==0.23.2) (1.4.1)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn==0.23.2) (3.1.0)
Installing collected packages: scikit-learn
[31mERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
yellowbrick 1.4 requires scikit-learn&gt;=1.0.0, but you have scikit-learn 0.23.2 which is incompatible.
imbalanced-learn 0.8.1 requires scikit-learn&gt;=0.24, but you have scikit-learn 0.23.2 which is incompatible.[0m
Successfully installed scikit-learn-0.23.2
Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting pycaret
  Downloading pycaret-2.3.10-py3-none-any.whl (320 kB)
[K     |████████████████████████████████| 320 kB 5.1 MB/s 
[?25hRequirement already satisfied: scikit-learn==0.23.2 in /root/.local/lib/python3.7/site-packages (from pycaret) (0.23.2)
Requirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (from pycaret) (3.2.2)
Requirement already satisfied: textblob in /usr/local/lib/python3.7/dist-packages (from pycaret) (0.15.3)
Requirement already satisfied: gensim&lt;4.0.0 in /usr/local/lib/python3.7/dist-packages (from pycaret) (3.6.0)
Collecting pyod
  Downloading pyod-1.0.2.tar.gz (122 kB)
[K     |████████████████████████████████| 122 kB 63.0 MB/s 
[?25hRequirement already satisfied: pyyaml&lt;6.0.0 in /usr/local/lib/python3.7/dist-packages (from pycaret) (3.13)
Collecting kmodes&gt;=0.10.1
  Downloading kmodes-0.12.1-py2.py3-none-any.whl (20 kB)
Requirement already satisfied: plotly&gt;=4.4.1 in /usr/local/lib/python3.7/dist-packages (from pycaret) (5.5.0)
Collecting mlxtend&gt;=0.17.0
  Downloading mlxtend-0.20.0-py2.py3-none-any.whl (1.3 MB)
[K     |████████████████████████████████| 1.3 MB 41.6 MB/s 
[?25hCollecting scikit-plot
  Downloading scikit_plot-0.3.7-py3-none-any.whl (33 kB)
Requirement already satisfied: wordcloud in /usr/local/lib/python3.7/dist-packages (from pycaret) (1.5.0)
Collecting pyLDAvis
  Downloading pyLDAvis-3.3.1.tar.gz (1.7 MB)
[K     |████████████████████████████████| 1.7 MB 40.9 MB/s 
[?25h  Installing build dependencies ... [?25l[?25hdone
  Getting requirements to build wheel ... [?25l[?25hdone
  Installing backend dependencies ... [?25l[?25hdone
    Preparing wheel metadata ... [?25l[?25hdone
Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from pycaret) (1.1.0)
Collecting Boruta
  Downloading Boruta-0.3-py3-none-any.whl (56 kB)
[K     |████████████████████████████████| 56 kB 4.0 MB/s 
[?25hRequirement already satisfied: scipy&lt;=1.5.4 in /usr/local/lib/python3.7/dist-packages (from pycaret) (1.4.1)
Requirement already satisfied: IPython in /usr/local/lib/python3.7/dist-packages (from pycaret) (5.5.0)
Collecting pandas-profiling&gt;=2.8.0
  Downloading pandas_profiling-3.2.0-py2.py3-none-any.whl (262 kB)
[K     |████████████████████████████████| 262 kB 51.5 MB/s 
[?25hCollecting lightgbm&gt;=2.3.1
  Downloading lightgbm-3.3.2-py3-none-manylinux1_x86_64.whl (2.0 MB)
[K     |████████████████████████████████| 2.0 MB 38.0 MB/s 
[?25hRequirement already satisfied: seaborn in /usr/local/lib/python3.7/dist-packages (from pycaret) (0.11.2)
Requirement already satisfied: ipywidgets in /usr/local/lib/python3.7/dist-packages (from pycaret) (7.7.0)
Collecting umap-learn
  Downloading umap-learn-0.5.3.tar.gz (88 kB)
[K     |████████████████████████████████| 88 kB 6.8 MB/s 
[?25hRequirement already satisfied: nltk in /usr/local/lib/python3.7/dist-packages (from pycaret) (3.7)
Requirement already satisfied: yellowbrick&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from pycaret) (1.4)
Collecting mlflow
  Downloading mlflow-1.27.0-py3-none-any.whl (17.9 MB)
[K     |████████████████████████████████| 17.9 MB 41.3 MB/s 
[?25hCollecting spacy&lt;2.4.0
  Downloading spacy-2.3.7-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (10.4 MB)
[K     |████████████████████████████████| 10.4 MB 24.8 MB/s 
[?25hCollecting imbalanced-learn==0.7.0
  Downloading imbalanced_learn-0.7.0-py3-none-any.whl (167 kB)
[K     |████████████████████████████████| 167 kB 53.7 MB/s 
[?25hRequirement already satisfied: cufflinks&gt;=0.17.0 in /usr/local/lib/python3.7/dist-packages (from pycaret) (0.17.3)
Requirement already satisfied: numba&lt;0.55 in /usr/local/lib/python3.7/dist-packages (from pycaret) (0.51.2)
Requirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from pycaret) (1.3.5)
Requirement already satisfied: numpy&gt;=1.13.3 in /usr/local/lib/python3.7/dist-packages (from imbalanced-learn==0.7.0-&gt;pycaret) (1.21.6)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn==0.23.2-&gt;pycaret) (3.1.0)
Requirement already satisfied: colorlover&gt;=0.2.1 in /usr/local/lib/python3.7/dist-packages (from cufflinks&gt;=0.17.0-&gt;pycaret) (0.3.0)
Requirement already satisfied: six&gt;=1.9.0 in /usr/local/lib/python3.7/dist-packages (from cufflinks&gt;=0.17.0-&gt;pycaret) (1.15.0)
Requirement already satisfied: setuptools&gt;=34.4.1 in /usr/local/lib/python3.7/dist-packages (from cufflinks&gt;=0.17.0-&gt;pycaret) (57.4.0)
Requirement already satisfied: smart-open&gt;=1.2.1 in /usr/local/lib/python3.7/dist-packages (from gensim&lt;4.0.0-&gt;pycaret) (5.2.1)
Requirement already satisfied: prompt-toolkit&lt;2.0.0,&gt;=1.0.4 in /usr/local/lib/python3.7/dist-packages (from IPython-&gt;pycaret) (1.0.18)
Requirement already satisfied: traitlets&gt;=4.2 in /usr/local/lib/python3.7/dist-packages (from IPython-&gt;pycaret) (5.1.1)
Requirement already satisfied: pexpect in /usr/local/lib/python3.7/dist-packages (from IPython-&gt;pycaret) (4.8.0)
Requirement already satisfied: decorator in /usr/local/lib/python3.7/dist-packages (from IPython-&gt;pycaret) (4.4.2)
Requirement already satisfied: pickleshare in /usr/local/lib/python3.7/dist-packages (from IPython-&gt;pycaret) (0.7.5)
Requirement already satisfied: pygments in /usr/local/lib/python3.7/dist-packages (from IPython-&gt;pycaret) (2.6.1)
Requirement already satisfied: simplegeneric&gt;0.8 in /usr/local/lib/python3.7/dist-packages (from IPython-&gt;pycaret) (0.8.1)
Requirement already satisfied: ipykernel&gt;=4.5.1 in /usr/local/lib/python3.7/dist-packages (from ipywidgets-&gt;pycaret) (4.10.1)
Requirement already satisfied: nbformat&gt;=4.2.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets-&gt;pycaret) (5.4.0)
Requirement already satisfied: ipython-genutils~=0.2.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets-&gt;pycaret) (0.2.0)
Requirement already satisfied: jupyterlab-widgets&gt;=1.0.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets-&gt;pycaret) (1.1.0)
Requirement already satisfied: widgetsnbextension~=3.6.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets-&gt;pycaret) (3.6.0)
Requirement already satisfied: jupyter-client in /usr/local/lib/python3.7/dist-packages (from ipykernel&gt;=4.5.1-&gt;ipywidgets-&gt;pycaret) (5.3.5)
Requirement already satisfied: tornado&gt;=4.0 in /usr/local/lib/python3.7/dist-packages (from ipykernel&gt;=4.5.1-&gt;ipywidgets-&gt;pycaret) (5.1.1)
Requirement already satisfied: wheel in /usr/local/lib/python3.7/dist-packages (from lightgbm&gt;=2.3.1-&gt;pycaret) (0.37.1)
Collecting mlxtend&gt;=0.17.0
  Downloading mlxtend-0.19.0-py2.py3-none-any.whl (1.3 MB)
[K     |████████████████████████████████| 1.3 MB 54.0 MB/s 
[?25hRequirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;pycaret) (1.4.3)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;pycaret) (3.0.9)
Requirement already satisfied: python-dateutil&gt;=2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;pycaret) (2.8.2)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;pycaret) (0.11.0)
Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from kiwisolver&gt;=1.0.1-&gt;matplotlib-&gt;pycaret) (4.1.1)
Requirement already satisfied: jsonschema&gt;=2.6 in /usr/local/lib/python3.7/dist-packages (from nbformat&gt;=4.2.0-&gt;ipywidgets-&gt;pycaret) (4.3.3)
Requirement already satisfied: fastjsonschema in /usr/local/lib/python3.7/dist-packages (from nbformat&gt;=4.2.0-&gt;ipywidgets-&gt;pycaret) (2.15.3)
Requirement already satisfied: jupyter-core in /usr/local/lib/python3.7/dist-packages (from nbformat&gt;=4.2.0-&gt;ipywidgets-&gt;pycaret) (4.10.0)
Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat&gt;=4.2.0-&gt;ipywidgets-&gt;pycaret) (4.11.4)
Requirement already satisfied: attrs&gt;=17.4.0 in /usr/local/lib/python3.7/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat&gt;=4.2.0-&gt;ipywidgets-&gt;pycaret) (21.4.0)
Requirement already satisfied: pyrsistent!=0.17.0,!=0.17.1,!=0.17.2,&gt;=0.14.0 in /usr/local/lib/python3.7/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat&gt;=4.2.0-&gt;ipywidgets-&gt;pycaret) (0.18.1)
Requirement already satisfied: importlib-resources&gt;=1.4.0 in /usr/local/lib/python3.7/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat&gt;=4.2.0-&gt;ipywidgets-&gt;pycaret) (5.7.1)
Requirement already satisfied: zipp&gt;=3.1.0 in /usr/local/lib/python3.7/dist-packages (from importlib-resources&gt;=1.4.0-&gt;jsonschema&gt;=2.6-&gt;nbformat&gt;=4.2.0-&gt;ipywidgets-&gt;pycaret) (3.8.0)
Requirement already satisfied: llvmlite&lt;0.35,&gt;=0.34.0.dev0 in /usr/local/lib/python3.7/dist-packages (from numba&lt;0.55-&gt;pycaret) (0.34.0)
Requirement already satisfied: pytz&gt;=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas-&gt;pycaret) (2022.1)
Requirement already satisfied: tqdm&gt;=4.48.2 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling&gt;=2.8.0-&gt;pycaret) (4.64.0)
Collecting tangled-up-in-unicode==0.2.0
  Downloading tangled_up_in_unicode-0.2.0-py3-none-any.whl (4.7 MB)
[K     |████████████████████████████████| 4.7 MB 43.0 MB/s 
[?25hCollecting pyyaml&lt;6.0.0
  Downloading PyYAML-5.4.1-cp37-cp37m-manylinux1_x86_64.whl (636 kB)
[K     |████████████████████████████████| 636 kB 57.9 MB/s 
[?25hCollecting htmlmin&gt;=0.1.12
  Downloading htmlmin-0.1.12.tar.gz (19 kB)
Requirement already satisfied: jinja2&gt;=2.11.1 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling&gt;=2.8.0-&gt;pycaret) (2.11.3)
Collecting multimethod&gt;=1.4
  Downloading multimethod-1.8-py3-none-any.whl (9.8 kB)
Requirement already satisfied: pydantic&gt;=1.8.1 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling&gt;=2.8.0-&gt;pycaret) (1.8.2)
Requirement already satisfied: missingno&gt;=0.4.2 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling&gt;=2.8.0-&gt;pycaret) (0.5.1)
Collecting requests&gt;=2.24.0
  Downloading requests-2.28.1-py3-none-any.whl (62 kB)
[K     |████████████████████████████████| 62 kB 1.5 MB/s 
[?25hCollecting visions[type_image_path]==0.7.4
  Downloading visions-0.7.4-py3-none-any.whl (102 kB)
[K     |████████████████████████████████| 102 kB 11.5 MB/s 
[?25hCollecting phik&gt;=0.11.1
  Downloading phik-0.12.2-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (690 kB)
[K     |████████████████████████████████| 690 kB 58.8 MB/s 
[?25hCollecting markupsafe~=2.1.1
  Downloading MarkupSafe-2.1.1-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (25 kB)
Requirement already satisfied: networkx&gt;=2.4 in /usr/local/lib/python3.7/dist-packages (from visions[type_image_path]==0.7.4-&gt;pandas-profiling&gt;=2.8.0-&gt;pycaret) (2.6.3)
Collecting imagehash
  Downloading ImageHash-4.2.1.tar.gz (812 kB)
[K     |████████████████████████████████| 812 kB 56.6 MB/s 
[?25hRequirement already satisfied: Pillow in /usr/local/lib/python3.7/dist-packages (from visions[type_image_path]==0.7.4-&gt;pandas-profiling&gt;=2.8.0-&gt;pycaret) (7.1.2)
Collecting scipy&lt;=1.5.4
  Downloading scipy-1.5.4-cp37-cp37m-manylinux1_x86_64.whl (25.9 MB)
[K     |████████████████████████████████| 25.9 MB 1.2 MB/s 
[?25hRequirement already satisfied: tenacity&gt;=6.2.0 in /usr/local/lib/python3.7/dist-packages (from plotly&gt;=4.4.1-&gt;pycaret) (8.0.1)
Requirement already satisfied: wcwidth in /usr/local/lib/python3.7/dist-packages (from prompt-toolkit&lt;2.0.0,&gt;=1.0.4-&gt;IPython-&gt;pycaret) (0.2.5)
Requirement already satisfied: charset-normalizer&lt;3,&gt;=2 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.24.0-&gt;pandas-profiling&gt;=2.8.0-&gt;pycaret) (2.0.12)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.24.0-&gt;pandas-profiling&gt;=2.8.0-&gt;pycaret) (2.10)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.24.0-&gt;pandas-profiling&gt;=2.8.0-&gt;pycaret) (2022.6.15)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.24.0-&gt;pandas-profiling&gt;=2.8.0-&gt;pycaret) (1.24.3)
Requirement already satisfied: cymem&lt;2.1.0,&gt;=2.0.2 in /usr/local/lib/python3.7/dist-packages (from spacy&lt;2.4.0-&gt;pycaret) (2.0.6)
Requirement already satisfied: blis&lt;0.8.0,&gt;=0.4.0 in /usr/local/lib/python3.7/dist-packages (from spacy&lt;2.4.0-&gt;pycaret) (0.7.7)
Requirement already satisfied: murmurhash&lt;1.1.0,&gt;=0.28.0 in /usr/local/lib/python3.7/dist-packages (from spacy&lt;2.4.0-&gt;pycaret) (1.0.7)
Collecting thinc&lt;7.5.0,&gt;=7.4.1
  Downloading thinc-7.4.5-cp37-cp37m-manylinux2014_x86_64.whl (1.0 MB)
[K     |████████████████████████████████| 1.0 MB 54.7 MB/s 
[?25hCollecting catalogue&lt;1.1.0,&gt;=0.0.7
  Downloading catalogue-1.0.0-py2.py3-none-any.whl (7.7 kB)
Collecting plac&lt;1.2.0,&gt;=0.9.6
  Downloading plac-1.1.3-py2.py3-none-any.whl (20 kB)
Collecting srsly&lt;1.1.0,&gt;=1.0.2
  Downloading srsly-1.0.5-cp37-cp37m-manylinux2014_x86_64.whl (184 kB)
[K     |████████████████████████████████| 184 kB 51.4 MB/s 
[?25hRequirement already satisfied: wasabi&lt;1.1.0,&gt;=0.4.0 in /usr/local/lib/python3.7/dist-packages (from spacy&lt;2.4.0-&gt;pycaret) (0.9.1)
Requirement already satisfied: preshed&lt;3.1.0,&gt;=3.0.2 in /usr/local/lib/python3.7/dist-packages (from spacy&lt;2.4.0-&gt;pycaret) (3.0.6)
Requirement already satisfied: notebook&gt;=4.4.1 in /usr/local/lib/python3.7/dist-packages (from widgetsnbextension~=3.6.0-&gt;ipywidgets-&gt;pycaret) (5.3.1)
Requirement already satisfied: terminado&gt;=0.8.1 in /usr/local/lib/python3.7/dist-packages (from notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets-&gt;pycaret) (0.13.3)
Requirement already satisfied: Send2Trash in /usr/local/lib/python3.7/dist-packages (from notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets-&gt;pycaret) (1.8.0)
Requirement already satisfied: nbconvert in /usr/local/lib/python3.7/dist-packages (from notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets-&gt;pycaret) (5.6.1)
Requirement already satisfied: pyzmq&gt;=13 in /usr/local/lib/python3.7/dist-packages (from jupyter-client-&gt;ipykernel&gt;=4.5.1-&gt;ipywidgets-&gt;pycaret) (23.1.0)
Requirement already satisfied: ptyprocess in /usr/local/lib/python3.7/dist-packages (from terminado&gt;=0.8.1-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets-&gt;pycaret) (0.7.0)
Collecting yellowbrick&gt;=1.0.1
  Downloading yellowbrick-1.3.post1-py3-none-any.whl (271 kB)
[K     |████████████████████████████████| 271 kB 56.0 MB/s 
[?25hCollecting numpy&gt;=1.13.3
  Downloading numpy-1.19.5-cp37-cp37m-manylinux2010_x86_64.whl (14.8 MB)
[K     |████████████████████████████████| 14.8 MB 42.1 MB/s 
[?25hRequirement already satisfied: PyWavelets in /usr/local/lib/python3.7/dist-packages (from imagehash-&gt;visions[type_image_path]==0.7.4-&gt;pandas-profiling&gt;=2.8.0-&gt;pycaret) (1.3.0)
Requirement already satisfied: sqlparse&gt;=0.3.1 in /usr/local/lib/python3.7/dist-packages (from mlflow-&gt;pycaret) (0.4.2)
Requirement already satisfied: cloudpickle in /usr/local/lib/python3.7/dist-packages (from mlflow-&gt;pycaret) (1.3.0)
Requirement already satisfied: sqlalchemy&gt;=1.4.0 in /usr/local/lib/python3.7/dist-packages (from mlflow-&gt;pycaret) (1.4.37)
Collecting querystring-parser
  Downloading querystring_parser-1.2.4-py2.py3-none-any.whl (7.9 kB)
Collecting gunicorn
  Downloading gunicorn-20.1.0-py3-none-any.whl (79 kB)
[K     |████████████████████████████████| 79 kB 8.8 MB/s 
[?25hCollecting databricks-cli&gt;=0.8.7
  Downloading databricks-cli-0.17.0.tar.gz (81 kB)
[K     |████████████████████████████████| 81 kB 8.8 MB/s 
[?25hRequirement already satisfied: click&gt;=7.0 in /usr/local/lib/python3.7/dist-packages (from mlflow-&gt;pycaret) (7.1.2)
Collecting gitpython&gt;=2.1.0
  Downloading GitPython-3.1.27-py3-none-any.whl (181 kB)
[K     |████████████████████████████████| 181 kB 45.0 MB/s 
[?25hCollecting prometheus-flask-exporter
  Downloading prometheus_flask_exporter-0.20.2-py3-none-any.whl (18 kB)
Requirement already satisfied: Flask in /usr/local/lib/python3.7/dist-packages (from mlflow-&gt;pycaret) (1.1.4)
Requirement already satisfied: protobuf&gt;=3.12.0 in /usr/local/lib/python3.7/dist-packages (from mlflow-&gt;pycaret) (3.17.3)
Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from mlflow-&gt;pycaret) (21.3)
Requirement already satisfied: entrypoints in /usr/local/lib/python3.7/dist-packages (from mlflow-&gt;pycaret) (0.4)
Collecting alembic
  Downloading alembic-1.8.0-py3-none-any.whl (209 kB)
[K     |████████████████████████████████| 209 kB 58.4 MB/s 
[?25hCollecting docker&gt;=4.0.0
  Downloading docker-5.0.3-py2.py3-none-any.whl (146 kB)
[K     |████████████████████████████████| 146 kB 45.5 MB/s 
[?25hCollecting pyjwt&gt;=1.7.0
  Downloading PyJWT-2.4.0-py3-none-any.whl (18 kB)
Requirement already satisfied: oauthlib&gt;=3.1.0 in /usr/local/lib/python3.7/dist-packages (from databricks-cli&gt;=0.8.7-&gt;mlflow-&gt;pycaret) (3.2.0)
Requirement already satisfied: tabulate&gt;=0.7.7 in /usr/local/lib/python3.7/dist-packages (from databricks-cli&gt;=0.8.7-&gt;mlflow-&gt;pycaret) (0.8.9)
Collecting websocket-client&gt;=0.32.0
  Downloading websocket_client-1.3.3-py3-none-any.whl (54 kB)
[K     |████████████████████████████████| 54 kB 2.4 MB/s 
[?25hCollecting gitdb&lt;5,&gt;=4.0.1
  Downloading gitdb-4.0.9-py3-none-any.whl (63 kB)
[K     |████████████████████████████████| 63 kB 1.4 MB/s 
[?25hCollecting smmap&lt;6,&gt;=3.0.1
  Downloading smmap-5.0.0-py3-none-any.whl (24 kB)
Requirement already satisfied: greenlet!=0.4.17 in /usr/local/lib/python3.7/dist-packages (from sqlalchemy&gt;=1.4.0-&gt;mlflow-&gt;pycaret) (1.1.2)
Collecting Mako
  Downloading Mako-1.2.1-py3-none-any.whl (78 kB)
[K     |████████████████████████████████| 78 kB 7.0 MB/s 
[?25hRequirement already satisfied: itsdangerous&lt;2.0,&gt;=0.24 in /usr/local/lib/python3.7/dist-packages (from Flask-&gt;mlflow-&gt;pycaret) (1.1.0)
Requirement already satisfied: Werkzeug&lt;2.0,&gt;=0.15 in /usr/local/lib/python3.7/dist-packages (from Flask-&gt;mlflow-&gt;pycaret) (1.0.1)
Requirement already satisfied: mistune&lt;2,&gt;=0.8.1 in /usr/local/lib/python3.7/dist-packages (from nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets-&gt;pycaret) (0.8.4)
Requirement already satisfied: bleach in /usr/local/lib/python3.7/dist-packages (from nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets-&gt;pycaret) (5.0.0)
Requirement already satisfied: testpath in /usr/local/lib/python3.7/dist-packages (from nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets-&gt;pycaret) (0.6.0)
Requirement already satisfied: pandocfilters&gt;=1.4.1 in /usr/local/lib/python3.7/dist-packages (from nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets-&gt;pycaret) (1.5.0)
Requirement already satisfied: defusedxml in /usr/local/lib/python3.7/dist-packages (from nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets-&gt;pycaret) (0.7.1)
Requirement already satisfied: webencodings in /usr/local/lib/python3.7/dist-packages (from bleach-&gt;nbconvert-&gt;notebook&gt;=4.4.1-&gt;widgetsnbextension~=3.6.0-&gt;ipywidgets-&gt;pycaret) (0.5.1)
Requirement already satisfied: regex&gt;=2021.8.3 in /usr/local/lib/python3.7/dist-packages (from nltk-&gt;pycaret) (2022.6.2)
Requirement already satisfied: prometheus-client in /usr/local/lib/python3.7/dist-packages (from prometheus-flask-exporter-&gt;mlflow-&gt;pycaret) (0.14.1)
Requirement already satisfied: future in /usr/local/lib/python3.7/dist-packages (from pyLDAvis-&gt;pycaret) (0.16.0)
Collecting funcy
  Downloading funcy-1.17-py2.py3-none-any.whl (33 kB)
Collecting pyLDAvis
  Downloading pyLDAvis-3.3.0.tar.gz (1.7 MB)
[K     |████████████████████████████████| 1.7 MB 33.8 MB/s 
[?25h  Installing build dependencies ... [?25l[?25hdone
  Getting requirements to build wheel ... [?25l[?25hdone
  Installing backend dependencies ... [?25l[?25hdone
    Preparing wheel metadata ... [?25l[?25hdone
  Downloading pyLDAvis-3.2.2.tar.gz (1.7 MB)
[K     |████████████████████████████████| 1.7 MB 51.9 MB/s 
[?25hRequirement already satisfied: numexpr in /usr/local/lib/python3.7/dist-packages (from pyLDAvis-&gt;pycaret) (2.8.1)
Requirement already satisfied: statsmodels in /usr/local/lib/python3.7/dist-packages (from pyod-&gt;pycaret) (0.10.2)
Requirement already satisfied: patsy&gt;=0.4.0 in /usr/local/lib/python3.7/dist-packages (from statsmodels-&gt;pyod-&gt;pycaret) (0.5.2)
Collecting pynndescent&gt;=0.5
  Downloading pynndescent-0.5.7.tar.gz (1.1 MB)
[K     |████████████████████████████████| 1.1 MB 50.0 MB/s 
[?25hBuilding wheels for collected packages: htmlmin, imagehash, databricks-cli, pyLDAvis, pyod, umap-learn, pynndescent
  Building wheel for htmlmin (setup.py) ... [?25l[?25hdone
  Created wheel for htmlmin: filename=htmlmin-0.1.12-py3-none-any.whl size=27098 sha256=2d331816ce85c813189d9041cd350f13f87473bc4ed0e61a626eefabdd474bea
  Stored in directory: /root/.cache/pip/wheels/70/e1/52/5b14d250ba868768823940c3229e9950d201a26d0bd3ee8655
  Building wheel for imagehash (setup.py) ... [?25l[?25hdone
  Created wheel for imagehash: filename=ImageHash-4.2.1-py2.py3-none-any.whl size=295206 sha256=0a50a223aec3e2fe143a05448371c8f6ba3661c9780100762110cb0a321fef5f
  Stored in directory: /root/.cache/pip/wheels/4c/d5/59/5e3e297533ddb09407769762985d134135064c6831e29a914e
  Building wheel for databricks-cli (setup.py) ... [?25l[?25hdone
  Created wheel for databricks-cli: filename=databricks_cli-0.17.0-py3-none-any.whl size=141960 sha256=a0c3c537ebb9f15c40226c1b1a9d5460c51d9ad7df6fcc62f984cd1477312395
  Stored in directory: /root/.cache/pip/wheels/55/c3/db/33705569425fd2bdc9ea73051a8053fa26965c2bce8a146747
  Building wheel for pyLDAvis (setup.py) ... [?25l[?25hdone
  Created wheel for pyLDAvis: filename=pyLDAvis-3.2.2-py2.py3-none-any.whl size=135617 sha256=b998686d5dc7de493960ef0b985c3aad55f9d1f9648aefa1d83abddcca4b1720
  Stored in directory: /root/.cache/pip/wheels/f8/b1/9b/560ac1931796b7303f7b517b949d2d31a4fbc512aad3b9f284
  Building wheel for pyod (setup.py) ... [?25l[?25hdone
  Created wheel for pyod: filename=pyod-1.0.2-py3-none-any.whl size=150272 sha256=0b118bffd8eb7273753256e07f488717bbd477150bb571c69fd169acef28a781
  Stored in directory: /root/.cache/pip/wheels/e6/8f/06/5512935ed3c79659f612e8bb8f43cb51dd47c21973e0230997
  Building wheel for umap-learn (setup.py) ... [?25l[?25hdone
  Created wheel for umap-learn: filename=umap_learn-0.5.3-py3-none-any.whl size=82829 sha256=a259ebbb4f813fe214b294836aba0dc730e79022e68603c096508bc89d5c639f
  Stored in directory: /root/.cache/pip/wheels/b3/52/a5/1fd9e3e76a7ab34f134c07469cd6f16e27ef3a37aeff1fe821
  Building wheel for pynndescent (setup.py) ... [?25l[?25hdone
  Created wheel for pynndescent: filename=pynndescent-0.5.7-py3-none-any.whl size=54286 sha256=188344a0b7ea6a595ea7e57f1da5f50d68959c7c226ccd57a5ebe4d010061f03
  Stored in directory: /root/.cache/pip/wheels/7f/2a/f8/7bd5dcec71bd5c669f6f574db3113513696b98f3f9b51f496c
Successfully built htmlmin imagehash databricks-cli pyLDAvis pyod umap-learn pynndescent
Installing collected packages: markupsafe, numpy, tangled-up-in-unicode, smmap, scipy, multimethod, websocket-client, visions, srsly, requests, pyjwt, plac, Mako, imagehash, gitdb, catalogue, thinc, querystring-parser, pyyaml, pynndescent, prometheus-flask-exporter, phik, htmlmin, gunicorn, gitpython, funcy, docker, databricks-cli, alembic, yellowbrick, umap-learn, spacy, scikit-plot, pyod, pyLDAvis, pandas-profiling, mlxtend, mlflow, lightgbm, kmodes, imbalanced-learn, Boruta, pycaret
  Attempting uninstall: markupsafe
    Found existing installation: MarkupSafe 2.0.1
    Uninstalling MarkupSafe-2.0.1:
      Successfully uninstalled MarkupSafe-2.0.1
  Attempting uninstall: numpy
    Found existing installation: numpy 1.21.6
    Uninstalling numpy-1.21.6:
      Successfully uninstalled numpy-1.21.6
  Attempting uninstall: scipy
    Found existing installation: scipy 1.4.1
    Uninstalling scipy-1.4.1:
      Successfully uninstalled scipy-1.4.1
  Attempting uninstall: srsly
    Found existing installation: srsly 2.4.3
    Uninstalling srsly-2.4.3:
      Successfully uninstalled srsly-2.4.3
  Attempting uninstall: requests
    Found existing installation: requests 2.23.0
    Uninstalling requests-2.23.0:
      Successfully uninstalled requests-2.23.0
  Attempting uninstall: catalogue
    Found existing installation: catalogue 2.0.7
    Uninstalling catalogue-2.0.7:
      Successfully uninstalled catalogue-2.0.7
  Attempting uninstall: thinc
    Found existing installation: thinc 8.0.17
    Uninstalling thinc-8.0.17:
      Successfully uninstalled thinc-8.0.17
  Attempting uninstall: pyyaml
    Found existing installation: PyYAML 3.13
    Uninstalling PyYAML-3.13:
      Successfully uninstalled PyYAML-3.13
  Attempting uninstall: yellowbrick
    Found existing installation: yellowbrick 1.4
    Uninstalling yellowbrick-1.4:
      Successfully uninstalled yellowbrick-1.4
  Attempting uninstall: spacy
    Found existing installation: spacy 3.3.1
    Uninstalling spacy-3.3.1:
      Successfully uninstalled spacy-3.3.1
  Attempting uninstall: pandas-profiling
    Found existing installation: pandas-profiling 1.4.1
    Uninstalling pandas-profiling-1.4.1:
      Successfully uninstalled pandas-profiling-1.4.1
  Attempting uninstall: mlxtend
    Found existing installation: mlxtend 0.14.0
    Uninstalling mlxtend-0.14.0:
      Successfully uninstalled mlxtend-0.14.0
  Attempting uninstall: lightgbm
    Found existing installation: lightgbm 2.2.3
    Uninstalling lightgbm-2.2.3:
      Successfully uninstalled lightgbm-2.2.3
  Attempting uninstall: imbalanced-learn
    Found existing installation: imbalanced-learn 0.8.1
    Uninstalling imbalanced-learn-0.8.1:
      Successfully uninstalled imbalanced-learn-0.8.1
[31mERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
xarray-einstats 0.2.2 requires numpy&gt;=1.21, but you have numpy 1.19.5 which is incompatible.
tensorflow 2.8.2+zzzcolab20220527125636 requires numpy&gt;=1.20, but you have numpy 1.19.5 which is incompatible.
google-colab 1.0.0 requires requests~=2.23.0, but you have requests 2.28.1 which is incompatible.
en-core-web-sm 3.3.0 requires spacy&lt;3.4.0,&gt;=3.3.0.dev0, but you have spacy 2.3.7 which is incompatible.
datascience 0.10.6 requires folium==0.2.1, but you have folium 0.8.3 which is incompatible.
albumentations 0.1.12 requires imgaug&lt;0.2.7,&gt;=0.2.5, but you have imgaug 0.2.9 which is incompatible.[0m
Successfully installed Boruta-0.3 Mako-1.2.1 alembic-1.8.0 catalogue-1.0.0 databricks-cli-0.17.0 docker-5.0.3 funcy-1.17 gitdb-4.0.9 gitpython-3.1.27 gunicorn-20.1.0 htmlmin-0.1.12 imagehash-4.2.1 imbalanced-learn-0.7.0 kmodes-0.12.1 lightgbm-3.3.2 markupsafe-2.1.1 mlflow-1.27.0 mlxtend-0.19.0 multimethod-1.8 numpy-1.19.5 pandas-profiling-3.2.0 phik-0.12.2 plac-1.1.3 prometheus-flask-exporter-0.20.2 pyLDAvis-3.2.2 pycaret-2.3.10 pyjwt-2.4.0 pynndescent-0.5.7 pyod-1.0.2 pyyaml-5.4.1 querystring-parser-1.2.4 requests-2.28.1 scikit-plot-0.3.7 scipy-1.5.4 smmap-5.0.0 spacy-2.3.7 srsly-1.0.5 tangled-up-in-unicode-0.2.0 thinc-7.4.5 umap-learn-0.5.3 visions-0.7.4 websocket-client-1.3.3 yellowbrick-1.3.post1




Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting markupsafe==2.0.1
  Downloading MarkupSafe-2.0.1-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (31 kB)
Installing collected packages: markupsafe
  Attempting uninstall: markupsafe
    Found existing installation: MarkupSafe 2.1.1
    Uninstalling MarkupSafe-2.1.1:
      Successfully uninstalled MarkupSafe-2.1.1
[31mERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
pandas-profiling 3.2.0 requires markupsafe~=2.1.1, but you have markupsafe 2.0.1 which is incompatible.
datascience 0.10.6 requires folium==0.2.1, but you have folium 0.8.3 which is incompatible.[0m
Successfully installed markupsafe-2.0.1
</code></pre>
<ul>
<li><p>설치 완료 후 RESTART RUNTIME 클릭</p>
</li>
<li><p>PyCaret를 구글 코랩에서 활성화</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pycaret.utils <span class="keyword">import</span> enable_colab</span><br><span class="line">enable_colab()</span><br></pre></td></tr></table></figure>

<pre><code>Colab mode enabled.
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pycaret.datasets <span class="keyword">import</span> get_data</span><br><span class="line">dataset = get_data(<span class="string">&#x27;credit&#x27;</span>)  <span class="comment"># 샘플 데이터</span></span><br></pre></td></tr></table></figure>



<script src="/static/components/requirejs/require.js"></script>
<script>
  requirejs.config({
    paths: {
      base: '/static/base',
      plotly: 'https://cdn.plot.ly/plotly-latest.min.js?noext',
    },
  });
</script>





  <div id="df-2453a33b-785c-49ea-88e2-103241b65c49">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LIMIT_BAL</th>
      <th>SEX</th>
      <th>EDUCATION</th>
      <th>MARRIAGE</th>
      <th>AGE</th>
      <th>PAY_1</th>
      <th>PAY_2</th>
      <th>PAY_3</th>
      <th>PAY_4</th>
      <th>PAY_5</th>
      <th>...</th>
      <th>BILL_AMT4</th>
      <th>BILL_AMT5</th>
      <th>BILL_AMT6</th>
      <th>PAY_AMT1</th>
      <th>PAY_AMT2</th>
      <th>PAY_AMT3</th>
      <th>PAY_AMT4</th>
      <th>PAY_AMT5</th>
      <th>PAY_AMT6</th>
      <th>default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>20000</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>24</td>
      <td>2</td>
      <td>2</td>
      <td>-1</td>
      <td>-1</td>
      <td>-2</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>689.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>90000</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>34</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>14331.0</td>
      <td>14948.0</td>
      <td>15549.0</td>
      <td>1518.0</td>
      <td>1500.0</td>
      <td>1000.0</td>
      <td>1000.0</td>
      <td>1000.0</td>
      <td>5000.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>50000</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>37</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>28314.0</td>
      <td>28959.0</td>
      <td>29547.0</td>
      <td>2000.0</td>
      <td>2019.0</td>
      <td>1200.0</td>
      <td>1100.0</td>
      <td>1069.0</td>
      <td>1000.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>50000</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>57</td>
      <td>-1</td>
      <td>0</td>
      <td>-1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>20940.0</td>
      <td>19146.0</td>
      <td>19131.0</td>
      <td>2000.0</td>
      <td>36681.0</td>
      <td>10000.0</td>
      <td>9000.0</td>
      <td>689.0</td>
      <td>679.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>50000</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>37</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>19394.0</td>
      <td>19619.0</td>
      <td>20024.0</td>
      <td>2500.0</td>
      <td>1815.0</td>
      <td>657.0</td>
      <td>1000.0</td>
      <td>1000.0</td>
      <td>800.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-2453a33b-785c-49ea-88e2-103241b65c49')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg&quot;">http://www.w3.org/2000/svg&quot;</a> height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-2453a33b-785c-49ea-88e2-103241b65c49 button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-2453a33b-785c-49ea-88e2-103241b65c49&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;images/PyCaret_Sample/output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dataset.info()</span><br><span class="line"><span class="comment"># 오! 다! 숫자! PCA!!</span></span><br></pre></td></tr></table></figure>



<script src="/static/components/requirejs/require.js"></script>
<script>
  requirejs.config({
    paths: {
      base: '/static/base',
      plotly: 'https://cdn.plot.ly/plotly-latest.min.js?noext',
    },
  });
</script>



<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 24000 entries, 0 to 23999
Data columns (total 24 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   LIMIT_BAL  24000 non-null  int64  
 1   SEX        24000 non-null  int64  
 2   EDUCATION  24000 non-null  int64  
 3   MARRIAGE   24000 non-null  int64  
 4   AGE        24000 non-null  int64  
 5   PAY_1      24000 non-null  int64  
 6   PAY_2      24000 non-null  int64  
 7   PAY_3      24000 non-null  int64  
 8   PAY_4      24000 non-null  int64  
 9   PAY_5      24000 non-null  int64  
 10  PAY_6      24000 non-null  int64  
 11  BILL_AMT1  24000 non-null  float64
 12  BILL_AMT2  24000 non-null  float64
 13  BILL_AMT3  24000 non-null  float64
 14  BILL_AMT4  24000 non-null  float64
 15  BILL_AMT5  24000 non-null  float64
 16  BILL_AMT6  24000 non-null  float64
 17  PAY_AMT1   24000 non-null  float64
 18  PAY_AMT2   24000 non-null  float64
 19  PAY_AMT3   24000 non-null  float64
 20  PAY_AMT4   24000 non-null  float64
 21  PAY_AMT5   24000 non-null  float64
 22  PAY_AMT6   24000 non-null  float64
 23  default    24000 non-null  int64  
dtypes: float64(12), int64(12)
memory usage: 4.4 MB
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">data = dataset.sample(frac=<span class="number">0.95</span>, random_state=<span class="number">786</span>)</span><br><span class="line">data_unseen = dataset.drop(data.index)</span><br><span class="line">data.reset_index(inplace=<span class="literal">True</span>, drop=<span class="literal">True</span>)</span><br><span class="line">data_unseen.reset_index(inplace=<span class="literal">True</span>, drop=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Data for Modeling: &#x27;</span> + <span class="built_in">str</span>(data.shape))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Unseen Data For Predictions: &#x27;</span> + <span class="built_in">str</span>(data_unseen.shape))</span><br></pre></td></tr></table></figure>



<script src="/static/components/requirejs/require.js"></script>
<script>
  requirejs.config({
    paths: {
      base: '/static/base',
      plotly: 'https://cdn.plot.ly/plotly-latest.min.js?noext',
    },
  });
</script>



<pre><code>Data for Modeling: (22800, 24)
Unseen Data For Predictions: (1200, 24)
</code></pre>
<ul>
<li>setup</li>
<li>자기가 알아서 다 설정해줌</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jinja2</span><br><span class="line"><span class="keyword">from</span> pycaret.classification <span class="keyword">import</span> *</span><br><span class="line">exp_clf101 = setup(data = data, target = <span class="string">&#x27;default&#x27;</span>, pca=<span class="literal">True</span>, pca_components=<span class="number">10</span>, feature_selection=<span class="literal">True</span>, session_id=<span class="number">123</span>) </span><br></pre></td></tr></table></figure>



  <div id="df-a2451dab-0bdb-4a90-a7b1-33e23d5f9739">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Description</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>session_id</td>
      <td>123</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Target</td>
      <td>default</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Target Type</td>
      <td>Binary</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Label Encoded</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Original Data</td>
      <td>(22800, 24)</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Missing Values</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Numeric Features</td>
      <td>14</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Categorical Features</td>
      <td>9</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Ordinal Features</td>
      <td>False</td>
    </tr>
    <tr>
      <th>9</th>
      <td>High Cardinality Features</td>
      <td>False</td>
    </tr>
    <tr>
      <th>10</th>
      <td>High Cardinality Method</td>
      <td>None</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Transformed Train Set</td>
      <td>(15959, 10)</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Transformed Test Set</td>
      <td>(6841, 10)</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Shuffle Train-Test</td>
      <td>True</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Stratify Train-Test</td>
      <td>False</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Fold Generator</td>
      <td>StratifiedKFold</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Fold Number</td>
      <td>10</td>
    </tr>
    <tr>
      <th>17</th>
      <td>CPU Jobs</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Use GPU</td>
      <td>False</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Log Experiment</td>
      <td>False</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Experiment Name</td>
      <td>clf-default-name</td>
    </tr>
    <tr>
      <th>21</th>
      <td>USI</td>
      <td>1138</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Imputation Type</td>
      <td>simple</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Iterative Imputation Iteration</td>
      <td>None</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Numeric Imputer</td>
      <td>mean</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Iterative Imputation Numeric Model</td>
      <td>None</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Categorical Imputer</td>
      <td>constant</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Iterative Imputation Categorical Model</td>
      <td>None</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Unknown Categoricals Handling</td>
      <td>least_frequent</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Normalize</td>
      <td>False</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Normalize Method</td>
      <td>None</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Transformation</td>
      <td>False</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Transformation Method</td>
      <td>None</td>
    </tr>
    <tr>
      <th>33</th>
      <td>PCA</td>
      <td>True</td>
    </tr>
    <tr>
      <th>34</th>
      <td>PCA Method</td>
      <td>linear</td>
    </tr>
    <tr>
      <th>35</th>
      <td>PCA Components</td>
      <td>10</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Ignore Low Variance</td>
      <td>False</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Combine Rare Levels</td>
      <td>False</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Rare Level Threshold</td>
      <td>None</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Numeric Binning</td>
      <td>False</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Remove Outliers</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Outliers Threshold</td>
      <td>None</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Remove Multicollinearity</td>
      <td>False</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Multicollinearity Threshold</td>
      <td>None</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Remove Perfect Collinearity</td>
      <td>True</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Clustering</td>
      <td>False</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Clustering Iteration</td>
      <td>None</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Polynomial Features</td>
      <td>False</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Polynomial Degree</td>
      <td>None</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Trignometry Features</td>
      <td>False</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Polynomial Threshold</td>
      <td>None</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Group Features</td>
      <td>False</td>
    </tr>
    <tr>
      <th>52</th>
      <td>Feature Selection</td>
      <td>True</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Feature Selection Method</td>
      <td>classic</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Features Selection Threshold</td>
      <td>0.8</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Feature Interaction</td>
      <td>False</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Feature Ratio</td>
      <td>False</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Interaction Threshold</td>
      <td>None</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Fix Imbalance</td>
      <td>False</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Fix Imbalance Method</td>
      <td>SMOTE</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-a2451dab-0bdb-4a90-a7b1-33e23d5f9739')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg&quot;">http://www.w3.org/2000/svg&quot;</a> height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-a2451dab-0bdb-4a90-a7b1-33e23d5f9739 button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-a2451dab-0bdb-4a90-a7b1-33e23d5f9739&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;images/PyCaret_Sample/output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>



<ul>
<li>위에 다 되면 빈칸 enter~!!</li>
</ul>
<h2 id="모델링"><a href="#모델링" class="headerlink" title="모델링"></a>모델링</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">best_model = compare_models()</span><br></pre></td></tr></table></figure>



  <div id="df-98b64b77-316c-420f-86bd-7e4053c4297c">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Accuracy</th>
      <th>AUC</th>
      <th>Recall</th>
      <th>Prec.</th>
      <th>F1</th>
      <th>Kappa</th>
      <th>MCC</th>
      <th>TT (Sec)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ridge</th>
      <td>Ridge Classifier</td>
      <td>0.8254</td>
      <td>0.0000</td>
      <td>0.3637</td>
      <td>0.6913</td>
      <td>0.4764</td>
      <td>0.3836</td>
      <td>0.4122</td>
      <td>0.048</td>
    </tr>
    <tr>
      <th>lda</th>
      <td>Linear Discriminant Analysis</td>
      <td>0.8247</td>
      <td>0.7634</td>
      <td>0.3755</td>
      <td>0.6794</td>
      <td>0.4835</td>
      <td>0.3884</td>
      <td>0.4132</td>
      <td>0.288</td>
    </tr>
    <tr>
      <th>gbc</th>
      <td>Gradient Boosting Classifier</td>
      <td>0.8226</td>
      <td>0.7789</td>
      <td>0.3551</td>
      <td>0.6806</td>
      <td>0.4664</td>
      <td>0.3725</td>
      <td>0.4010</td>
      <td>6.496</td>
    </tr>
    <tr>
      <th>ada</th>
      <td>Ada Boost Classifier</td>
      <td>0.8221</td>
      <td>0.7697</td>
      <td>0.3505</td>
      <td>0.6811</td>
      <td>0.4626</td>
      <td>0.3690</td>
      <td>0.3983</td>
      <td>1.317</td>
    </tr>
    <tr>
      <th>lightgbm</th>
      <td>Light Gradient Boosting Machine</td>
      <td>0.8210</td>
      <td>0.7750</td>
      <td>0.3609</td>
      <td>0.6679</td>
      <td>0.4683</td>
      <td>0.3721</td>
      <td>0.3977</td>
      <td>0.436</td>
    </tr>
    <tr>
      <th>rf</th>
      <td>Random Forest Classifier</td>
      <td>0.8199</td>
      <td>0.7598</td>
      <td>0.3663</td>
      <td>0.6601</td>
      <td>0.4707</td>
      <td>0.3727</td>
      <td>0.3965</td>
      <td>3.086</td>
    </tr>
    <tr>
      <th>et</th>
      <td>Extra Trees Classifier</td>
      <td>0.8092</td>
      <td>0.7377</td>
      <td>0.3677</td>
      <td>0.6047</td>
      <td>0.4571</td>
      <td>0.3497</td>
      <td>0.3657</td>
      <td>2.374</td>
    </tr>
    <tr>
      <th>lr</th>
      <td>Logistic Regression</td>
      <td>0.7814</td>
      <td>0.6410</td>
      <td>0.0003</td>
      <td>0.1000</td>
      <td>0.0006</td>
      <td>0.0003</td>
      <td>0.0034</td>
      <td>1.165</td>
    </tr>
    <tr>
      <th>dummy</th>
      <td>Dummy Classifier</td>
      <td>0.7814</td>
      <td>0.5000</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.0000</td>
      <td>0.032</td>
    </tr>
    <tr>
      <th>knn</th>
      <td>K Neighbors Classifier</td>
      <td>0.7547</td>
      <td>0.5939</td>
      <td>0.1763</td>
      <td>0.3719</td>
      <td>0.2388</td>
      <td>0.1145</td>
      <td>0.1259</td>
      <td>0.992</td>
    </tr>
    <tr>
      <th>dt</th>
      <td>Decision Tree Classifier</td>
      <td>0.7293</td>
      <td>0.6147</td>
      <td>0.4104</td>
      <td>0.3878</td>
      <td>0.3986</td>
      <td>0.2242</td>
      <td>0.2245</td>
      <td>0.370</td>
    </tr>
    <tr>
      <th>svm</th>
      <td>SVM - Linear Kernel</td>
      <td>0.7277</td>
      <td>0.0000</td>
      <td>0.1017</td>
      <td>0.1671</td>
      <td>0.0984</td>
      <td>0.0067</td>
      <td>0.0075</td>
      <td>0.493</td>
    </tr>
    <tr>
      <th>qda</th>
      <td>Quadratic Discriminant Analysis</td>
      <td>0.5098</td>
      <td>0.5473</td>
      <td>0.6141</td>
      <td>0.2472</td>
      <td>0.3488</td>
      <td>0.0600</td>
      <td>0.0805</td>
      <td>0.158</td>
    </tr>
    <tr>
      <th>nb</th>
      <td>Naive Bayes</td>
      <td>0.3760</td>
      <td>0.6442</td>
      <td>0.8845</td>
      <td>0.2441</td>
      <td>0.3826</td>
      <td>0.0608</td>
      <td>0.1207</td>
      <td>0.050</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-98b64b77-316c-420f-86bd-7e4053c4297c')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg&quot;">http://www.w3.org/2000/svg&quot;</a> height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-98b64b77-316c-420f-86bd-7e4053c4297c button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-98b64b77-316c-420f-86bd-7e4053c4297c&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;images/PyCaret_Sample/output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>



<ul>
<li>가장 좋은 모델을 뽑아주세요!</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(best_model)</span><br></pre></td></tr></table></figure>



<script src="/static/components/requirejs/require.js"></script>
<script>
  requirejs.config({
    paths: {
      base: '/static/base',
      plotly: 'https://cdn.plot.ly/plotly-latest.min.js?noext',
    },
  });
</script>



<pre><code>RidgeClassifier(alpha=1.0, class_weight=None, copy_X=True, fit_intercept=True,
                max_iter=None, normalize=False, random_state=123, solver=&#39;auto&#39;,
                tol=0.001)
</code></pre>
<ul>
<li>모델 확인</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">models()</span><br></pre></td></tr></table></figure>



<script src="/static/components/requirejs/require.js"></script>
<script>
  requirejs.config({
    paths: {
      base: '/static/base',
      plotly: 'https://cdn.plot.ly/plotly-latest.min.js?noext',
    },
  });
</script>







  <div id="df-fbacfacd-6656-4bca-ba91-838dd08cdeb1">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Reference</th>
      <th>Turbo</th>
    </tr>
    <tr>
      <th>ID</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>lr</th>
      <td>Logistic Regression</td>
      <td>sklearn.linear_model._logistic.LogisticRegression</td>
      <td>True</td>
    </tr>
    <tr>
      <th>knn</th>
      <td>K Neighbors Classifier</td>
      <td>sklearn.neighbors._classification.KNeighborsCl...</td>
      <td>True</td>
    </tr>
    <tr>
      <th>nb</th>
      <td>Naive Bayes</td>
      <td>sklearn.naive_bayes.GaussianNB</td>
      <td>True</td>
    </tr>
    <tr>
      <th>dt</th>
      <td>Decision Tree Classifier</td>
      <td>sklearn.tree._classes.DecisionTreeClassifier</td>
      <td>True</td>
    </tr>
    <tr>
      <th>svm</th>
      <td>SVM - Linear Kernel</td>
      <td>sklearn.linear_model._stochastic_gradient.SGDC...</td>
      <td>True</td>
    </tr>
    <tr>
      <th>rbfsvm</th>
      <td>SVM - Radial Kernel</td>
      <td>sklearn.svm._classes.SVC</td>
      <td>False</td>
    </tr>
    <tr>
      <th>gpc</th>
      <td>Gaussian Process Classifier</td>
      <td>sklearn.gaussian_process._gpc.GaussianProcessC...</td>
      <td>False</td>
    </tr>
    <tr>
      <th>mlp</th>
      <td>MLP Classifier</td>
      <td>sklearn.neural_network._multilayer_perceptron....</td>
      <td>False</td>
    </tr>
    <tr>
      <th>ridge</th>
      <td>Ridge Classifier</td>
      <td>sklearn.linear_model._ridge.RidgeClassifier</td>
      <td>True</td>
    </tr>
    <tr>
      <th>rf</th>
      <td>Random Forest Classifier</td>
      <td>sklearn.ensemble._forest.RandomForestClassifier</td>
      <td>True</td>
    </tr>
    <tr>
      <th>qda</th>
      <td>Quadratic Discriminant Analysis</td>
      <td>sklearn.discriminant_analysis.QuadraticDiscrim...</td>
      <td>True</td>
    </tr>
    <tr>
      <th>ada</th>
      <td>Ada Boost Classifier</td>
      <td>sklearn.ensemble._weight_boosting.AdaBoostClas...</td>
      <td>True</td>
    </tr>
    <tr>
      <th>gbc</th>
      <td>Gradient Boosting Classifier</td>
      <td>sklearn.ensemble._gb.GradientBoostingClassifier</td>
      <td>True</td>
    </tr>
    <tr>
      <th>lda</th>
      <td>Linear Discriminant Analysis</td>
      <td>sklearn.discriminant_analysis.LinearDiscrimina...</td>
      <td>True</td>
    </tr>
    <tr>
      <th>et</th>
      <td>Extra Trees Classifier</td>
      <td>sklearn.ensemble._forest.ExtraTreesClassifier</td>
      <td>True</td>
    </tr>
    <tr>
      <th>lightgbm</th>
      <td>Light Gradient Boosting Machine</td>
      <td>lightgbm.sklearn.LGBMClassifier</td>
      <td>True</td>
    </tr>
    <tr>
      <th>dummy</th>
      <td>Dummy Classifier</td>
      <td>sklearn.dummy.DummyClassifier</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-fbacfacd-6656-4bca-ba91-838dd08cdeb1')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg&quot;">http://www.w3.org/2000/svg&quot;</a> height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-fbacfacd-6656-4bca-ba91-838dd08cdeb1 button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-fbacfacd-6656-4bca-ba91-838dd08cdeb1&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;images/PyCaret_Sample/output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>




<ul>
<li>모델 생성 (knn)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">knn_model = create_model(<span class="string">&#x27;knn&#x27;</span>)</span><br></pre></td></tr></table></figure>



  <div id="df-1188fb14-1614-4158-a810-7cfea2e706c8">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Accuracy</th>
      <th>AUC</th>
      <th>Recall</th>
      <th>Prec.</th>
      <th>F1</th>
      <th>Kappa</th>
      <th>MCC</th>
    </tr>
    <tr>
      <th>Fold</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.7531</td>
      <td>0.6064</td>
      <td>0.1920</td>
      <td>0.3743</td>
      <td>0.2538</td>
      <td>0.1239</td>
      <td>0.1338</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.7544</td>
      <td>0.5927</td>
      <td>0.1977</td>
      <td>0.3812</td>
      <td>0.2604</td>
      <td>0.1305</td>
      <td>0.1406</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.7500</td>
      <td>0.5850</td>
      <td>0.1461</td>
      <td>0.3355</td>
      <td>0.2036</td>
      <td>0.0818</td>
      <td>0.0917</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.7431</td>
      <td>0.5754</td>
      <td>0.1519</td>
      <td>0.3174</td>
      <td>0.2054</td>
      <td>0.0744</td>
      <td>0.0816</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.7556</td>
      <td>0.5796</td>
      <td>0.1576</td>
      <td>0.3642</td>
      <td>0.2200</td>
      <td>0.1013</td>
      <td>0.1138</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.7538</td>
      <td>0.5969</td>
      <td>0.1748</td>
      <td>0.3675</td>
      <td>0.2369</td>
      <td>0.1117</td>
      <td>0.1227</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.7600</td>
      <td>0.5929</td>
      <td>0.1891</td>
      <td>0.3976</td>
      <td>0.2563</td>
      <td>0.1343</td>
      <td>0.1475</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.7613</td>
      <td>0.6223</td>
      <td>0.1719</td>
      <td>0.3947</td>
      <td>0.2395</td>
      <td>0.1232</td>
      <td>0.1382</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.7688</td>
      <td>0.5926</td>
      <td>0.1948</td>
      <td>0.4359</td>
      <td>0.2693</td>
      <td>0.1552</td>
      <td>0.1730</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.7542</td>
      <td>0.5708</td>
      <td>0.1695</td>
      <td>0.3642</td>
      <td>0.2314</td>
      <td>0.1077</td>
      <td>0.1189</td>
    </tr>
    <tr>
      <th>Mean</th>
      <td>0.7554</td>
      <td>0.5915</td>
      <td>0.1745</td>
      <td>0.3733</td>
      <td>0.2377</td>
      <td>0.1144</td>
      <td>0.1262</td>
    </tr>
    <tr>
      <th>Std</th>
      <td>0.0065</td>
      <td>0.0144</td>
      <td>0.0176</td>
      <td>0.0313</td>
      <td>0.0216</td>
      <td>0.0232</td>
      <td>0.0254</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-1188fb14-1614-4158-a810-7cfea2e706c8')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg&quot;">http://www.w3.org/2000/svg&quot;</a> height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-1188fb14-1614-4158-a810-7cfea2e706c8 button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-1188fb14-1614-4158-a810-7cfea2e706c8&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;images/PyCaret_Sample/output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 하이퍼파라미터 여기에서 튜닝</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">params =&#123;</span><br><span class="line">    <span class="string">&#x27;n_neighbors&#x27;</span> : np.arange(<span class="number">0</span>, <span class="number">50</span>, <span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line">tunned_knn = tune_model(knn_model, custom_grid=params)</span><br><span class="line"><span class="built_in">print</span>(tunned_knn)</span><br></pre></td></tr></table></figure>



  <div id="df-8bbeba7c-01ad-4759-978b-ef4b82675912">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Accuracy</th>
      <th>AUC</th>
      <th>Recall</th>
      <th>Prec.</th>
      <th>F1</th>
      <th>Kappa</th>
      <th>MCC</th>
    </tr>
    <tr>
      <th>Fold</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.7813</td>
      <td>0.6482</td>
      <td>0.0372</td>
      <td>0.5000</td>
      <td>0.0693</td>
      <td>0.0402</td>
      <td>0.0876</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.7807</td>
      <td>0.6436</td>
      <td>0.0315</td>
      <td>0.4783</td>
      <td>0.0591</td>
      <td>0.0330</td>
      <td>0.0759</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.7744</td>
      <td>0.6563</td>
      <td>0.0315</td>
      <td>0.3333</td>
      <td>0.0576</td>
      <td>0.0206</td>
      <td>0.0403</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.7845</td>
      <td>0.6589</td>
      <td>0.0659</td>
      <td>0.5610</td>
      <td>0.1179</td>
      <td>0.0754</td>
      <td>0.1345</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.7826</td>
      <td>0.6645</td>
      <td>0.0315</td>
      <td>0.5500</td>
      <td>0.0596</td>
      <td>0.0368</td>
      <td>0.0903</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.7794</td>
      <td>0.6477</td>
      <td>0.0544</td>
      <td>0.4634</td>
      <td>0.0974</td>
      <td>0.0539</td>
      <td>0.0961</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.7826</td>
      <td>0.6278</td>
      <td>0.0630</td>
      <td>0.5238</td>
      <td>0.1125</td>
      <td>0.0688</td>
      <td>0.1214</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.7751</td>
      <td>0.6702</td>
      <td>0.0372</td>
      <td>0.3611</td>
      <td>0.0675</td>
      <td>0.0278</td>
      <td>0.0523</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.7813</td>
      <td>0.6409</td>
      <td>0.0630</td>
      <td>0.5000</td>
      <td>0.1120</td>
      <td>0.0662</td>
      <td>0.1146</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.7881</td>
      <td>0.6426</td>
      <td>0.0661</td>
      <td>0.6389</td>
      <td>0.1198</td>
      <td>0.0822</td>
      <td>0.1548</td>
    </tr>
    <tr>
      <th>Mean</th>
      <td>0.7810</td>
      <td>0.6501</td>
      <td>0.0482</td>
      <td>0.4910</td>
      <td>0.0873</td>
      <td>0.0505</td>
      <td>0.0968</td>
    </tr>
    <tr>
      <th>Std</th>
      <td>0.0039</td>
      <td>0.0119</td>
      <td>0.0148</td>
      <td>0.0861</td>
      <td>0.0255</td>
      <td>0.0206</td>
      <td>0.0338</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-8bbeba7c-01ad-4759-978b-ef4b82675912')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg&quot;">http://www.w3.org/2000/svg&quot;</a> height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-8bbeba7c-01ad-4759-978b-ef4b82675912 button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-8bbeba7c-01ad-4759-978b-ef4b82675912&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;images/PyCaret_Sample/output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>



<pre><code>KNeighborsClassifier(algorithm=&#39;auto&#39;, leaf_size=30, metric=&#39;minkowski&#39;,
                     metric_params=None, n_jobs=-1, n_neighbors=42, p=2,
                     weights=&#39;uniform&#39;)
</code></pre>
<h2 id="결론-데이터-분석은-기획력이-중요하다"><a href="#결론-데이터-분석은-기획력이-중요하다" class="headerlink" title="결론 : 데이터 분석은 기획력이 중요하다."></a>결론 : 데이터 분석은 기획력이 중요하다.</h2><ul>
<li>어떻게 서비스 할 것이냐.</li>
<li>분석을 하는 개발자</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 시각화</span></span><br><span class="line">plot_model(knn_model, plot=<span class="string">&#x27;auc&#x27;</span>)</span><br></pre></td></tr></table></figure>


<p><img src="/images/PyCaret_Sample/output_22_0.png" alt="png"></p>
<h3 id="auc"><a href="#auc" class="headerlink" title="auc"></a>auc</h3><ul>
<li>최소 0.5</li>
<li>좋은 모델 기준 0.8</li>
<li>최대 1.0</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plot_model(knn_model, plot=<span class="string">&#x27;confusion_matrix&#x27;</span>)</span><br></pre></td></tr></table></figure>


<p><img src="/images/PyCaret_Sample/output_24_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">evaluate_model(tunned_knn)</span><br></pre></td></tr></table></figure>



<script src="/static/components/requirejs/require.js"></script>
<script>
  requirejs.config({
    paths: {
      base: '/static/base',
      plotly: 'https://cdn.plot.ly/plotly-latest.min.js?noext',
    },
  });
</script>




<pre><code>interactive(children=(ToggleButtons(description=&#39;Plot Type:&#39;, icons=(&#39;&#39;,), options=((&#39;Hyperparameters&#39;, &#39;param…
</code></pre>
<h2 id="어떤-모델을-사용할-것이냐를-빠르게-판단"><a href="#어떤-모델을-사용할-것이냐를-빠르게-판단" class="headerlink" title="어떤 모델을 사용할 것이냐를 빠르게 판단"></a>어떤 모델을 사용할 것이냐를 빠르게 판단</h2><ul>
<li>정확한 데이터는 셋팅을 해주는 것이 좋다.</li>
</ul>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-python_6"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2022/07/05/python_6/">혼공머 Chapter 06</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2022/07/05/python_6/" class="article-date">
	  <time datetime="2022-07-04T16:00:00.000Z" itemprop="datePublished">July 5, 2022</time>
	</a>

       
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="0-자율학습"><a href="#0-자율학습" class="headerlink" title="0. 자율학습"></a>0. 자율학습</h1><ul>
<li>실무에서의 난이도<ul>
<li>비지도학습 &gt;&gt; 지도학습</li>
</ul>
</li>
<li>비지도학습 : 분류, 수치적으로 분류, 특성, 분포 등으로 1차적으로 분류, 사람이 뭐가 뭔지 지정해줌.</li>
<li>지도학습 : 이게 사과야!, 이진분리</li>
<li>알고리즘은 쉬우나, 사람이 정의를 내려주기 애매 해서 실무에서의 난의도가 높다.<ul>
<li>러시아-우크라이나</li>
<li>세계뉴스? 전쟁뉴스? 경제뉴스?</li>
</ul>
</li>
</ul>
<h1 id="Chapter-06-1-군집-알고리즘"><a href="#Chapter-06-1-군집-알고리즘" class="headerlink" title="Chapter 06-1 군집 알고리즘"></a>Chapter 06-1 군집 알고리즘</h1><p>- </p>
<h1 id="Chapter-06-2-K-평균"><a href="#Chapter-06-2-K-평균" class="headerlink" title="Chapter 06-2 K-평균"></a>Chapter 06-2 K-평균</h1><p>- </p>
<h1 id="Chapter-06-3-주성분-분석"><a href="#Chapter-06-3-주성분-분석" class="headerlink" title="Chapter 06-3 주성분 분석"></a>Chapter 06-3 주성분 분석</h1><ul>
<li>이론적으로는 어려움<ul>
<li>좌표계 공간 개념</li>
<li>공분산_통계관련 내용</li>
<li>직교 + 회전</li>
</ul>
</li>
<li>Feature Engineering 기법</li>
<li>StandatdScaler()</li>
<li>현 ML의 문제점 컬럼의 갯수가 매우 많음. (데이터 수집하는 방법이 다양해졌기 때문_ 음성, 사진, 위치 등 - google analytics)</li>
</ul>
<h2 id="차원과-차원-축소"><a href="#차원과-차원-축소" class="headerlink" title="차원과 차원 축소"></a>차원과 차원 축소</h2><ul>
<li>PCA : 차원(&#x3D;데이터 특성&#x3D;컬럼)을 축소할 수 있음.</li>
<li>특성이 많으면 훈련 데이터에 쉽게 과대적합된다.</li>
<li>특성을 줄여서 학습 모델의 성능을 향상 및 학습 시간을 감소시킨다.</li>
<li>대표적인 방법론 : PCA, EFA</li>
</ul>
<h3 id="PCV-vs-EFA"><a href="#PCV-vs-EFA" class="headerlink" title="PCV vs EFA"></a>PCV vs EFA</h3><ul>
<li><p>EFA(탐색적 요인 분석),Factor Analysis</p>
<ul>
<li>예) 국어, 수학, 과학, 영어</li>
<li>예) 국어 40, 수학 100, 과학 100, 영어 30 &#x2F; 귀 학생의 언어영역은 수준이 낮은 편이나 수리영역은 매우 수준이 높습니다.</li>
<li>비슷한 성질끼리 묶어주는 것</li>
<li>주로 범주형 &amp; 수치 데이터셋</li>
</ul>
</li>
<li><p>PCA (주성분 분석)</p>
<ul>
<li>장비1, 장비2, 장비3, 장비4, …</li>
<li>PC1, PC2, PC3, PC4, ..PCN   &lt;- PCV값</li>
<li>PCV값만 보고 원래 가지고 있던 정보를 알 수 없음. (정보손실)</li>
<li>범주형 데이터셋에는 사용 X</li>
<li>무조건 수치형 데이터에서만 사용</li>
<li>PCA 실행 전 반드시 표준화 처리(스케일링 실행, 단위 맞추기)</li>
</ul>
</li>
</ul>
<h2 id="주성분-분석-320p"><a href="#주성분-분석-320p" class="headerlink" title="주성분 분석 (320p)"></a>주성분 분석 (320p)</h2><ul>
<li>여러개 데이터 특성을 소수의 데이터 특성으로 줄인다-&gt; 그럼에도 불구하고 원본 데이터의 특성을 잘 나타낸다.</li>
</ul>
<h2 id="PCA-클래스"><a href="#PCA-클래스" class="headerlink" title="PCA 클래스"></a>PCA 클래스</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!wget https://bit.ly/fruits_300_data -O fruits_300.npy  <span class="comment"># -O 숫자 0이 아닌 영문 O</span></span><br></pre></td></tr></table></figure>

<pre><code>--2022-07-05 04:58:55--  https://bit.ly/fruits_300_data
Resolving bit.ly (bit.ly)... 67.199.248.11, 67.199.248.10
Connecting to bit.ly (bit.ly)|67.199.248.11|:443... connected.
HTTP request sent, awaiting response... 301 Moved Permanently
Location: https://github.com/rickiepark/hg-mldl/raw/master/fruits_300.npy [following]
--2022-07-05 04:58:55--  https://github.com/rickiepark/hg-mldl/raw/master/fruits_300.npy
Resolving github.com (github.com)... 140.82.113.3
Connecting to github.com (github.com)|140.82.113.3|:443... connected.
HTTP request sent, awaiting response... 302 Found
Location: https://raw.githubusercontent.com/rickiepark/hg-mldl/master/fruits_300.npy [following]
--2022-07-05 04:58:55--  https://raw.githubusercontent.com/rickiepark/hg-mldl/master/fruits_300.npy
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.108.133, 185.199.109.133, 185.199.110.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.108.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 3000128 (2.9M) [application/octet-stream]
Saving to: ‘fruits_300.npy’

fruits_300.npy      100%[===================&gt;]   2.86M  --.-KB/s    in 0.07s   

2022-07-05 04:58:56 (42.6 MB/s) - ‘fruits_300.npy’ saved [3000128/3000128]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">fruits = np.load(<span class="string">&#x27;fruits_300.npy&#x27;</span>)</span><br><span class="line">fruits_2d = fruits.reshape(-<span class="number">1</span>, <span class="number">100</span>*<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 300개 행, 10000개의 열</span></span><br><span class="line">fruits_2d.shape</span><br></pre></td></tr></table></figure>




<pre><code>(300, 10000)
</code></pre>
<ul>
<li>pca</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.decomposition <span class="keyword">import</span> PCA</span><br><span class="line">pca = PCA(n_components=<span class="number">50</span>)</span><br><span class="line">pca.fit(fruits_2d)</span><br></pre></td></tr></table></figure>




<pre><code>PCA(n_components=50)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(pca.components_.shape)</span><br><span class="line"><span class="comment"># n_components=50으로 지정했기 때문에 pca.components_ 배열의 첫 번째 차원이 50입니다. 즉 50개의 주성분을 찾음.</span></span><br><span class="line"><span class="comment"># 두 번째 차원은 항상 원본 데이터의 특성 개수와 같은 10,000입니다.</span></span><br></pre></td></tr></table></figure>

<pre><code>(50, 10000)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">draw_fruits</span>(<span class="params">arr, ratio=<span class="number">1</span></span>):</span><br><span class="line">    n = <span class="built_in">len</span>(arr)    <span class="comment"># n은 샘플 개수입니다</span></span><br><span class="line">    <span class="comment"># 한 줄에 10개씩 이미지를 그립니다. 샘플 개수를 10으로 나누어 전체 행 개수를 계산합니다. </span></span><br><span class="line">    rows = <span class="built_in">int</span>(np.ceil(n/<span class="number">10</span>))</span><br><span class="line">    <span class="comment"># 행이 1개 이면 열 개수는 샘플 개수입니다. 그렇지 않으면 10개입니다.</span></span><br><span class="line">    cols = n <span class="keyword">if</span> rows &lt; <span class="number">2</span> <span class="keyword">else</span> <span class="number">10</span></span><br><span class="line">    fig, axs = plt.subplots(rows, cols, </span><br><span class="line">                            figsize=(cols*ratio, rows*ratio), squeeze=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rows):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(cols):</span><br><span class="line">            <span class="keyword">if</span> i*<span class="number">10</span> + j &lt; n:    <span class="comment"># n 개까지만 그립니다.</span></span><br><span class="line">                axs[i, j].imshow(arr[i*<span class="number">10</span> + j], cmap=<span class="string">&#x27;gray_r&#x27;</span>)</span><br><span class="line">            axs[i, j].axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">draw_fruits(pca.components_.reshape(-<span class="number">1</span>, <span class="number">100</span>, <span class="number">100</span>))</span><br></pre></td></tr></table></figure>


<p><img src="/images/python_6/output_14_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 중요!!!! 머신러닝에서 컬럼의 갯수를 10,000개에서 50로 줄임. 다만 수치데이터만 가능!!</span></span><br><span class="line">fruits_pca = pca.transform(fruits_2d)</span><br><span class="line"><span class="built_in">print</span>(fruits_pca.shape)</span><br></pre></td></tr></table></figure>

<pre><code>(300, 50)
</code></pre>
<ul>
<li>훈련데이터, 테스트 데이터 분리</li>
</ul>
<h2 id="설명된-분산"><a href="#설명된-분산" class="headerlink" title="설명된 분산"></a>설명된 분산</h2><ul>
<li>주성분이 원본 데이터의 분산을 얼마나 잘 나타내는지 기록한 값</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 주성분이 원본 데이터의 분산을 92% 정도 나타냈다.</span></span><br><span class="line"><span class="comment"># 원본 이미지 압축</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(np.<span class="built_in">sum</span>(pca.explained_variance_ratio_))</span><br></pre></td></tr></table></figure>

<pre><code>0.9215454602209046
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plt.plot(pca.explained_variance_ratio_)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># [결과 해석] 50개도 여전히 많다.</span></span><br></pre></td></tr></table></figure>


<p><img src="/images/python_6/output_20_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(np.<span class="built_in">sum</span>(pca.explained_variance_ratio_[:<span class="number">30</span>]))</span><br></pre></td></tr></table></figure>

<pre><code>0.8783777973933925
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(np.<span class="built_in">sum</span>(pca.explained_variance_ratio_[:<span class="number">51</span>]))</span><br></pre></td></tr></table></figure>

<pre><code>0.9215454602209046
</code></pre>
<h2 id="다른-알고리즘과-함꼐-사용하기-SKIP"><a href="#다른-알고리즘과-함꼐-사용하기-SKIP" class="headerlink" title="다른 알고리즘과 함꼐 사용하기  [SKIP]"></a>다른 알고리즘과 함꼐 사용하기  [SKIP]</h2><ul>
<li>과일 사진 원본 데이터와 PCA로 축소한 데이터를 지도 학습에 적용해 보고 어떤 차이가 있는지 알아보자.</li>
<li>사이킷런의 LogisticRegression 모델과 비교</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line">lr = LogisticRegression()</span><br></pre></td></tr></table></figure>

<ul>
<li>지도 학습 모델을 사용하려면 타깃값이 있어야 한다.</li>
<li>사과 0, 파인애플 1, 바나나 2</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">target = np.array([<span class="number">0</span>]*<span class="number">100</span>+[<span class="number">1</span>]*<span class="number">100</span> + [<span class="number">2</span>]*<span class="number">100</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>먼저 원본 데이터인 fruits_2d를 사용</li>
<li>로지스틱 회귀 모델에서의 성능을 가늠해 보기 위해 cross_validte()로 교차 검증 수행</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_validate</span><br><span class="line">scores = cross_validate(lr, fruits_2d, target)</span><br><span class="line"><span class="built_in">print</span>(np.mean(scores[<span class="string">&#x27;test_score&#x27;</span>]))</span><br><span class="line"><span class="built_in">print</span>(np.mean(scores[<span class="string">&#x27;fit_time&#x27;</span>]))</span><br></pre></td></tr></table></figure>

<pre><code>0.9966666666666667
1.5436992645263672
</code></pre>
<ul>
<li>PCA로 축소한 fruits_pca 사용</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scores = cross_validate(lr,fruits_pca,target)</span><br><span class="line"><span class="built_in">print</span>(np.mean(scores[<span class="string">&#x27;test_score&#x27;</span>]))</span><br><span class="line"><span class="built_in">print</span>(np.mean(scores[<span class="string">&#x27;fit_time&#x27;</span>]))</span><br></pre></td></tr></table></figure>

<pre><code>1.0
0.0634692668914795
</code></pre>
<ul>
<li><p>[결과 해석] 50개의 특성만 사용 했음에도 정확도가 100%, 훈련시간도 적어짐</p>
</li>
<li><p>주성분 대신 원하는 설명된 분산의 비율을 입력해도 된다.</p>
</li>
<li><p>0~1 사이의 비율을 실수로 입력</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pca = PCA(n_components=<span class="number">0.5</span>)</span><br><span class="line">pca.fit(fruits_2d)</span><br></pre></td></tr></table></figure>




<pre><code>PCA(n_components=0.5)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(pca.n_components_)</span><br></pre></td></tr></table></figure>

<pre><code>2
</code></pre>
<ul>
<li><p>[결과 해석] 단 2개의 특성만으로 원본 데이터에 있는 분산의 50%를 표현할 수 있다.</p>
</li>
<li><p>이 모델을 원본 데이터로 변환</p>
</li>
<li><p>주성분이 2개 이므로 변환된 데이터 크기는 (300,2)</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fruits_pca = pca.transform(fruits_2d)</span><br><span class="line"><span class="built_in">print</span>(fruits_pca.shape)</span><br></pre></td></tr></table></figure>

<pre><code>(300, 2)
</code></pre>
<ul>
<li>2개의 특성만 사용해도 교차검증의 결과가 좋을까?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scores = cross_validate(lr,fruits_pca, target)</span><br><span class="line"><span class="built_in">print</span>(np.mean(scores[<span class="string">&#x27;test_score&#x27;</span>]))</span><br><span class="line"><span class="built_in">print</span>(np.mean(scores[<span class="string">&#x27;fit_time&#x27;</span>]))</span><br></pre></td></tr></table></figure>

<pre><code>0.9933333333333334
0.04194316864013672


/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
/usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
</code></pre>
<ul>
<li><p>[결과해석] 99%의 정확성</p>
</li>
<li><p>차원 축소된 데이터를 이용해 K-평균 알고리즘으로 클러스터를 찾아보자.</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> KMeans</span><br><span class="line">km = KMeans(n_clusters=<span class="number">3</span>, random_state=<span class="number">42</span>)</span><br><span class="line">km.fit(fruits_pca)</span><br><span class="line"><span class="built_in">print</span>(np.unique(km.labels_, return_counts=<span class="literal">True</span>))</span><br></pre></td></tr></table></figure>

<pre><code>(array([0, 1, 2], dtype=int32), array([110,  99,  91]))
</code></pre>
<ul>
<li>이미지 출력</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> label <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">3</span>):</span><br><span class="line">  draw_fruits(fruits[km.labels_==label])</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;/n&quot;</span>)</span><br></pre></td></tr></table></figure>


<p><img src="/images/python_6/output_44_0.png" alt="png"></p>
<pre><code>/n
</code></pre>
<p><img src="/images/python_6/output_44_2.png" alt="png"></p>
<pre><code>/n
</code></pre>
<p><img src="/images/python_6/output_44_4.png" alt="png"></p>
<pre><code>/n
</code></pre>
<ul>
<li><p>[결과 해석] 2절에서 찾은 클러스터와 비슷하게 파인애플은 사과와 조금 혼돈되는 면이 있다.</p>
</li>
<li><p>시각화</p>
<ul>
<li>3개 이하로 차원을 줄이면 화면에 출력하기 비교적 쉽다.</li>
<li>fruits_pca 데이터는 2개의 특성이 있기 때문에 2차원으로 표현 할 수 있다.</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> label <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">3</span>):</span><br><span class="line">  data = fruits_pca[km.labels_==label]</span><br><span class="line">  plt.scatter(data[:,<span class="number">0</span>], data[:,<span class="number">1</span>])</span><br><span class="line">plt.legend([<span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;banana&#x27;</span>, <span class="string">&#x27;pineapple&#x27;</span>])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/images/python_6/output_47_0.png" alt="png"></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-python_5"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2022/07/04/python_5/">혼공머 Chapter 05</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2022/07/04/python_5/" class="article-date">
	  <time datetime="2022-07-03T16:00:00.000Z" itemprop="datePublished">July 4, 2022</time>
	</a>

       
      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="0-자율학습"><a href="#0-자율학습" class="headerlink" title="0. 자율학습"></a>0. 자율학습</h1><ul>
<li>딥러닝 논문.pdf 단톡방에 있음.</li>
</ul>
<h1 id="Chapter-05-1-결정-트리-가장-중요함"><a href="#Chapter-05-1-결정-트리-가장-중요함" class="headerlink" title="Chapter 05-1 결정 트리 (가장 중요함)"></a>Chapter 05-1 결정 트리 (가장 중요함)</h1><ul>
<li>직관적이다.</li>
<li>윰세 웅이 머리 속에 있는게 결정 트리임.ㅎ</li>
<li>유일한 단점 : 과대적합이 일어나기 쉽다.</li>
</ul>
<h2 id="wine-데이터-가져오기"><a href="#wine-데이터-가져오기" class="headerlink" title="wine 데이터 가져오기"></a>wine 데이터 가져오기</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">wine = pd.read_csv(<span class="string">&#x27;https://bit.ly/wine_csv_data&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(wine.head)</span><br></pre></td></tr></table></figure>

<pre><code>&lt;bound method NDFrame.head of       alcohol  sugar    pH  class
0         9.4    1.9  3.51    0.0
1         9.8    2.6  3.20    0.0
2         9.8    2.3  3.26    0.0
3         9.8    1.9  3.16    0.0
4         9.4    1.9  3.51    0.0
...       ...    ...   ...    ...
6492     11.2    1.6  3.27    1.0
6493      9.6    8.0  3.15    1.0
6494      9.4    1.2  2.99    1.0
6495     12.8    1.1  3.34    1.0
6496     11.8    0.8  3.26    1.0

[6497 rows x 4 columns]&gt;
</code></pre>
<h2 id="데이터-프레임-확인"><a href="#데이터-프레임-확인" class="headerlink" title="데이터 프레임 확인"></a>데이터 프레임 확인</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wine.head()</span><br></pre></td></tr></table></figure>





  <div id="df-a8722cad-7d96-44de-b84a-2c5352674b94">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alcohol</th>
      <th>sugar</th>
      <th>pH</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9.4</td>
      <td>1.9</td>
      <td>3.51</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.8</td>
      <td>2.6</td>
      <td>3.20</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9.8</td>
      <td>2.3</td>
      <td>3.26</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9.8</td>
      <td>1.9</td>
      <td>3.16</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9.4</td>
      <td>1.9</td>
      <td>3.51</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-a8722cad-7d96-44de-b84a-2c5352674b94')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg&quot;">http://www.w3.org/2000/svg&quot;</a> height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-a8722cad-7d96-44de-b84a-2c5352674b94 button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-a8722cad-7d96-44de-b84a-2c5352674b94&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;images/python_5/output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>




<ul>
<li>info() : 데이터 프레임의 각 열의 데이터 타입과 누락된 데이터가 있는지 확인.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wine.info()</span><br></pre></td></tr></table></figure>

<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 6497 entries, 0 to 6496
Data columns (total 4 columns):
 #   Column   Non-Null Count  Dtype  
---  ------   --------------  -----  
 0   alcohol  6497 non-null   float64
 1   sugar    6497 non-null   float64
 2   pH       6497 non-null   float64
 3   class    6497 non-null   float64
dtypes: float64(4)
memory usage: 203.2 KB
</code></pre>
<ul>
<li>describe(): 열에 대한 간략한 통계 출력. 최소, 최대, 평균값 등을 볼 수 있다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wine.describe()</span><br></pre></td></tr></table></figure>





  <div id="df-7bfdc612-f5ac-4473-bdd8-4e02c3f34bf8">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alcohol</th>
      <th>sugar</th>
      <th>pH</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>6497.000000</td>
      <td>6497.000000</td>
      <td>6497.000000</td>
      <td>6497.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>10.491801</td>
      <td>5.443235</td>
      <td>3.218501</td>
      <td>0.753886</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.192712</td>
      <td>4.757804</td>
      <td>0.160787</td>
      <td>0.430779</td>
    </tr>
    <tr>
      <th>min</th>
      <td>8.000000</td>
      <td>0.600000</td>
      <td>2.720000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>9.500000</td>
      <td>1.800000</td>
      <td>3.110000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>10.300000</td>
      <td>3.000000</td>
      <td>3.210000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>11.300000</td>
      <td>8.100000</td>
      <td>3.320000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>14.900000</td>
      <td>65.800000</td>
      <td>4.010000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-7bfdc612-f5ac-4473-bdd8-4e02c3f34bf8')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

<p>  &lt;svg xmlns&#x3D;”<a target="_blank" rel="noopener" href="http://www.w3.org/2000/svg&quot;">http://www.w3.org/2000/svg&quot;</a> height&#x3D;”24px”viewBox&#x3D;”0 0 24 24”<br>       width&#x3D;”24px”&gt;<br>    <path d="M0 0h24v24H0V0z" fill="none"/><br>    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/><br>  </svg><br>      </button></p>
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

<pre><code>  &lt;script&gt;
    const buttonEl =
      document.querySelector(&#39;#df-7bfdc612-f5ac-4473-bdd8-4e02c3f34bf8 button.colab-df-convert&#39;);
    buttonEl.style.display =
      google.colab.kernel.accessAllowed ? &#39;block&#39; : &#39;none&#39;;

    async function convertToInteractive(key) &#123;
      const element = document.querySelector(&#39;#df-7bfdc612-f5ac-4473-bdd8-4e02c3f34bf8&#39;);
      const dataTable =
        await google.colab.kernel.invokeFunction(&#39;convertToInteractive&#39;,
                                                 [key], &#123;&#125;);
      if (!dataTable) return;

      const docLinkHtml = &#39;Like what you see? Visit the &#39; +
        &#39;&lt;a target=&quot;_blank&quot; href=https://colab.research.google.com/notebooks/data_table.ipynb&gt;data table notebook&lt;/a&gt;&#39;
        + &#39; to learn more about interactive tables.&#39;;
      element.innerHTML = &#39;&#39;;
      dataTable[&#39;images/python_5/output_type&#39;] = &#39;display_data&#39;;
      await google.colab.output.renderOutput(dataTable, element);
      const docLink = document.createElement(&#39;div&#39;);
      docLink.innerHTML = docLinkHtml;
      element.appendChild(docLink);
    &#125;
  &lt;/script&gt;
&lt;/div&gt;
</code></pre>
  </div>




<h2 id="데이터-가공하기"><a href="#데이터-가공하기" class="headerlink" title="데이터 가공하기"></a>데이터 가공하기</h2><ul>
<li>알코올 도수, 당도, pH값 단위 표준화</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = wine [[<span class="string">&#x27;alcohol&#x27;</span>, <span class="string">&#x27;sugar&#x27;</span>, <span class="string">&#x27;pH&#x27;</span>]].to_numpy()</span><br><span class="line">target = wine[<span class="string">&#x27;class&#x27;</span>].to_numpy()</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wine[<span class="string">&#x27;class&#x27;</span>].value_counts()</span><br></pre></td></tr></table></figure>




<pre><code>1.0    4898
0.0    1599
Name: class, dtype: int64
</code></pre>
<h2 id="훈련데이터-분리"><a href="#훈련데이터-분리" class="headerlink" title="훈련데이터 분리"></a>훈련데이터 분리</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># train_test_split() 함수는 설정값을 지정하지 않으면 25%를 테스트 세트로 지정합니다.</span></span><br><span class="line"><span class="comment"># 샘플 개수가 충분히 많으므로 20% 정도만 테스트 세트로 나눈다. test_size=0.2</span></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line">train_input, test_input, train_target, test_target = train_test_split(</span><br><span class="line">    data, target, test_size=<span class="number">0.2</span>, random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">train_input.shape, test_input.shape, train_target.shape, test_target.shape</span><br></pre></td></tr></table></figure>

<h2 id="표준화-처리"><a href="#표준화-처리" class="headerlink" title="표준화 처리"></a>표준화 처리</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line">ss = StandardScaler()</span><br><span class="line">ss.fit(train_input)</span><br><span class="line"></span><br><span class="line">train_scaled = ss.transform(train_input)</span><br><span class="line">test_scaled = ss.transform(test_input)</span><br></pre></td></tr></table></figure>

<h2 id="로지스틱-회귀-모델-훈련-lr"><a href="#로지스틱-회귀-모델-훈련-lr" class="headerlink" title="로지스틱 회귀 모델 훈련 (lr)"></a>로지스틱 회귀 모델 훈련 (lr)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line">lr = LogisticRegression()</span><br><span class="line">lr.fit(train_scaled, train_target)</span><br><span class="line"><span class="built_in">print</span>(lr.score(train_scaled, train_target))</span><br><span class="line"><span class="built_in">print</span>(lr.score(test_scaled, test_target))</span><br></pre></td></tr></table></figure>

<pre><code>0.7808350971714451
0.7776923076923077
</code></pre>
<ul>
<li>[결과 해석]</li>
<li>점수가 높지 않음. 생각보다 화이트 와인을 골라내기 어려움. 과소적합.</li>
<li>해결책: 규제 매개 변수 C의 값을 바꿔보자. &#x2F; solver 매개변수에서 다른 알고리즘을 선택하자&#x2F; 다항 특성을 만들어 추가하자.</li>
</ul>
<h2 id="로지스틱-회귀가-학습한-계수와-절편"><a href="#로지스틱-회귀가-학습한-계수와-절편" class="headerlink" title="로지스틱 회귀가 학습한 계수와 절편"></a>로지스틱 회귀가 학습한 계수와 절편</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(lr.coef_, lr.intercept_)</span><br></pre></td></tr></table></figure>

<pre><code>[[ 0.51270274  1.6733911  -0.68767781]] [1.81777902]
</code></pre>
<h2 id="결정트리-모델-만들기-dt"><a href="#결정트리-모델-만들기-dt" class="headerlink" title="결정트리 모델 만들기 (dt)"></a>결정트리 모델 만들기 (dt)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"></span><br><span class="line"><span class="comment"># criterion&#123;“gini”, “entropy”, “log_loss”&#125;, default=”gini”</span></span><br><span class="line"><span class="comment"># dt = DecisionTreeClassifier(criterion = &#x27;entropy&#x27;, max_depth = 7, random_state=42)</span></span><br><span class="line">dt = DecisionTreeClassifier(random_state=<span class="number">42</span>)</span><br><span class="line">dt.fit(train_scaled, train_target)</span><br><span class="line"><span class="built_in">print</span>(dt.score(train_scaled, train_target)) <span class="comment"># 훈련 세트</span></span><br><span class="line"><span class="built_in">print</span>(dt.score(test_scaled, test_target)) <span class="comment"># 테스트 세트</span></span><br></pre></td></tr></table></figure>

<pre><code>0.996921300750433
0.8592307692307692
</code></pre>
<ul>
<li>[결과 해석]</li>
<li>훈련 정확도 : 0.99</li>
<li>테스트 정확도 : 0.85</li>
<li>과대적합이 일어났다.</li>
<li>차이가 생기는 이유 : 예를 들어 훈련때는 깔끔한 데이터(검,파,빨)로 훈련을 했으나, 테스트 시에는 섞인 데이터((검+파))가 들어오기 때문</li>
<li>해결책 : 색상이 아닌 도형으로 분류를 한다?</li>
<li>깊이가 너무 깊으면 섞여있는 데이터를 분류하기 힘들다. 때문에 당장 정확도는 약간 떨어질지 몰라도 깊이를 적당하게 조정한다. (max_depth&#x3D; )<br>-max_depth&#x3D; 을 지정해준 이후로는 훈련데이터 정확도는 떨어져도 과대,과소적합이 생기지 않았다.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"></span><br><span class="line">dt = DecisionTreeClassifier(max_depth= <span class="number">3</span>, random_state=<span class="number">42</span>)</span><br><span class="line">dt.fit(train_scaled, train_target)</span><br><span class="line"><span class="built_in">print</span>(dt.score(train_scaled, train_target))</span><br><span class="line"><span class="built_in">print</span>(dt.score(test_scaled, test_target))</span><br></pre></td></tr></table></figure>

<pre><code>0.8454877814123533
0.8415384615384616
</code></pre>
<ul>
<li>[결과 해석]</li>
<li>max_depth&#x3D; 3으로 지정하는 것이 과소,과대적합이 일어나지 않고 가장 바람직한 모델이 된다.</li>
</ul>
<h2 id="위에서-만든-결정트리-모델-객체를-plot-tree-함수에-전달하여-시각화"><a href="#위에서-만든-결정트리-모델-객체를-plot-tree-함수에-전달하여-시각화" class="headerlink" title="위에서 만든 결정트리 모델 객체를 plot_tree() 함수에 전달하여 시각화"></a>위에서 만든 결정트리 모델 객체를 plot_tree() 함수에 전달하여 시각화</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> plot_tree</span><br><span class="line"></span><br><span class="line">dt = DecisionTreeClassifier(max_depth= <span class="literal">None</span>, random_state=<span class="number">42</span>)</span><br><span class="line">dt.fit(train_scaled, train_target)</span><br><span class="line"><span class="built_in">print</span>(dt.score(train_scaled, train_target))</span><br><span class="line"><span class="built_in">print</span>(dt.score(test_scaled, test_target))</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>,<span class="number">7</span>))</span><br><span class="line">plot_tree(dt)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<pre><code>0.996921300750433
0.8592307692307692
</code></pre>
<p><img src="/images/python_5/output_29_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> plot_tree</span><br><span class="line"></span><br><span class="line">dt = DecisionTreeClassifier(max_depth= <span class="number">7</span>, random_state=<span class="number">42</span>)</span><br><span class="line">dt.fit(train_scaled, train_target)</span><br><span class="line"><span class="built_in">print</span>(dt.score(train_scaled, train_target))</span><br><span class="line"><span class="built_in">print</span>(dt.score(test_scaled, test_target))</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>,<span class="number">7</span>))</span><br><span class="line">plot_tree(dt)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<pre><code>0.8895516644217818
0.8630769230769231
</code></pre>
<p><img src="/images/python_5/output_30_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> plot_tree</span><br><span class="line"></span><br><span class="line">dt = DecisionTreeClassifier(max_depth= <span class="number">8</span>, random_state=<span class="number">42</span>)</span><br><span class="line">dt.fit(train_scaled, train_target)</span><br><span class="line"><span class="built_in">print</span>(dt.score(train_scaled, train_target))</span><br><span class="line"><span class="built_in">print</span>(dt.score(test_scaled, test_target))</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>,<span class="number">7</span>))</span><br><span class="line">plot_tree(dt)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<pre><code>0.9003271117952665
0.8576923076923076
</code></pre>
<p><img src="/images/python_5/output_31_1.png" alt="png"></p>
<ul>
<li>max_depth&#x3D; 8이 되는 순간 과대적합이 생긴다.</li>
<li>고로 max_depth&#x3D; 7 정도가 가장 적합하다.</li>
</ul>
<h2 id="노드란-무엇인가"><a href="#노드란-무엇인가" class="headerlink" title="노드란 무엇인가?"></a>노드란 무엇인가?</h2><ul>
<li>루트 노드, 노드, 리프노드(&#x3D;말단노드)</li>
<li>루트 노드읽는 법<ul>
<li>테스트 조건</li>
<li>불순도</li>
<li>총 샘플 수 </li>
<li>클래스별 샘플 수</li>
</ul>
<ul>
<li>filled&#x3D; True 함수<ul>
<li>클래스마다 색깔을 부여하고, 어떤 클래스의 비율이 높아지면 점점 진한 색으로 표시한다. 직관적.</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">10</span>,<span class="number">7</span>))</span><br><span class="line">plot_tree(dt, max_depth = <span class="number">1</span>,</span><br><span class="line">          filled= <span class="literal">True</span>,</span><br><span class="line">          feature_names= [<span class="string">&#x27;alcohal&#x27;</span>, <span class="string">&#x27;sugar&#x27;</span>, <span class="string">&#x27;pH&#x27;</span>])</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># 루트 노드, 노드, 리프노드(=말단노드)</span></span><br></pre></td></tr></table></figure>


<p><img src="/images/python_5/output_34_0.png" alt="png"></p>
<h2 id="불순도"><a href="#불순도" class="headerlink" title="불순도"></a>불순도</h2><ul>
<li><p>한 범주 안에서 서로 다른 데이터가 얼마나 섞여 있는지를 나타냄.</p>
</li>
<li><p>흰색과 검은색이 각각 50개 섞여 있다.</p>
<ul>
<li>불순도 최대 : 0.5</li>
</ul>
</li>
<li><p>흰색과 검은색이 완전 100% 분리가 됨</p>
<ul>
<li>흰색 노드 불순도 최소 : 0</li>
<li>검은색 노드 불순도 최소 : 0</li>
</ul>
</li>
<li><p>비율</p>
</li>
<li><p>레드와인 5:5 화이트와인 -&gt; 불순도가 가장 높을 때.gini 불순도의 수치 0.5</p>
</li>
</ul>
<h2 id="엔트로피-Entropy"><a href="#엔트로피-Entropy" class="headerlink" title="엔트로피(Entropy)"></a>엔트로피(Entropy)</h2><ul>
<li>불순도와 개념이 비슷하다.</li>
<li>불확실한 정도를 의미함. 0~1 사이</li>
<li>흰색과 검은색이 각각 50개 섞여 있다.<ul>
<li>엔트로피 최대 : 1</li>
</ul>
</li>
<li>흰색과 검은색이 완전 100% 분리가 됨<ul>
<li>흰색 노드 엔트로피 최소 : 0</li>
<li>검은색 노드 엔트로피 최소 : 0</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> plot_tree</span><br><span class="line"><span class="comment"># 엔트로피 사용</span></span><br><span class="line">dt = DecisionTreeClassifier(criterion = <span class="string">&#x27;entropy&#x27;</span>, max_depth = <span class="number">7</span>, random_state=<span class="number">42</span>)</span><br><span class="line">dt.fit(train_scaled, train_target)</span><br><span class="line"><span class="built_in">print</span>(dt.score(train_scaled, train_target))</span><br><span class="line"><span class="built_in">print</span>(dt.score(test_scaled, test_target))</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>,<span class="number">7</span>))</span><br><span class="line">plot_tree(dt)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<pre><code>0.885703290359823
0.8669230769230769
</code></pre>
<p><img src="/images/python_5/output_37_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 결과</span></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>,<span class="number">7</span>))</span><br><span class="line">plot_tree(dt, max_depth = <span class="number">1</span>,</span><br><span class="line">          filled= <span class="literal">True</span>,</span><br><span class="line">          feature_names= [<span class="string">&#x27;alcohal&#x27;</span>, <span class="string">&#x27;sugar&#x27;</span>, <span class="string">&#x27;pH&#x27;</span>])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/images/python_5/output_38_0.png" alt="png"></p>
<h2 id="특성-중요도"><a href="#특성-중요도" class="headerlink" title="특성 중요도"></a>특성 중요도</h2><ul>
<li>어떤 특성이 결정 트리 모델에 영향을 주었는가?</li>
<li>어떤 기준, 특성이 가장 확실하게 분리를 시켜줄 수 있느냐? (여기에서는 sugar)</li>
<li>인과관계와는 상관이 없다.</li>
<li>(회귀분석: 독립변수와 종속변수 사이의 인과관계를 따짐)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(dt.feature_importances_)</span><br></pre></td></tr></table></figure>

<pre><code>[0.15247834 0.68293075 0.16459092]
</code></pre>
<h2 id="현업에서의-적용"><a href="#현업에서의-적용" class="headerlink" title="현업에서의 적용"></a>현업에서의 적용</h2><ul>
<li>현업에서 DecisionTreeClassifier (1970년대)</li>
<li>랜덤포레스트. XGBoost 하이퍼파라미터 매우 많음</li>
</ul>
<h1 id="Chapter-05-2-교차-검증과-그리드-서치"><a href="#Chapter-05-2-교차-검증과-그리드-서치" class="headerlink" title="Chapter 05-2 교차 검증과 그리드 서치"></a>Chapter 05-2 교차 검증과 그리드 서치</h1><ul>
<li>함부로 건들이지 말아라.</li>
<li>물론 다 시도해보면 퀄은 올라가겠지만 비효율적이다.</li>
</ul>
<h2 id="검증-세트"><a href="#검증-세트" class="headerlink" title="검증 세트"></a>검증 세트</h2><ul>
<li>훈련세트와 테스트세트</li>
<li>훈련 : 교과서 공부하는 것 훈련세트, 모의평가</li>
<li>검증 : 강남대성 모의고사 문제지<br>——-파라미터는 훈련과 검증을 열심히 조지구..!——-</li>
<li>테스트 : 6모, 9모</li>
<li>실전 : 수능</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 데이터 가져오기</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line">wine = pd.read_csv(<span class="string">&#x27;https://bit.ly/wine_csv_data&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(wine.head)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 데이터 가공하기</span></span><br><span class="line">data = wine [[<span class="string">&#x27;alcohol&#x27;</span>, <span class="string">&#x27;sugar&#x27;</span>, <span class="string">&#x27;pH&#x27;</span>]].to_numpy()</span><br><span class="line">target = wine[<span class="string">&#x27;class&#x27;</span>].to_numpy()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 데이터 분리</span></span><br><span class="line"><span class="comment"># 훈련 80%</span></span><br><span class="line"><span class="comment"># 테스트 20%</span></span><br><span class="line">train_input, test_input, train_target, test_target = train_test_split(</span><br><span class="line">    data, target, test_size=<span class="number">0.2</span>, random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">train_input.shape, test_input.shape, train_target.shape, test_target.shape</span><br></pre></td></tr></table></figure>

<pre><code>&lt;bound method NDFrame.head of       alcohol  sugar    pH  class
0         9.4    1.9  3.51    0.0
1         9.8    2.6  3.20    0.0
2         9.8    2.3  3.26    0.0
3         9.8    1.9  3.16    0.0
4         9.4    1.9  3.51    0.0
...       ...    ...   ...    ...
6492     11.2    1.6  3.27    1.0
6493      9.6    8.0  3.15    1.0
6494      9.4    1.2  2.99    1.0
6495     12.8    1.1  3.34    1.0
6496     11.8    0.8  3.26    1.0

[6497 rows x 4 columns]&gt;





((5197, 3), (1300, 3), (5197,), (1300,))
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 훈련 80%</span></span><br><span class="line"><span class="comment"># 검증 20%</span></span><br><span class="line">sub_input, val_input, sub_target, val_target = train_test_split(</span><br><span class="line">    train_input, train_target, test_size = <span class="number">0.2</span>, random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">sub_input.shape, val_input.shape, sub_target.shape, val_target.shape</span><br></pre></td></tr></table></figure>




<pre><code>((4157, 3), (1040, 3), (4157,), (1040,))
</code></pre>
<ul>
<li>훈련데이터: train(X), sub_input, sub_target</li>
<li>검증데이터: val_input, val_target</li>
<li>테스트데이터: test_input, test_target</li>
</ul>
<h2 id="모형-만들기"><a href="#모형-만들기" class="headerlink" title="모형 만들기"></a>모형 만들기</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line">dt = DecisionTreeClassifier(random_state=<span class="number">42</span>)</span><br><span class="line">dt.fit(sub_input,sub_target)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;훈련 성과 : &quot;</span>, dt.score(sub_input, sub_target))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;검증 성과 : &quot;</span>, dt.score(val_input, val_target))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;마지막 최종 : &quot;</span>, dt.score(test_input, test_target))</span><br></pre></td></tr></table></figure>

<pre><code>훈련 성과 :  0.9971133028626413
검증 성과 :  0.864423076923077
마지막 최종 :  0.8569230769230769
</code></pre>
<ul>
<li>어느정도 일치해야지 안정적이다고 한다.</li>
<li>훈련: 87%</li>
<li>검증: 86%<br>——보통 이정도에서만 끝남</li>
<li>최종: 55%</li>
<li>모형을 배포할지 말지 결정은 최종에 따라 결정된다.</li>
<li>훈련과 검증은 과대적합을 조정했으나, 최종 결과가 55%가 나왔기 때문에 모형 배포는 불가하다.</li>
</ul>
<h3 id="교차검증"><a href="#교차검증" class="headerlink" title="교차검증"></a>교차검증</h3><ul>
<li>데이터 셋을 반복 분할</li>
<li>For loop</li>
<li>샘플링 편향적일 수 있다.</li>
<li>교차검증을 한다고 해서, 정확도가 무조건 올라간다?! (X)</li>
<li>모형을 안정적으로 만들어 준다, 편향성 예방<ul>
<li>과대적합 방지</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 책에 없는 내용</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> KFold</span><br><span class="line"></span><br><span class="line">df = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 데이터를 K 폴트로 나눈다.</span></span><br><span class="line">folds = KFold(n_splits=<span class="number">5</span>, shuffle= <span class="literal">True</span>)</span><br><span class="line"><span class="keyword">for</span> train_idx, valid_idx <span class="keyword">in</span> folds.split(df):</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">f&#x27;훈련데이터 : <span class="subst">&#123;df[train_idx]&#125;</span>, 검증 데이터 : <span class="subst">&#123;df[valid_idx]&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>

<pre><code>훈련데이터 : [1 2 3 4 5 7 8 9], 검증 데이터 : [ 6 10]
훈련데이터 : [ 2  3  4  5  6  7  8 10], 검증 데이터 : [1 9]
훈련데이터 : [ 1  2  3  5  6  7  9 10], 검증 데이터 : [4 8]
훈련데이터 : [ 1  4  5  6  7  8  9 10], 검증 데이터 : [2 3]
훈련데이터 : [ 1  2  3  4  6  8  9 10], 검증 데이터 : [5 7]
</code></pre>
<h2 id="교차-검증-함수"><a href="#교차-검증-함수" class="headerlink" title="교차 검증 함수"></a>교차 검증 함수</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_validate</span><br><span class="line">scores = cross_validate(dt,train_input, train_target)</span><br><span class="line"><span class="built_in">print</span>(scores)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;평균 : &quot;</span>, np.mean(scores[<span class="string">&#x27;test_score&#x27;</span>]))</span><br></pre></td></tr></table></figure>

<pre><code>&#123;&#39;fit_time&#39;: array([0.01930737, 0.01765442, 0.02578688, 0.022542  , 0.01724601]), &#39;score_time&#39;: array([0.00949001, 0.00124788, 0.00840759, 0.00133181, 0.00768995]), &#39;test_score&#39;: array([0.86923077, 0.84615385, 0.87680462, 0.84889317, 0.83541867])&#125;
평균 :  0.855300214703487
</code></pre>
<h2 id="StratifiedKFold-사용"><a href="#StratifiedKFold-사용" class="headerlink" title="StratifiedKFold 사용"></a>StratifiedKFold 사용</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> StratifiedKFold</span><br><span class="line">scores = cross_validate(dt, train_input, train_target, cv = StratifiedKFold())</span><br><span class="line"><span class="built_in">print</span>(scores)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;평균 : &quot;</span>, np.mean(scores[<span class="string">&#x27;test_score&#x27;</span>]))</span><br></pre></td></tr></table></figure>

<pre><code>&#123;&#39;fit_time&#39;: array([0.01292014, 0.01056361, 0.01049542, 0.01041055, 0.01058245]), &#39;score_time&#39;: array([0.00140882, 0.00116181, 0.00110102, 0.00124288, 0.00108576]), &#39;test_score&#39;: array([0.86923077, 0.84615385, 0.87680462, 0.84889317, 0.83541867])&#125;
평균 :  0.855300214703487
</code></pre>
<h3 id="10폴드-교차검증을-수행"><a href="#10폴드-교차검증을-수행" class="headerlink" title="10폴드 교차검증을 수행"></a>10폴드 교차검증을 수행</h3><ul>
<li>가장 좋아짐.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> StratifiedKFold</span><br><span class="line">splitter = StratifiedKFold(n_splits = <span class="number">10</span>, shuffle = <span class="literal">True</span>, random_state=<span class="number">42</span>)</span><br><span class="line">scores = cross_validate(dt, train_input, train_target, cv = splitter)</span><br><span class="line"><span class="built_in">print</span>(scores)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;평균 : &quot;</span>, np.mean(scores[<span class="string">&#x27;test_score&#x27;</span>]))</span><br></pre></td></tr></table></figure>

<pre><code>&#123;&#39;fit_time&#39;: array([0.03280711, 0.04228663, 0.02831173, 0.03076744, 0.02979231,
       0.01984262, 0.03593683, 0.03715229, 0.04245949, 0.03987837]), &#39;score_time&#39;: array([0.00103736, 0.00581765, 0.01219463, 0.00096822, 0.0007534 ,
       0.00889254, 0.00699735, 0.00105405, 0.00105524, 0.00118446]), &#39;test_score&#39;: array([0.83461538, 0.87884615, 0.85384615, 0.85384615, 0.84615385,
       0.87307692, 0.85961538, 0.85549133, 0.85163776, 0.86705202])&#125;
평균 :  0.8574181117533719
</code></pre>
<h2 id="하이퍼파라미터-튜닝"><a href="#하이퍼파라미터-튜닝" class="headerlink" title="하이퍼파라미터 튜닝"></a>하이퍼파라미터 튜닝</h2><ul>
<li>그리드 서치<ul>
<li>사람이 수동적으로 입력</li>
<li>max_depth : [1,3,7]</li>
</ul>
</li>
<li>랜덤 서치<ul>
<li>사람이 범위만 지정, 최적을 찾아내렴.</li>
<li>max_depth : 1~10 &#x2F; by random</li>
</ul>
</li>
<li>베이지안 옵티마이제이션</li>
<li>AutoML: 범위조차 알아서….</li>
<li>사람의 개입 없이 하이퍼파라미터 튜닝을 자동을 수행하는 기술을 AutoML이라고 함.<ul>
<li>예1) PyCaret , <a target="_blank" rel="noopener" href="https://pycaret.gitbook.io/docs/">https://pycaret.gitbook.io/docs/</a></li>
</ul>
</li>
<li>각 모델마다 적게는 1-2개에서 많게는 5-6개의 매개변수를 제공한다.<ul>
<li>XGBoost 100개?</li>
</ul>
</li>
<li>하이퍼파라미터와 동시에 교차검증을 수행.<ul>
<li>미친짓</li>
</ul>
</li>
</ul>
<p>교차검증 5 번</p>
<ul>
<li><p>Max Depth &#x3D; 1, 3, 7</p>
</li>
<li><p>Criterion &#x3D; gini, entropy</p>
</li>
<li><p>교차검증 1번 돌 때, Max Depth 3번 적용</p>
</li>
<li><p>총 결과값 3 * 5 * 2나옴.</p>
</li>
<li><p>그러나 우리가 궁금한 것은 Best 1개만 알면 된다.</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> GridSearchCV</span><br><span class="line">params = &#123;</span><br><span class="line">    <span class="string">&#x27;max_depth&#x27;</span> : [<span class="number">1</span>, <span class="number">3</span>, <span class="number">7</span>],</span><br><span class="line">    <span class="string">&#x27;min_impurity_decrease&#x27;</span> : [<span class="number">0.0001</span>, <span class="number">0.0002</span>, <span class="number">0.0003</span>, <span class="number">0.0004</span>, <span class="number">0.0005</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">gs = GridSearchCV(DecisionTreeClassifier(random_state=<span class="number">42</span>), params, n_jobs=-<span class="number">1</span>)</span><br><span class="line">gs.fit(train_input, train_target)</span><br></pre></td></tr></table></figure>




<pre><code>GridSearchCV(estimator=DecisionTreeClassifier(random_state=42), n_jobs=-1,
             param_grid=&#123;&#39;max_depth&#39;: [1, 3, 7],
                         &#39;min_impurity_decrease&#39;: [0.0001, 0.0002, 0.0003,
                                                   0.0004, 0.0005]&#125;)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;best : &quot;</span>, gs.best_estimator_)</span><br><span class="line">dt = gs.best_estimator_</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1 결과 best :  DecisionTreeClassifier(min_impurity_decrease=0.0001, random_state=42)</span></span><br><span class="line"><span class="comment"># 2 &#x27;max_depth&#x27; : [1, 3, 7], 추가 이후</span></span><br><span class="line"><span class="comment"># 3 결과 best :  DecisionTreeClassifier(max_depth=7, min_impurity_decrease=0.0005,random_state=42)</span></span><br><span class="line"><span class="comment"># 등등 계속 업데이트해서 사용할 수는 있으나</span></span><br><span class="line"><span class="comment"># 첫 결과에서 0.0001가 나왔다가도 min_impurity_decrease 숫자를 0.0001로 픽스시켜서는 안된다.</span></span><br><span class="line"><span class="comment"># 왜냐면 서로 영향을 주기 때문에 다른 파라미터가 추가 되면 최적 결과가 바뀔 수 있다.</span></span><br></pre></td></tr></table></figure>

<pre><code>best :  DecisionTreeClassifier(max_depth=7, min_impurity_decrease=0.0005,
                       random_state=42)
</code></pre>
<h1 id="Chapter-05-3-트리의-앙상블"><a href="#Chapter-05-3-트리의-앙상블" class="headerlink" title="Chapter 05-3 트리의 앙상블"></a>Chapter 05-3 트리의 앙상블</h1><h2 id="랜덤-포레스트"><a href="#랜덤-포레스트" class="headerlink" title="랜덤 포레스트"></a>랜덤 포레스트</h2><ul>
<li><p>Decision Tree (나무 1개)</p>
<ul>
<li>랜덤 포레스트 (여러개 심음)</li>
<li>샘플링</li>
<li>Feature Importances</li>
</ul>
</li>
<li><p>과대적합되는 것을 막아주고 검증 세트와 테스트 세트에서 안정적인 성능을 얻을 수 있다.</p>
</li>
<li><p>예측해야 할 행의 갯수, 100만개</p>
</li>
<li><p>컬럼의 갯수(독립변수) 200개 –&gt; 100개</p>
<ul>
<li>sqrt(): </li>
<li>나무 100개를 심고 평균을 내자</li>
<li>나무 1개 당 컬럼을 10개로</li>
<li>T1 mae : 20 &#x2F; T2 mae: 30 &#x2F; T3 mae 10, …</li>
<li>T1~T100 mae : 20 &lt;–이게 전체적인 평가지표</li>
</ul>
</li>
<li><p>샘플링: 부트스트랩 샘플 (복원 추출) -&gt; 결정트리 훈련</p>
<ul>
<li>주머니에 구슬을 다시 넣고 섞고 @개 추출</li>
<li>(결정트리는 주머니에서 추출, 다시 안넣고, 또 추출했다.-&gt;정형데이터)</li>
<li>시간이 오래걸림</li>
<li>vote 투표로 결정됨?</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 라이브러리 설치</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split, cross_validate</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"></span><br><span class="line"><span class="comment"># 데이터 불러오기</span></span><br><span class="line">wine = pd. read_csv(<span class="string">&#x27;https://bit.ly/wine_csv_data&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># input, target 분리</span></span><br><span class="line">data = wine[[<span class="string">&#x27;alcohol&#x27;</span>, <span class="string">&#x27;sugar&#x27;</span>, <span class="string">&#x27;pH&#x27;</span>]].to_numpy()</span><br><span class="line">target= wine[<span class="string">&#x27;class&#x27;</span>].to_numpy()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 훈련데이터, 테스트 데이터 분리</span></span><br><span class="line">train_input, test_input, train_target, test_target = train_test_split(data, target, test_size=<span class="number">0.2</span>, random_state=<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 모델링</span></span><br><span class="line">rf= RandomForestClassifier(n_jobs=-<span class="number">1</span>, random_state=<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 모형 평가</span></span><br><span class="line">scores = cross_validate(rf, train_input, train_target, return_train_score=<span class="literal">True</span>, n_jobs=-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(np.mean(scores[<span class="string">&#x27;train_score&#x27;</span>]), np.mean(scores[<span class="string">&#x27;test_score&#x27;</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 특성 중요도 계산 (랜덤 포레스트의 특성 중요도 : 각 결정 트리의 특성 중요도를 취합한 것)</span></span><br><span class="line">rf.fit(train_input, train_target)</span><br><span class="line"><span class="built_in">print</span>(rf.feature_importances_)</span><br><span class="line"></span><br><span class="line"><span class="comment"># OOB (out of bag : 한 번도 안 뽑힌 것들은 검증에 사용 가능: 랜텀 포레스트는 각 트리의 OOB 점수를 평균하여 출력)</span></span><br><span class="line">rf= RandomForestClassifier(oob_score=<span class="literal">True</span>, n_jobs=-<span class="number">1</span>, random_state=<span class="number">42</span>)</span><br><span class="line">rf.fit(train_input, train_target)</span><br><span class="line"><span class="built_in">print</span>(rf.oob_score_)</span><br></pre></td></tr></table></figure>

<pre><code>0.9973541965122431 0.8905151032797809
[0.23167441 0.50039841 0.26792718]
0.8934000384837406
</code></pre>
<h2 id="엑스트라-트리-SKIP"><a href="#엑스트라-트리-SKIP" class="headerlink" title="엑스트라 트리  [SKIP]"></a>엑스트라 트리  [SKIP]</h2><h2 id="그래이디언트-부스팅"><a href="#그래이디언트-부스팅" class="headerlink" title="그래이디언트 부스팅"></a>그래이디언트 부스팅</h2><ul>
<li>깊이가 얕은 결정 트리를 사용하여 이전 트리의 오차를 보완</li>
<li>유기적, 상호 보완적</li>
<li>T1 ~ TN 증가하면서 오차를 보정해주며 정확성을 높임</li>
<li>경사하강법의 원리를 이용함</li>
<li>단점: 정확성은 좋으나 속도가 너무 느림</li>
<li>해결책: XGBoost, LightGBM</li>
</ul>
<h3 id="랜덤포레스트와의-차이점"><a href="#랜덤포레스트와의-차이점" class="headerlink" title="랜덤포레스트와의 차이점"></a>랜덤포레스트와의 차이점</h3><ul>
<li>랜덤 포레스트는 각 나무간 상호 연관성이 없다.</li>
<li>부스팅은 각 나무간 상호 연관성 있음</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> GradientBoostingClassifier</span><br><span class="line">gb = GradientBoostingClassifier(random_state=<span class="number">42</span>)</span><br><span class="line">scores = cross_validate(gb,train_input, train_target, return_train_score=<span class="literal">True</span>, n_jobs=-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(np.mean(scores[<span class="string">&#x27;train_score&#x27;</span>]), np.mean(scores[<span class="string">&#x27;test_score&#x27;</span>]))</span><br></pre></td></tr></table></figure>

<pre><code>0.8881086892152563 0.8720430147331015
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 학습률 조정 (100-&gt;500 증가, learning_rate= 기본값은 0.1)</span></span><br><span class="line">gb = GradientBoostingClassifier(n_estimators=<span class="number">500</span>, learning_rate=<span class="number">0.2</span>, random_state=<span class="number">42</span>)</span><br><span class="line">scores = cross_validate(gb, train_input, train_target, return_train_score = <span class="literal">True</span>, n_jobs=-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(np.mean(scores[<span class="string">&#x27;train_score&#x27;</span>]), np.mean(scores[<span class="string">&#x27;test_score&#x27;</span>]))</span><br></pre></td></tr></table></figure>

<pre><code>0.9464595437171814 0.8780082549788999
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 특성 중요도</span></span><br><span class="line">gb.fit(train_input, train_target)</span><br><span class="line"><span class="built_in">print</span>(gb.feature_importances_)</span><br><span class="line"><span class="comment"># [결과 해석] 그레이디언트 부스팅이 랜텀 포레스트보다 일부 특성(당도)에 더 집중합니다.</span></span><br></pre></td></tr></table></figure>

<pre><code>[0.15872278 0.68010884 0.16116839]
</code></pre>
<h2 id="히스토그램-기반-그레이디언트-부스팅-SKIP"><a href="#히스토그램-기반-그레이디언트-부스팅-SKIP" class="headerlink" title="히스토그램 기반 그레이디언트 부스팅  [SKIP]"></a>히스토그램 기반 그레이디언트 부스팅  [SKIP]</h2>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">Next</a>
  </nav>

</section>
          <aside id="sidebar">
  
    <div style="margin: 20px 0;">
	<div id="search-form-wrap">

    <form class="search-form">
        <label style="width: 72%;">
            <span class="screen-reader-text">Search for:</span>
            <input type="search" class="search-field" style="height: 36px; width: 100%;" placeholder=" Search…" value="" name="s" title="Search for:">
        </label>
        <input type="submit" class="search-form-submit" value="Search">
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>


</div>
</div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Connect With Us</h3>
    <div class="widget widget_athemes_social_icons">

    	<ul class="clearfix widget-social-icons">   
    	
   			<li><a target="_blank" rel="noopener" href="https://github.com/sallyzmk" title="Github"><i class="fa fa-github" aria-hidden="true"></i></a></li> 

   		
   			<li><a target="_blank" rel="noopener" href="https://www.instagram.com/zaks8m31/" title="Instagram"><i class="fa fa-instagram" aria-hidden="true"></i></a></li> 

   		
   		</ul>


   		<!--
   		<ul class="clearfix widget-social-icons">   		
   		<li class="widget-si-twitter"><a target="_blank" rel="noopener" href="http://twitter.com" title="Twitter"><i class="ico-twitter"></i></a></li> 
		<li class="widget-si-facebook"><a target="_blank" rel="noopener" href="http://facebook.com" title="Facebook"><i class="ico-facebook"></i></a></li>
			<li class="widget-si-gplus"><a target="_blank" rel="noopener" href="http://plus.google.com" title="Google+"><i class="ico-gplus"></i></a></li>
			<li class="widget-si-pinterest"><a target="_blank" rel="noopener" href="http://pinterest.com" title="Pinterest"><i class="ico-pinterest"></i></a></li>
			<li class="widget-si-flickr"><a target="_blank" rel="noopener" href="http://flickr.com" title="Flickr"><i class="ico-flickr"></i></a></li>
			<li class="widget-si-instagram"><a target="_blank" rel="noopener" href="http://instagram.com" title="Instagram"><i class="ico-instagram"></i></a></li>
		</ul> -->

    </div>
  </div>


  
    
  <div class="widget_athemes_tabs">
    <ul id="widget-tab" class="clearfix widget-tab-nav">
      <li class="active"><a>Recent Posts</a></li>
    </ul>
    <div class="widget">
      <ul>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2022/07/28/Airflow%20%EA%B0%95%EC%9D%98/">Airflow 강의</a></h6>
              <span>July 28, 2022</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2022/07/27/%EA%B0%80%EC%83%81%ED%99%98%EA%B2%BD%20%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0/">리눅스 가상환경 설치하기</a></h6>
              <span>July 27, 2022</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2022/07/27/VSCode%20Remote%20WLS%20%EC%97%B0%EB%8F%99/">VSCode Remote WLS 연동</a></h6>
              <span>July 27, 2022</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2022/07/27/WSL%20Tool%EC%84%A4%EC%B9%98/">WSL Tool설치</a></h6>
              <span>July 27, 2022</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2022/07/13/%EC%9D%B8%ED%84%B0%EB%84%B7%20%EC%97%86%EC%9D%B4%20%EA%B0%80%EC%83%81%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C%20%ED%8C%8C%EC%9D%B4%EC%8D%AC%20%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94%20%EB%B0%A9%EB%B2%95/">인터넷 없이 가상환경에서 파이썬 사용하는 방법</a></h6>
              <span>July 13, 2022</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2022/07/07/%EC%BA%90%EA%B8%80%20%EC%B0%B8%EC%97%AC%ED%95%98%EB%8A%94%20%EB%B0%A9%EB%B2%95/">캐글 참여하는 방법</a></h6>
              <span>July 7, 2022</span>
            </div>

          </li>
        
      </ul>
    </div>
  </div>

  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>

    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a><span class="archive-list-count">27</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>

    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="https://sallyzmk.github.io/2022/06/16/Categories/" class="mobile-nav-link">Categories</a>
  
    <a href="https://sallyzmk.github.io/2022/06/16/Python_home/" class="mobile-nav-link">Python</a>
  
    <a href="https://sallyzmk.github.io/2022/06/16/R_home/" class="mobile-nav-link">R</a>
  
    <a href="https://sallyzmk.github.io/2022/06/16/Notion_home/" class="mobile-nav-link">Notion</a>
  
</nav> -->
    <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2022 나의 첫번째 블로그 All Rights Reserved.
        
            <span id="busuanzi_container_site_uv">
              本站访客数<span id="busuanzi_value_site_uv"></span>人次  
              本站总访问量<span id="busuanzi_value_site_pv"></span>次
            </span>
          
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hipaper" target="_blank">hipaper</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");

    wrapdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";


    <!-- headerblur min height -->
    
    
</script>
    
<div style="display: none;">
  <script src="https://s11.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
</div>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>


<script src="/js/bootstrap.js"></script>


<script src="/js/main.js"></script>








  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>



	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
</body>
</html>
